(function(e){var t={id:"65febc6852c794b8bb6827ffacacbdf8",filename:"avalon.js",exports:{}};if(!e.____MODULES){e.____MODULES={}}var n=function(e,t,n){(function(e,n){if(typeof t==="object"&&typeof t.exports==="object"){t.exports=e.document?n(e,true):function(e){if(!e.document){throw new Error("Avalon requires a window with a document")}return n(e)}}else{n(e)}})(typeof window!=="undefined"?window:this,function(e,t){function u(){if(e.console&&avalon.config.debug){Function.apply.call(console.log,console,arguments)}}function A(){}function O(e,t){if(typeof e==="string"){e=e.match(d)||[]}var n={},r=t!==void 0?t:1;for(var i=0,s=e.length;i<s;i++){n[e[i]]=r}return n}function _(){if(e.VBArray){var t=document.documentMode;return t?t:e.XMLHttpRequest?7:6}else{return 0}}function H(e){return g.test(w.call(e))}function F(e,t){e=Math.floor(e)||0;return e<0?Math.max(t+e,0):Math.min(e,t)}function R(e){if(!e)return false;var t=e.length;if(t===t>>>0){var n=w.call(e).slice(8,-1);if(/(?:regexp|string|function|window|global)$/i.test(n))return false;if(n==="Array")return true;try{if({}.propertyIsEnumerable.call(e,"length")===false){return/^\s?function/.test(e.item||e.callee)}return true}catch(r){return!e.window}}return false}function J(e,t,n){var r="for(var "+e+"i=0,n = this.length; i < n; i++){"+t.replace("_","((i in this) && fn.call(scope,this[i],i,this))")+"}"+n;return Function("fn,scope",r)}function K(e,t){try{while(t=t.parentNode)if(t===e)return true;return false}catch(n){return false}}function Q(){return(new XMLSerializer).serializeToString(this)}function tt(e){var t={};for(var n in e){t[n]=e[n]}var i=t.target=e.srcElement;if(e.type.indexOf("key")===0){t.which=e.charCode!=null?e.charCode:e.keyCode}else if(et.test(e.type)){var s=i.ownerDocument||r;var o=s.compatMode==="BackCompat"?s.body:s.documentElement;t.pageX=e.clientX+(o.scrollLeft>>0)-(o.clientLeft>>0);t.pageY=e.clientY+(o.scrollTop>>0)-(o.clientTop>>0);t.wheelDeltaY=t.wheelDelta;t.wheelDeltaX=0}t.timeStamp=new Date-0;t.originalEvent=e;t.preventDefault=function(){e.returnValue=false};t.stopPropagation=function(){e.cancelBubble=true};return t}function st(e){for(var t in e){if(!b.call(e,t))continue;var n=e[t];if(typeof st.plugins[t]==="function"){st.plugins[t](n)}else if(typeof st[t]==="object"){avalon.mix(st[t],n)}else{st[t]=n}}return this}function ht(e){return(e+"").replace(ct,"\\$&")}function bt(e,t,n){if(P(t)||t&&t.nodeType){return false}if(n.indexOf(e)!==-1){return false}if(yt.indexOf(e)!==-1){return false}var r=n.$special;if(e&&e.charAt(0)==="$"&&!r[e]){return false}return true}function Et(e,t,n,r){switch(e.type){case 0:var i=e.get;var s=e.set;if(P(s)){var o=r.$events;var u=o[t];o[t]=[];s.call(r,n);o[t]=u}return i.call(r);case 1:return n;case 2:if(n!==r.$model[t]){var a=e.svmodel=Ot(r,t,n,e.valueType);n=a.$model;var f=wt[a.$id];f&&f()}return n}}function Ct(e,t,r){if(Array.isArray(e)){var s=e.concat();e.length=0;var o=_t(e);o.pushArray(s);return o}if(!e||e.nodeType>0||e.$id&&e.$events){return e}if(!Array.isArray(e.$skipArray)){e.$skipArray=[]}e.$skipArray.$special=t||{};var u={};r=r||{};var a={};var l={};var c=[];for(var h in e){(function(t,s){r[t]=s;if(!bt(t,s,e.$skipArray)){return}a[t]=[];var o=avalon.type(s);var h=function(e){var t=h._name;var n=this;var r=n.$model;var i=r[t];var s=n.$events;if(arguments.length){if(p){return}if(h.type!==1){e=Et(h,t,e,n);if(!h.type)return}if(!kt(i,e)){r[t]=e;$t(s[t]);Lt(n,t,e,i)}}else{if(h.type===0){e=h.get.call(n);if(i!==e){r[t]=e;Lt(n,t,e,i)}return e}else{It(s[t]);return h.svmodel||i}}};if(o==="object"&&P(s.get)&&Object.keys(s).length<=2){h.set=s.set;h.get=s.get;h.type=0;c.push(function(){var e={evaluator:function(){e.type=Math.random(),e.element=null;r[t]=h.get.call(u)},element:i,type:Math.random(),handler:A,args:[]};x[n]=e;h.call(u);delete x[n]})}else if(v.test(o)){h.type=2;h.valueType=o;c.push(function(){var e=Ct(s,0,r[t]);h.svmodel=e;e.$events[f]=a[t]})}else{h.type=1}h._name=t;l[t]=h})(h,e[h])}yt.forEach(function(t){delete e[t];delete r[t]});u=Tt(u,At(l),e);for(var d in e){if(!l[d]){u[d]=e[d]}}u.$id=M();u.$model=r;u.$events=a;for(h in mt){var m=mt[h];if(!T){m=m.bind(u)}u[h]=m}if(xt){Object.defineProperty(u,"hasOwnProperty",{value:function(e){return e in this.$model},writable:false,enumerable:false,configurable:true})}else{u.hasOwnProperty=function(e){return e in u.$model}}c.forEach(function(e){e()});return u}function Lt(e,t,n,r){if(e.$events){mt.$fire.call(e,t,n,r)}}function Ot(e,t,n,r){var i=e[t];if(r==="array"){if(!Array.isArray(n)||i===n){return i}i._.$unwatch();i.clear();i._.$watch();i.pushArray(n.concat());return i}else{var s=e.$events[t];var o=i.$events.$withProxyPool;if(o){ii(o,"with");i.$events.$withProxyPool=null}var u=Ct(n);u.$events[f]=s;wt[u.$id]=function(e){while(e=s.shift()){(function(e){avalon.nextTick(function(){var t=e.type;if(t&&I[t]){e.rollback&&e.rollback();I[t](e,e.vmodels)}})})(e)}delete wt[u.$id]};return u}}function _t(e){var t=[];t.$id=M();t.$model=e;t.$events={};t.$events[f]=[];t._=Ct({length:e.length});t._.$watch("length",function(e,n){t.$fire("length",e,n)});for(var n in mt){t[n]=mt[n]}avalon.mix(t,Ht);return t}function Dt(e,t,n,r,i,s,o){var u=this.length,a=2;while(--a){switch(e){case"add":var f=this.$model.slice(t,t+n).map(function(e){if(v.test(avalon.type(e))){return e.$id?e:Ct(e,0,e)}else{return e}});Pt.apply(this,[t,0].concat(f));this._fire("add",t,n);break;case"del":var l=this._splice(t,n);this._fire("del",t,n);break}if(i){e=i;t=s;n=o;a=2;i=0}}this._fire("index",r);if(this.length!==u){this._.length=this.length}return l}function Bt(e,t){var n={};for(var r=0,i=t.length;r<i;r++){n[r]=e[r];var s=t[r];if(s in n){e[r]=n[s];delete n[s]}else{e[r]=e[s]}}}function Ft(e){x[n]=e;avalon.openComputedCollect=true;var t=e.evaluator;if(t){try{var i=jt.test(e.type)?e:t.apply(0,e.args);e.handler(i,e.element,e)}catch(s){delete e.evaluator;var o=e.element;if(o.nodeType===3){var u=o.parentNode;if(st.commentInterpolate){u.replaceChild(r.createComment(e.value),o)}else{o.data=ot+e.value+ut}}}}avalon.openComputedCollect=false;delete x[n]}function It(e){var t=x[n];if(e&&t&&avalon.Array.ensure(e,t)&&t.element){qt(t,e)}}function qt(e,t){e.$uuid=e.$uuid||M();t.$uuid=t.$uuid||M();var n={data:e,list:t,$$uuid:e.$uuid+t.$uuid};if(!zt[n.$$uuid]){zt[n.$$uuid]=1;zt.push(n)}}function Rt(e){e.element=null;e.rollback&&e.rollback();for(var t in e){e[t]=null}}function Ut(e){try{if(!e.parentNode){return true}}catch(t){return true}return e.msRetain?0:e.nodeType===1?typeof e.sourceIndex==="number"?e.sourceIndex===0:!N.contains(e):!avalon.contains(N,e)}function Vt(){var e=zt.length;var t=e;var n=0;var r;var i=[];var s={};var o={};while(r=zt[--e]){var u=r.data;var a=u.type;if(s[a]){s[a]++}else{s[a]=1;i.push(a)}}var f=false;i.forEach(function(e){if(Xt[e]!==s[e]){o[e]=1;f=true}});e=t;if(f){while(r=zt[--e]){u=r.data;if(u.element===void 0)continue;if(o[u.type]&&Ut(u.element)){n++;zt.splice(e,1);delete zt[r.$$uuid];avalon.Array.remove(r.list,u);Rt(u);r.data=r.list=null}}}Xt=s;Wt=new Date}function $t(e){if(e&&e.length){if(new Date-Wt>444&&typeof e[0]==="object"){Vt()}var t=S.call(arguments,1);for(var n=e.length,r;r=e[--n];){var i=r.element;if(i&&i.parentNode){if(r.$repeat){r.handler.apply(r,t)}else if(r.type!=="on"){var s=r.evaluator||A;r.handler(s.apply(0,r.args||[]),i,r)}}}}}function nn(e){var t=e.nodeName;return t.toLowerCase()===t&&e.scopeName&&e.outerText===""}function rn(e){if(e.currentStyle.behavior!=="url(#default#VML)"){e.style.behavior="url(#default#VML)";e.style.display="inline-block";e.style.zoom=1}}function on(e,t,n){var r=setTimeout(function(){var i=e.innerHTML;clearTimeout(r);if(i===n){t()}else{on(e,t,i)}})}function un(e,t){var n=e.getAttribute("avalonctrl")||t.$id;e.setAttribute("avalonctrl",n);t.$events.expr=e.tagName+'[avalonctrl="'+n+'"]'}function fn(e,t){for(var n=0,r;r=e[n++];){r.vmodels=t;I[r.type](r,t);if(r.evaluator&&r.element&&r.element.nodeType===1){r.element.removeAttribute(r.name)}}e.length=0}function vn(e,t){return e.priority-t.priority}function mn(e,t){var n=Tn?Tn(e):avalon.slice(e.attributes);var r=[],i={},s;for(var o=0,a;a=n[o++];){if(a.specified){if(s=a.name.match(cn)){var f=s[1];var l=s[2]||"";var c=a.value;var h=a.name;i[h]=c;if(pn[f]){l=f;f="on"}else if(dn[f]){u("warning!请改用ms-attr-"+f+"代替ms-"+f+"！");if(f==="enabled"){u("warning!ms-enabled或ms-attr-enabled已经被废弃");f="disabled";c="!("+c+")"}l=f;f="attr";e.removeAttribute(h);h="ms-attr-"+l;e.setAttribute(h,c);s=[h];i[h]=c}if(typeof I[f]==="function"){var p={type:f,param:l,element:e,name:s[0],value:c,priority:f in hn?hn[f]:f.charCodeAt(0)*10+(Number(l)||0)};if(f==="html"||f==="text"){var d=Dn(c);avalon.mix(p,d);p.filters=p.filters.replace(An,function(){p.type="html";p.group=1;return""})}if(h==="ms-if-loop"){p.priority+=100}if(t.length){r.push(p);if(f==="widget"){e.msData=e.msData||i}}}}}}r.sort(vn);var v=e.type;if(v&&i["ms-duplex"]){if(i["ms-attr-checked"]&&/radio|checkbox/.test(v)){u("warning!"+v+"控件不能同时定义ms-attr-checked与ms-duplex")}if(i["ms-attr-value"]&&/text|password/.test(v)){u("warning!"+v+"控件不能同时定义ms-attr-value与ms-duplex")}}var m=true;for(o=0;p=r[o];o++){f=p.type;if(gn.test(f)){return fn(r.slice(0,o+1),t)}else if(m){m=!yn.test(f)}}fn(r,t);if(m&&!sn[e.tagName]&&lt.test(e.innerHTML.replace(Mn,"<").replace(_n,">"))){ln&&ln(e);Nn(e,t)}}function Nn(e,t){var n=e.firstChild;while(n){var r=n.nextSibling;kn(n,n.nodeType,t);n=r}}function Cn(e,t){for(var n=0,r;r=e[n++];){kn(r,r.nodeType,t)}}function kn(e,t,n){if(t===1){Ln(e,n)}else if(t===3&&at.test(e.data)){Hn(e,n)}else if(st.commentInterpolate&&t===8&&!at.test(e.nodeValue)){Hn(e,n)}}function Ln(e,t,n){var r=e.getAttribute("ms-skip");if(!e.getAttributeNode){return u("warning "+e.tagName+" no getAttributeNode method")}var i=e.getAttributeNode("ms-important");var s=e.getAttributeNode("ms-controller");if(typeof r==="string"){return}else if(n=i||s){var o=avalon.vmodels[n.value];if(!o){return}t=n===i?[o]:[o].concat(t);var a=n.name;e.removeAttribute(a);avalon(e).removeClass(a);un(e,o)}mn(e,t)}function Dn(e){if(e.indexOf("|")>0){var t=e.replace(rstringLiteral,function(e){return Array(e.length+1).join("1")});var n=t.replace(On,"ᄢ㍄").indexOf("|");if(n>-1){return{filters:e.slice(n),value:e.slice(0,n),expr:true}}}return{value:e,filters:"",expr:true}}function Pn(e){var t=[],n,r=0,i;do{i=e.indexOf(ot,r);if(i===-1){break}n=e.slice(r,i);if(n){t.push({value:n,filters:"",expr:false})}r=i+ot.length;i=e.indexOf(ut,r);if(i===-1){break}n=e.slice(r,i);if(n){t.push(Dn(n))}r=i+ut.length}while(1);n=e.slice(r);if(n){t.push({value:n,expr:false,filters:""})}return t}function Hn(e,t){var n=[];if(e.nodeType===8){var i=Dn(e.nodeValue);var s=[i]}else{s=Pn(e.data)}if(s.length){for(var o=0;i=s[o++];){var u=r.createTextNode(i.value);if(i.expr){i.type="text";i.element=u;i.filters=i.filters.replace(An,function(){i.type="html";i.group=1;return""});n.push(i)}C.appendChild(u)}e.parentNode.replaceChild(C,e);if(n.length)fn(n,t)}}function Bn(e){return e.replace(/([a-z\d])([A-Z]+)/g,"$1-$2").toLowerCase()}function jn(e){if(e.indexOf("-")<0&&e.indexOf("_")<0){return e}return e.replace(/[-_][^-_]/g,function(e){return e.charAt(1).toUpperCase()})}function In(e){if(!("classList"in e)){e.classList={node:e};for(var t in Fn){e.classList[t.slice(1)]=Fn[t]}}return e.classList}function qn(e){try{if(typeof e==="object")return e;e=e==="true"?true:e==="false"?false:e==="null"?null:+e+""===e?+e:Rn.test(e)?avalon.parseJSON(e):e}catch(t){}return e}function Vn(e){return e.window&&e.document?e:e.nodeType===9?e.defaultView||e.parentWindow:false}function ir(e,t){if(e.offsetWidth<=0){if(rr.test($n["@:get"](e,"display"))){var n={node:e};for(var r in nr){n[r]=e.style[r];e.style[r]=nr[r]}t.push(n)}var i=e.parentNode;if(i&&i.nodeType===1){ir(i,t)}}}function sr(e){var t=e.tagName.toLowerCase();return t==="input"&&/checkbox|radio/.test(e.type)?"checked":t}function yr(e,t,n,r){var i=[],s=" = "+n+".";for(var o=e.length,u;u=e[--o];){if(t.hasOwnProperty(u)){i.push(u+s+u);r.vars.push(u);if(r.type==="duplex"){e.get=n+"."+u}e.splice(o,1)}}return i}function br(e){var t=[],n={};for(var r=0;r<e.length;r++){var i=e[r];var s=i&&typeof i.$id==="string"?i.$id:i;if(!n[s]){n[s]=t.push(i)}}return t}function Lr(e,t){t=t.replace(xr,"").replace(Tr,function(){return"],|"}).replace(Nr,function(e,t){return"["+fr(t)}).replace(Cr,function(){return'"],["'}).replace(kr,function(){return'",'})+"]";return"return avalon.filters.$filter("+e+", "+t+")"}function Ar(e,t,r){var i=r.type;var s=r.filters||"";var o=t.map(function(e){return String(e.$id).replace(Sr,"$1")})+e+i+s;var a=gr(e).concat(),f=[],l=[],c=[],h="";t=br(t);r.vars=[];for(var p=0,d=t.length;p<d;p++){if(a.length){var v="vm"+n+"_"+p;l.push(v);c.push(t[p]);f.push.apply(f,yr(a,t[p],v,r))}}if(!f.length&&i==="duplex"){return}if(i!=="duplex"&&(e.indexOf("||")>-1||e.indexOf("&&")>-1)){r.vars.forEach(function(t){var n=new RegExp("\\b"+t+"(?:\\.\\w+|\\[\\w+\\])+","ig");e=e.replace(n,function(n){var r=n.charAt(t.length);var i=D?e.slice(arguments[1]+n.length):RegExp.rightContext;var s=/^\s*\(/.test(i);if(r==="."||r==="["||s){var o="var"+String(Math.random()).replace(/^0\./,"");if(s){var u=n.split(".");if(u.length>2){var a=u.pop();f.push(o+" = "+u.join("."));return o+"."+a}else{return n}}f.push(o+" = "+n);return o}else{return n}})})}r.args=c;var m=wr.get(o);if(m){r.evaluator=m;return}h=f.join(", ");if(h){h="var "+h}if(/\S/.test(s)){if(!/text|html/.test(r.type)){throw Error("ms-"+r.type+"不支持过滤器")}e="\nvar ret"+n+" = "+e+";\r\n";e+=Lr("ret"+n,s)}else if(i==="duplex"){var g="'use strict';\nreturn function(vvv){\n	"+h+";\n	if(!arguments.length){\n		return "+e+"\n	}\n	"+(!Er.test(e)?a.get:e)+"= vvv;\n} ";try{m=Function.apply(A,l.concat(g));r.evaluator=wr.put(o,m)}catch(y){u("debug: parse error,"+y.message)}return}else if(i==="on"){if(e.indexOf("(")===-1){e+=".call(this, $event)"}else{e=e.replace("(",".call(this,")}l.push("$event");e="\nreturn "+e+";";var b=e.lastIndexOf("\nreturn");var w=e.slice(0,b);var E=e.slice(b);e=w+"\n"+E}else{e="\nreturn "+e+";"}try{m=Function.apply(A,l.concat("'use strict';\n"+h+e));r.evaluator=wr.put(o,m)}catch(y){u("debug: parse error,"+y.message)}finally{a=f=l=null}}function Or(e,t,n,r,i){if(Array.isArray(r)){e=r.map(function(e){return e.expr?"("+e.value+")":fr(e.value)}).join(" + ")}Ar(e,t,n);if(n.evaluator&&!i){n.handler=q[n.handlerName||n.type];Ft(n)}}function Ir(e,t,n){var i=e.templateCache&&e.templateCache[t];if(i){var s=r.createDocumentFragment(),o;while(o=i.firstChild){s.appendChild(o)}return s}return avalon.parseHTML(n)}function Rr(e){return e==null?"":e}function Ur(e,t,n,r){t.param.replace(/\w+/g,function(r){var i=avalon.duplexHooks[r];if(i&&typeof i[n]==="function"){e=i[n](e,t)}});return e}function Xr(){for(var e=Wr.length-1;e>=0;e--){var t=Wr[e];if(t()===false){Wr.splice(e,1)}}if(!Wr.length){clearInterval(zr)}}function Kr(e,t,n,r){var i=e.template.cloneNode(true);var s=avalon.slice(i.childNodes);if(n.$stamp){i.insertBefore(n.$stamp,i.firstChild)}t.appendChild(i);var o=[n].concat(e.vmodels);var u={nodes:s,vmodels:o};r.push(u)}function Qr(e,t){var n=e.proxies[t];return n?n.$stamp:e.element}function Gr(e,t,n){while(true){var r=t.previousSibling;if(!r)break;r.parentNode.removeChild(r);n&&n.call(r);if(r===e){break}}}function ei(e){var t={$host:[],$outer:{},$stamp:1,$index:0,$first:false,$last:false,$remove:avalon.noop};t[e]={get:function(){return this.$host[this.$index]},set:function(e){this.$host.set(this.$index,e)}};var n={$last:1,$first:1,$index:1};var r=Ct(t,n);var i=r.$events;i[e]=i.$first=i.$last=i.$index;r.$id=M("$proxy$each");return r}function ti(e,t){var n=t.param||"el",r;for(var i=0,s=Yr.length;i<s;i++){var o=Yr[i];if(o&&o.hasOwnProperty(n)){r=o;Yr.splice(i,1)}}if(!r){r=ei(n)}var u=t.$repeat;var a=u.length-1;r.$index=e;r.$first=e===0;r.$last=e===a;r.$host=u;r.$outer=t.$outer;r.$stamp=t.clone.cloneNode(false);r.$remove=function(){return u.removeAt(r.$index)};return r}function ni(){var e=Ct({$key:"",$outer:{},$host:{},$val:{get:function(){return this.$host[this.$key]},set:function(e){this.$host[this.$key]=e}}},{$val:1});e.$id=M("$proxy$with");return e}function ri(e,t){var n=Zr.pop();if(!n){n=ni()}var r=t.$repeat;n.$key=e;n.$host=r;n.$outer=t.$outer;if(r.$events){n.$events.$val=r.$events[e]}else{n.$events={}}return n}function ii(e,t){var n=t==="each"?Yr:Zr;avalon.each(e,function(e,t){if(t.$events){for(var r in t.$events){if(Array.isArray(t.$events[r])){t.$events[r].forEach(function(e){if(typeof e==="object")Rt(e)});t.$events[r].length=0}}t.$host=t.$outer={};if(n.unshift(t)>st.maxRepeatSize){n.pop()}}});if(t==="each")e.length=0}function si(e,t){var n="_"+e;if(!si[n]){var i=r.createElement(e);N.appendChild(i);if(T){t=getComputedStyle(i,null).display}else{t=i.currentStyle.display}N.removeChild(i);si[n]=t}return si[n]}function pi(e,t,n,r){e=(e+"").replace(/[^0-9+\-Ee.]/g,"");var i=!isFinite(+e)?0:+e,s=!isFinite(+t)?3:Math.abs(t),o=r||",",u=n||".",a="",f=function(e,t){var n=Math.pow(10,t);return""+(Math.round(e*n)/n).toFixed(t)};a=(s?f(i,s):""+Math.round(i)).split(".");if(a[0].length>3){a[0]=a[0].replace(/\B(?=(?:\d{3})+(?!\d))/g,o)}if((a[1]||"").length<s){a[1]=a[1]||"";a[1]+=(new Array(s-a[1].length+1)).join("0")}return a.join(u)}function bi(){try{N.doScroll("left");yi()}catch(e){setTimeout(bi)}}var n=new Date-0;var r=e.document;var i=r.getElementsByTagName("head")[0];var s=i.insertBefore(document.createElement("avalon"),i.firstChild);s.innerHTML="X<style id='avalonStyle'>.avalonHide{ display: none!important }</style>";s.setAttribute("ms-skip","1");s.className="avalonHide";var o=/\[native code\]/;var f="$"+n;var l=e.require;var c=e.define;var h;var p=false;var d=/[^, ]+/g;var v=/^(?:object|array)$/;var m=/^\[object SVG\w*Element\]$/;var g=/^\[object (?:Window|DOMWindow|global)\]$/;var y=Object.prototype;var b=y.hasOwnProperty;var w=y.toString;var E=Array.prototype;var S=E.slice;var x={};var T=e.dispatchEvent;var N=r.documentElement;var C=r.createDocumentFragment();var k=r.createElement("div");var L={};"Boolean Number String Function Array Date RegExp Object Error".replace(d,function(e){L["[object "+e+"]"]=e.toLowerCase()});var M=function(e){e=e||"avalon";return(e+Math.random()+Math.random()).replace(/0\./g,"")};var D=_();avalon=function(e){return new avalon.init(e)};avalon.nextTick=new function(){function s(){var e=i.length;for(var t=0;t<e;t++){i[t]()}i=i.slice(e)}var t=e.setImmediate;var n=e.MutationObserver;var r=T&&e.postMessage;if(t){return t.bind(e)}var i=[];if(n){var o=document.createTextNode("avalon");(new n(s)).observe(o,{characterData:true});return function(e){i.push(e);o.data=Math.random()}}if(r){e.addEventListener("message",function(t){var n=t.source;if((n===e||n===null)&&t.data==="process-tick"){t.stopPropagation();s()}});return function(t){i.push(t);e.postMessage("process-tick","*")}}return function(e){setTimeout(e,0)}};avalon.init=function(e){this[0]=this.element=e};avalon.fn=avalon.prototype=avalon.init.prototype;avalon.type=function(e){if(e==null){return String(e)}return typeof e==="object"||typeof e==="function"?L[w.call(e)]||"object":typeof e};var P=typeof alert==="object"?function(e){try{return/^\s*\bfunction\b/.test(e+"")}catch(t){return false}}:function(e){return w.call(e)==="[object Function]"};avalon.isFunction=P;avalon.isWindow=function(e){if(!e)return false;return e==e.document&&e.document!=e};if(H(e)){avalon.isWindow=H}var B;for(B in avalon({})){break}var j=B!=="0";avalon.isPlainObject=function(e,t){if(!e||avalon.type(e)!=="object"||e.nodeType||avalon.isWindow(e)){return false}try{if(e.constructor&&!b.call(e,"constructor")&&!b.call(e.constructor.prototype,"isPrototypeOf")){return false}}catch(n){return false}if(j){for(t in e){return b.call(e,t)}}for(t in e){}return t===void 0||b.call(e,t)};if(o.test(Object.getPrototypeOf)){avalon.isPlainObject=function(e){return w.call(e)==="[object Object]"&&Object.getPrototypeOf(e)===y}}avalon.mix=avalon.fn.mix=function(){var e,t,n,r,i,s,o=arguments[0]||{},u=1,a=arguments.length,f=false;if(typeof o==="boolean"){f=o;o=arguments[1]||{};u++}if(typeof o!=="object"&&!P(o)){o={}}if(u===a){o=this;u--}for(;u<a;u++){if((e=arguments[u])!=null){for(t in e){n=o[t];try{r=e[t]}catch(l){continue}if(o===r){continue}if(f&&r&&(avalon.isPlainObject(r)||(i=Array.isArray(r)))){if(i){i=false;s=n&&Array.isArray(n)?n:[]}else{s=n&&avalon.isPlainObject(n)?n:{}}o[t]=avalon.mix(f,s,r)}else if(r!==void 0){o[t]=r}}}}return o};avalon.mix({rword:d,subscribers:f,version:1.42,ui:{},log:u,slice:T?function(e,t,n){return S.call(e,t,n)}:function(e,t,n){var r=[];var i=e.length;if(n===void 0)n=i;if(typeof n==="number"&&isFinite(n)){t=F(t,i);n=F(n,i);for(var s=t;s<n;++s){r[s-t]=e[s]}}return r},noop:A,error:function(e,t){throw(t||Error)(e)},oneObject:O,range:function(e,t,n){n||(n=1);if(t==null){t=e||0;e=0}var r=-1,i=Math.max(0,Math.ceil((t-e)/n)),s=new Array(i);while(++r<i){s[r]=e;e+=n}return s},eventHooks:{},bind:function(e,t,n,r){var i=avalon.eventHooks;var s=i[t];if(typeof s==="object"){t=s.type;if(s.deel){n=s.deel(e,t,n,r)}}var o=T?n:function(t){n.call(e,tt(t))};if(T){e.addEventListener(t,o,!!r)}else{e.attachEvent("on"+t,o)}return o},unbind:function(e,t,n,r){var i=avalon.eventHooks;var s=i[t];var o=n||A;if(typeof s==="object"){t=s.type;if(s.deel){n=s.deel(e,t,n,false)}}if(T){e.removeEventListener(t,o,!!r)}else{e.detachEvent("on"+t,o)}},css:function(e,t,n){if(e instanceof avalon){e=e[0]}var r=/[_-]/.test(t)?jn(t):t,i;t=avalon.cssName(r)||r;if(n===void 0||typeof n==="boolean"){i=$n[r+":get"]||$n["@:get"];if(t==="background"){t="backgroundColor"}var s=i(e,t);return n===true?parseFloat(s)||0:s}else if(n===""){e.style[t]=""}else{if(n==null||n!==n){return}if(isFinite(n)&&!avalon.cssNumber[r]){n+="px"}i=$n[r+":set"]||$n["@:set"];i(e,t,n)}},each:function(e,t){if(e){var n=0;if(R(e)){for(var r=e.length;n<r;n++){if(t(n,e[n])===false)break}}else{for(n in e){if(e.hasOwnProperty(n)&&t(n,e[n])===false){break}}}}},getWidgetData:function(e,t){var n=avalon(e).data();var r={};for(var i in n){if(i.indexOf(t)===0){r[i.replace(t,"").replace(/\w/,function(e){return e.toLowerCase()})]=n[i]}}return r},Array:{ensure:function(e,t){if(e.indexOf(t)===-1){return e.push(t)}},removeAt:function(e,t){return!!e.splice(t,1).length},remove:function(e,t){var n=e.indexOf(t);if(~n)return avalon.Array.removeAt(e,n);return false}}});var I=avalon.bindingHandlers={};var q=avalon.bindingExecutors={};var U=new function(){function e(e){this.size=0;this.limit=e;this.head=this.tail=void 0;this._keymap={}}var t=e.prototype;t.put=function(e,t){var n={key:e,value:t};this._keymap[e]=n;if(this.tail){this.tail.newer=n;n.older=this.tail}else{this.head=n}this.tail=n;if(this.size===this.limit){this.shift()}else{this.size++}return t};t.shift=function(){var e=this.head;if(e){this.head=this.head.newer;this.head.older=e.newer=e.older=this._keymap[e.key]=void 0}};t.get=function(e){var t=this._keymap[e];if(t===void 0)return;if(t===this.tail){return t.value}if(t.newer){if(t===this.head){this.head=t.newer}t.newer.older=t.older}if(t.older){t.older.newer=t.newer}t.newer=void 0;t.older=this.tail;if(this.tail){this.tail.newer=t}this.tail=t;return t.value};return e};if(!"司徒正美".trim){var z=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g;String.prototype.trim=function(){return this.replace(z,"")}}var W=!{toString:null}.propertyIsEnumerable("toString"),X=function(){}.propertyIsEnumerable("prototype"),V=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],$=V.length;if(!Object.keys){Object.keys=function(e){var t=[];var n=X&&typeof e==="function";if(typeof e==="string"||e&&e.callee){for(var r=0;r<e.length;++r){t.push(String(r))}}else{for(var i in e){if(!(n&&i==="prototype")&&b.call(e,i)){t.push(String(i))}}}if(W){var s=e.constructor,o=s&&s.prototype===e;for(var u=0;u<$;u++){var a=V[u];if(!(o&&a==="constructor")&&b.call(e,a)){t.push(a)}}}return t}}if(!Array.isArray){Array.isArray=function(e){return w.call(e)==="[object Array]"}}if(!A.bind){Function.prototype.bind=function(e){if(arguments.length<2&&e===void 0)return this;var t=this,n=arguments;return function(){var r=[],i;for(i=1;i<n.length;i++)r.push(n[i]);for(i=0;i<arguments.length;i++)r.push(arguments[i]);return t.apply(e,r)}}}if(!o.test([].map)){avalon.mix(E,{indexOf:function(e,t){var n=this.length,r=~~t;if(r<0)r+=n;for(;r<n;r++)if(this[r]===e)return r;return-1},lastIndexOf:function(e,t){var n=this.length,r=t==null?n-1:t;if(r<0)r=Math.max(0,n+r);for(;r>=0;r--)if(this[r]===e)return r;return-1},forEach:J("","_",""),filter:J("r=[],j=0,","if(_)r[j++]=this[i]","return r"),map:J("r=[],","r[i]=_","return r"),some:J("","if(_)return true","return false"),every:J("","if(!_)return false","return true")})}avalon.contains=K;if(!r.contains){r.contains=function(e){return K(r,e)}}if(e.SVGElement){if(!r.createTextNode("x").contains){Node.prototype.contains=function(e){return!!(this.compareDocumentPosition(e)&16)}}var G="http://www.w3.org/2000/svg";var Y=r.createElementNS(G,"svg");Y.innerHTML='<circle cx="50" cy="50" r="40" fill="red" />';if(!m.test(Y.firstChild)){function Z(e,t){if(e&&e.childNodes){var n=e.childNodes;for(var i=0,s;s=n[i++];){if(s.tagName){var o=r.createElementNS(G,s.tagName.toLowerCase());E.forEach.call(s.attributes,function(e){o.setAttribute(e.name,e.value)});Z(s,o);t.appendChild(o)}}}}Object.defineProperties(SVGElement.prototype,{outerHTML:{enumerable:true,configurable:true,get:Q,set:function(e){var t=this.tagName.toLowerCase(),n=this.parentNode,i=avalon.parseHTML(e);if(t==="svg"){n.insertBefore(i,this)}else{var s=r.createDocumentFragment();Z(i,s);n.insertBefore(s,this)}n.removeChild(this)}},innerHTML:{enumerable:true,configurable:true,get:function(){var e=this.outerHTML;var t=new RegExp("<"+this.nodeName+'\\b(?:(["\'])[^"]*?(\\1)|[^>])*>',"i");var n=new RegExp("</"+this.nodeName+">$","i");return e.replace(t,"").replace(n,"")},set:function(e){if(avalon.clearHTML){avalon.clearHTML(this);var t=avalon.parseHTML(e);Z(t,this)}}}})}}if(!N.outerHTML&&e.HTMLElement){HTMLElement.prototype.__defineGetter__("outerHTML",Q)}var et=/^(?:mouse|contextmenu|drag)|click/;var nt=avalon.eventHooks;if(!("onmouseenter"in N)){avalon.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(e,t){nt[e]={type:t,deel:function(t,n,r){return function(n){var i=n.relatedTarget;if(!i||i!==t&&!(t.compareDocumentPosition(i)&16)){delete n.type;n.type=e;return r.call(t,n)}}}}})}avalon.each({AnimationEvent:"animationend",WebKitAnimationEvent:"webkitAnimationEnd"},function(t,n){if(e[t]&&!nt.animationend){nt.animationend={type:n}}});if(!("oninput"in r.createElement("input"))){nt.input={type:"propertychange",deel:function(e,t,n){return function(t){if(t.propertyName==="value"){t.type="input";return n.call(e,t)}}}}}if(r.onmousewheel===void 0){var rt=r.onwheel!==void 0?"wheel":"DOMMouseScroll";var it=rt==="wheel"?"deltaY":"detail";nt.mousewheel={type:rt,deel:function(e,t,n){return function(t){t.wheelDeltaY=t.wheelDelta=t[it]>0?-120:120;t.wheelDeltaX=0;if(Object.defineProperty){Object.defineProperty(t,"type",{value:"mousewheel"})}n.call(e,t)}}}}var ot,ut,at,ft,lt,ct=/[-.*+?^${}()|[\]\/\\]/g;var pt={loader:function(t){var n=h&&t;e.require=n?h:l;e.define=n?h.define:c},interpolate:function(e){ot=e[0];ut=e[1];if(ot===ut){throw new SyntaxError("openTag!==closeTag")}else if(e+""==="<!--,-->"){st.commentInterpolate=true}else{var t=ot+"test"+ut;k.innerHTML=t;if(k.innerHTML!==t&&k.innerHTML.indexOf("&lt;")>-1){throw new SyntaxError("此定界符不合法")}k.innerHTML=""}var n=ht(ot),r=ht(ut);at=new RegExp(n+"(.*?)"+r);ft=new RegExp(n+"(.*?)"+r,"g");lt=new RegExp(n+".*?"+r+"|\\sms-")}};st.debug=true;st.plugins=pt;st.plugins["interpolate"](["{{","}}"]);st.paths={};st.shim={};st.maxRepeatSize=100;avalon.config=st;var dt=/(\w+)\[(avalonctrl)="(\S+)"\]/;var vt=r.querySelectorAll?function(e){return r.querySelectorAll(e)}:function(e){var t=e.match(dt);var n=r.getElementsByTagName(t[1]);var i=[];for(var s=0,o;o=n[s++];){if(o.getAttribute(t[2])===t[3]){i.push(o)}}return i};var mt={$watch:function(e,t){if(typeof t==="function"){var n=this.$events[e];if(n){n.push(t)}else{this.$events[e]=[t]}}else{this.$events=this.$watch.backup}return this},$unwatch:function(e,t){var n=arguments.length;if(n===0){this.$watch.backup=this.$events;this.$events={}}else if(n===1){this.$events[e]=[]}else{var r=this.$events[e]||[];var i=r.length;while(~--i<0){if(r[i]===t){return r.splice(i,1)}}}return this},$fire:function(e){var t,n,i,s;if(/^(\w+)!(\S+)$/.test(e)){t=RegExp.$1;e=RegExp.$2}var o=this.$events;if(!o)return;var u=S.call(arguments,1);var a=[e].concat(u);if(t==="all"){for(n in avalon.vmodels){i=avalon.vmodels[n];if(i!==this){i.$fire.apply(i,a)}}}else if(t==="up"||t==="down"){var f=o.expr?vt(o.expr):[];if(f.length===0)return;for(n in avalon.vmodels){i=avalon.vmodels[n];if(i!==this){if(i.$events.expr){var l=vt(i.$events.expr);if(l.length===0){continue}Array.prototype.forEach.call(l,function(e){Array.prototype.forEach.call(f,function(n){var r=t==="down"?n.contains(e):e.contains(n);if(r){e._avalon=i}})})}}}var c=r.getElementsByTagName("*");var h=[];Array.prototype.forEach.call(c,function(e){if(e._avalon){h.push(e._avalon);e._avalon="";e.removeAttribute("_avalon")}});if(t==="up"){h.reverse()}for(n=0;s=h[n++];){if(s.$fire.apply(s,a)===false){break}}}else{var p=o[e]||[];var d=o.$all||[];for(n=0;s=p[n++];){if(P(s))s.apply(this,u)}for(n=0;s=d[n++];){if(P(s))s.apply(this,arguments)}}}};var gt=avalon.vmodels={};avalon.define=function(e,t){var n=e.$id||e;if(!n){u("warning: vm必须指定$id")}if(gt[n]){u("warning: "+n+" 已经存在于avalon.vmodels中")}if(typeof e==="object"){var r=Ct(e)}else{var i={$watch:A};t(i);r=Ct(i);p=true;t(r);p=false}r.$id=n;return gt[n]=r};var yt=String("$id,$watch,$unwatch,$fire,$events,$model,$skipArray").match(d);var wt={};var St=Object.defineProperty;var xt=true;try{St({},"_",{value:"x"});var Tt=Object.defineProperties}catch(Nt){xt=false}var kt=Object.is||function(e,t){if(e===0&&t===0){return 1/e===1/t}else if(e!==e){return t!==t}else{return e===t}};var At=T?function(e){var t={};for(var n in e){t[n]={get:e[n],set:e[n],enumerable:true,configurable:true}}return t}:function(e){return e};if(!xt){if("__defineGetter__"in avalon){St=function(e,t,n){if("value"in n){e[t]=n.value}if("get"in n){e.__defineGetter__(t,n.get)}if("set"in n){e.__defineSetter__(t,n.set)}return e};Tt=function(e,t){for(var n in t){if(t.hasOwnProperty(n)){St(e,n,t[n])}}return e}}if(D){e.execScript(["Function parseVB(code)","	ExecuteGlobal(code)","End Function","Dim VBClassBodies",'Set VBClassBodies=CreateObject("Scripting.Dictionary")',"Function findOrDefineVBClass(name,body)","	Dim found",'	found=""',"	For Each key in VBClassBodies","		If body=VBClassBodies.Item(key) Then","			found=key","			Exit For","		End If","	next",'	If found="" Then','		parseVB("Class " + name + body)',"		VBClassBodies.Add name, body","		found=name","	End If","	findOrDefineVBClass=found","End Function"].join("\n"),"VBScript");function Mt(e,t,n,r){var i=t[n];if(arguments.length===4){i.call(e,r)}else{return i.call(e)}}Tt=function(t,r,i){var s="VBClass"+setTimeout("1"),o=[];o.push("\r\n	Private [__data__], [__proxy__]","	Public Default Function [__const__](d, p)","		Set [__data__] = d: set [__proxy__] = p","		Set [__const__] = Me","	End Function");for(t in i){if(!r.hasOwnProperty(t)){o.push("	Public ["+t+"]")}}yt.forEach(function(e){if(!r.hasOwnProperty(e)){o.push("	Public ["+e+"]")}});o.push("	Public ["+"hasOwnProperty"+"]");for(t in r){o.push("	Public Property Let ["+t+"](val"+n+")",'		Call [__proxy__](Me,[__data__], "'+t+'", val'+n+")","	End Property","	Public Property Set ["+t+"](val"+n+")",'		Call [__proxy__](Me,[__data__], "'+t+'", val'+n+")","	End Property","	Public Property Get ["+t+"]","	On Error Resume Next","		Set["+t+'] = [__proxy__](Me,[__data__],"'+t+'")',"	If Err.Number <> 0 Then","		["+t+'] = [__proxy__](Me,[__data__],"'+t+'")',"	End If","	On Error Goto 0","	End Property")}o.push("End Class");var u=o.join("\r\n"),a=e["findOrDefineVBClass"](s,u);if(a===s){e.parseVB(["Function "+s+"Factory(a, b)","	Dim o","	Set o = (New "+s+")(a, b)","	Set "+s+"Factory = o","End Function"].join("\r\n"))}var f=e[a+"Factory"](r,Mt);return f}}}var Pt=E.splice;var Ht={_splice:Pt,_fire:function(e,t,n){$t(this.$events[f],e,t,n)},size:function(){return this._.length},pushArray:function(e){var t=e.length,n=this.length;if(t){E.push.apply(this.$model,e);Dt.call(this,"add",n,t,Math.max(0,n-1))}return t+n},push:function(){var e=[];var t,n=arguments.length;for(t=0;t<n;t++){e[t]=arguments[t]}return this.pushArray(e)},unshift:function(){var e=arguments.length,t=this.length;if(e){E.unshift.apply(this.$model,arguments);Dt.call(this,"add",0,e,0)}return e+t},shift:function(){if(this.length){var e=this.$model.shift();Dt.call(this,"del",0,1,0);return e}},pop:function(){var e=this.length;if(e){var t=this.$model.pop();Dt.call(this,"del",e-1,1,Math.max(0,e-2));return t}},splice:function(e){var t=arguments.length,n=[],r;var i=Pt.apply(this.$model,arguments);if(i.length){n.push("del",e,i.length,0);r=true}if(t>2){if(r){n.splice(3,1,0,"add",e,t-2)}else{n.push("add",e,t-2,0)}r=true}if(r){return Dt.apply(this,n)}else{return[]}},contains:function(e){return this.indexOf(e)!==-1},remove:function(e){return this.removeAt(this.indexOf(e))},removeAt:function(e){if(e>=0){this.$model.splice(e,1);return Dt.call(this,"del",e,1,0)}return[]},clear:function(){this.$model.length=this.length=this._.length=0;this._fire("clear",0);return this},removeAll:function(e){if(Array.isArray(e)){e.forEach(function(e){this.remove(e)},this)}else if(typeof e==="function"){for(var t=this.length-1;t>=0;t--){var n=this[t];if(e(n,t)){this.removeAt(t)}}}else{this.clear()}},ensure:function(e){if(!this.contains(e)){this.push(e)}return this},set:function(e,t){if(e>=0){var n=avalon.type(t);if(t&&t.$model){t=t.$model}var r=this[e];if(n==="object"){for(var i in t){if(r.hasOwnProperty(i)){r[i]=t[i]}}}else if(n==="array"){r.clear().push.apply(r,t)}else if(r!==t){this[e]=t;this.$model[e]=t;this._fire("set",e,t)}}return this}};"sort,reverse".replace(d,function(e){Ht[e]=function(){var t=this.$model;var n=t.concat();var r=Math.random();var i=[];var s;E[e].apply(t,arguments);for(var o=0,u=n.length;o<u;o++){var a=t[o];var f=n[o];if(kt(a,f)){i.push(o)}else{var l=n.indexOf(a);i.push(l);n[l]=r;s=true}}if(s){Bt(this,i);this._fire("move",i);this._fire("index",0)}return this}});var jt=/^(duplex|on)$/;var zt=avalon.$$subscribers=[];var Wt=new Date;var Xt={};var Jt={area:[1,"<map>","</map>"],param:[1,"<object>","</object>"],col:[2,"<table><colgroup>","</colgroup></table>"],legend:[1,"<fieldset>","</fieldset>"],option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],tr:[2,"<table>","</table>"],td:[3,"<table><tr>","</tr></table>"],g:[1,'<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1">',"</svg>"],_default:T?[0,"",""]:[1,"X<div>","</div>"]};Jt.th=Jt.td;Jt.optgroup=Jt.option;Jt.tbody=Jt.tfoot=Jt.colgroup=Jt.caption=Jt.thead;String("circle,defs,ellipse,image,line,path,polygon,polyline,rect,symbol,text,use").replace(d,function(e){Jt[e]=Jt.g});var Kt=/<([\w:]+)/;var Qt=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/ig;var Gt=T?/[^\d\D]/:/(<(?:script|link|style|meta|noscript))/ig;var Yt=O(["","text/javascript","text/ecmascript","application/ecmascript","application/javascript"]);var Zt=/<(?:tb|td|tf|th|tr|col|opt|leg|cap|area)/;var en=r.createElement("script");var tn=/<|&#?\w+;/;avalon.parseHTML=function(e){var t=C.cloneNode(false);if(typeof e!=="string"){return t}if(!tn.test(e)){t.appendChild(r.createTextNode(e));return t}e=e.replace(Qt,"<$1></$2>").trim();var n=(Kt.exec(e)||["",""])[1].toLowerCase(),i=Jt[n]||Jt._default,s=k,o,u;if(!T){e=e.replace(Gt,"<br class=msNoScope>$1")}s.innerHTML=i[1]+e+i[2];var a=s.getElementsByTagName("script");if(a.length){for(var f=0,l;l=a[f++];){if(Yt[l.type]){u=en.cloneNode(false);E.forEach.call(l.attributes,function(e){if(e&&e.specified){u[e.name]=e.value;u.setAttribute(e.name,e.value)}});u.text=l.text;l.parentNode.replaceChild(u,l)}}}if(!T){var c=i[1]==="X<div>"?s.lastChild.firstChild:s.lastChild;if(c&&c.tagName==="TABLE"&&n!=="tbody"){for(a=c.childNodes,f=0;l=a[f++];){if(l.tagName==="TBODY"&&!l.innerHTML){c.removeChild(l);break}}}a=s.getElementsByTagName("br");var h=a.length;while(l=a[--h]){if(l.className==="msNoScope"){l.parentNode.removeChild(l)}}for(a=s.all,f=0;l=a[f++];){if(nn(l)){rn(l)}}}for(f=i[0];f--;s=s.lastChild){}while(o=s.firstChild){t.appendChild(o)}return t};avalon.innerHTML=function(e,t){if(!T&&!Gt.test(t)&&!Zt.test(t)){try{e.innerHTML=t;return}catch(n){}}var r=this.parseHTML(t);this.clearHTML(e).appendChild(r)};avalon.clearHTML=function(e){e.textContent="";while(e.firstChild){e.removeChild(e.firstChild)}return e};avalon.scan=function(e,t,n){e=e||N;var r=t?[].concat(t):[];Ln(e,r)};var sn=O("area,base,basefont,br,col,command,embed,hr,img,input,link,meta,param,source,track,wbr,noscript,script,style,textarea".toUpperCase());var an=function(e,t,n){var r=e.getAttribute(t);if(r){for(var i=0,s;s=n[i++];){if(s.hasOwnProperty(r)&&typeof s[r]==="function"){return s[r]}}}};var ln=D&&e.MutationObserver?function(e){var t=e.firstChild,n;while(t){var r=t.nextSibling;if(t.nodeType===3){if(n){n.nodeValue+=t.nodeValue;e.removeChild(t)}else{n=t}}else{n=null}t=r}}:0;var cn=/ms-(\w+)-?(.*)/;var hn={"if":10,repeat:90,data:100,widget:110,each:1400,"with":1500,duplex:2e3,on:3e3};var pn=O("animationend,blur,change,input,click,dblclick,focus,keydown,keypress,keyup,mousedown,mouseenter,mouseleave,mousemove,mouseout,mouseover,mouseup,scan,scroll,submit");var dn=O("value,title,alt,checked,selected,disabled,readonly,enabled");var gn=/^if|widget|repeat$/;var yn=/^each|with|html|include$/;if(!"1"[0]){var bn=new U(512);var wn=/\s+(ms-[^=\s]+)(?:=("[^"]*"|'[^']*'|[^\s>]+))?/g,En=/^['"]/,Sn=/<\w+\b(?:(["'])[^"]*?(\1)|[^>])*>/i,xn=/&amp;/g;var Tn=function(e){var t=e.outerHTML;if(t.slice(0,2)==="</"||!t.trim()){return[]}var n=t.match(Sn)[0];var r=[],i,s,o;var u=bn.get(n);if(u){return u}while(s=wn.exec(n)){o=s[2];if(o){o=(En.test(o)?o.slice(1,-1):o).replace(xn,"&")}var a=s[1].toLowerCase();i=a.match(cn);var f={name:a,specified:true,value:o||""};r.push(f)}return bn.put(n,r)}}var An=/\|\s*html\s*/,On=/\|\|/g,Mn=/&lt;/g,_n=/&gt;/g;rstringLiteral=/(['"])(\\\1|.)+?\1/g;var Fn={_toString:function(){var e=this.node;var t=e.className;var n=typeof t==="string"?t:t.baseVal;return n.split(/\s+/).join(" ")},_contains:function(e){return(" "+this+" ").indexOf(" "+e+" ")>-1},_add:function(e){if(!this.contains(e)){this._set(this+" "+e)}},_remove:function(e){this._set((" "+this+" ").replace(" "+e+" "," "))},__set:function(e){e=e.trim();var t=this.node;if(m.test(t)){t.setAttribute("class",e)}else{t.className=e}}};"add,remove".replace(d,function(e){avalon.fn[e+"Class"]=function(t){var n=this[0];if(t&&typeof t==="string"&&n&&n.nodeType===1){t.replace(/\S+/g,function(t){In(n)[e](t)})}return this}});avalon.fn.mix({hasClass:function(e){var t=this[0]||{};return t.nodeType===1&&In(t).contains(e)},toggleClass:function(e,t){var n,r=0;var i=e.split(/\s+/);var s=typeof t==="boolean";while(n=i[r++]){var o=s?t:!this.hasClass(n);this[o?"addClass":"removeClass"](n)}return this},attr:function(e,t){if(arguments.length===2){this[0].setAttribute(e,t);return this}else{return this[0].getAttribute(e)}},data:function(e,t){e="data-"+Bn(e||"");switch(arguments.length){case 2:this.attr(e,t);return this;case 1:var n=this.attr(e);return qn(n);case 0:var r={};E.forEach.call(this[0].attributes,function(t){if(t){e=t.name;if(!e.indexOf("data-")){e=jn(e.slice(5));r[e]=qn(t.value)}}});return r}},removeData:function(e){e="data-"+Bn(e);this[0].removeAttribute(e);return this},css:function(e,t){if(avalon.isPlainObject(e)){for(var n in e){avalon.css(this,n,e[n])}}else{var r=avalon.css(this,e,t)}return r!==void 0?r:this},position:function(){var e,t,n=this[0],r={top:0,left:0};if(!n){return}if(this.css("position")==="fixed"){t=n.getBoundingClientRect()}else{e=this.offsetParent();t=this.offset();if(e[0].tagName!=="HTML"){r=e.offset()}r.top+=avalon.css(e[0],"borderTopWidth",true);r.left+=avalon.css(e[0],"borderLeftWidth",true)}return{top:t.top-r.top-avalon.css(n,"marginTop",true),left:t.left-r.left-avalon.css(n,"marginLeft",true)}},offsetParent:function(){var e=this[0].offsetParent;while(e&&avalon.css(e,"position")==="static"){e=e.offsetParent}return avalon(e||N)},bind:function(e,t,n){if(this[0]){return avalon.bind(this[0],e,t,n)}},unbind:function(e,t,n){if(this[0]){avalon.unbind(this[0],e,t,n)}return this},val:function(e){var t=this[0];if(t&&t.nodeType===1){var n=arguments.length===0;var r=n?":get":":set";var i=ur[sr(t)+r];if(i){var s=i(t,e)}else if(n){return(t.value||"").replace(/\r/g,"")}else{t.value=e}}return n?s:this}});var Rn=/(?:\{[\s\S]*\}|\[[\s\S]*\])$/,Un=/^[\],:{}\s]*$/,zn=/(?:^|:|,)(?:\s*\[)+/g,Wn=/\\(?:["\\\/bfnrt]|u[\da-fA-F]{4})/g,Xn=/"[^"\\\r\n]*"|true|false|null|-?(?:\d+\.|)\d+(?:[eE][+-]?\d+|)/g;avalon.parseJSON=e.JSON?JSON.parse:function(e){if(typeof e==="string"){e=e.trim();if(e){if(Un.test(e.replace(Wn,"@").replace(Xn,"]").replace(zn,""))){return(new Function("return "+e))()}}avalon.error("Invalid JSON: "+e)}return e};avalon.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(e,t){avalon.fn[e]=function(n){var r=this[0]||{},i=Vn(r),s=e==="scrollTop";if(!arguments.length){return i?t in i?i[t]:N[e]:r[e]}else{if(i){i.scrollTo(!s?n:avalon(i).scrollLeft(),s?n:avalon(i).scrollTop())}else{r[e]=n}}}});var $n=avalon.cssHooks={};var Jn=["","-webkit-","-o-","-moz-","-ms-"];var Kn={"float":T?"cssFloat":"styleFloat"};avalon.cssNumber=O("columnCount,order,fillOpacity,fontWeight,lineHeight,opacity,orphans,widows,zIndex,zoom");avalon.cssName=function(e,t,n){if(Kn[e]){return Kn[e]}t=t||N.style;for(var r=0,i=Jn.length;r<i;r++){n=jn(Jn[r]+e);if(n in t){return Kn[e]=n}}return null};$n["@:set"]=function(e,t,n){try{e.style[t]=n}catch(r){}};if(e.getComputedStyle){$n["@:get"]=function(e,t){if(!e||!e.style){throw new Error("getComputedStyle要求传入一个节点 "+e)}var n,r=getComputedStyle(e,null);if(r){n=t==="filter"?r.getPropertyValue(t):r[t];if(n===""){n=e.style[t]}}return n};$n["opacity:get"]=function(e){var t=$n["@:get"](e,"opacity");return t===""?"1":t}}else{var Qn=/^-?(?:\d*\.)?\d+(?!px)[^\d\s]+$/i;var Gn=/^(top|right|bottom|left)$/;var Yn=/alpha\([^)]*\)/i;var Zn=!!e.XDomainRequest;var er="DXImageTransform.Microsoft.Alpha";var tr={thin:Zn?"1px":"2px",medium:Zn?"3px":"4px",thick:Zn?"5px":"6px"};$n["@:get"]=function(e,t){var n=e.currentStyle;var r=n[t];if(Qn.test(r)&&!Gn.test(r)){var i=e.style,s=i.left,o=e.runtimeStyle.left;e.runtimeStyle.left=n.left;i.left=t==="fontSize"?"1em":r||0;r=i.pixelLeft+"px";i.left=s;e.runtimeStyle.left=o}if(r==="medium"){t=t.replace("Width","Style");if(n[t]==="none"){r="0px"}}return r===""?"auto":tr[r]||r};$n["opacity:set"]=function(e,t,n){var r=e.style;var i=isFinite(n)&&n<=1?"alpha(opacity="+n*100+")":"";var s=r.filter||"";r.zoom=1;r.filter=(Yn.test(s)?s.replace(Yn,i):s+" "+i).trim();if(!r.filter){r.removeAttribute("filter")}};$n["opacity:get"]=function(e){var t=e.filters.alpha||e.filters[er],n=t&&t.enabled?t.opacity:100;return n/100+""}}"top,left".replace(d,function(e){$n[e+":get"]=function(t){var n=$n["@:get"](t,e);return/px$/.test(n)?n:avalon(t).position()[e]+"px"}});var nr={position:"absolute",visibility:"hidden",display:"block"};var rr=/^(none|table(?!-c[ea]).+)/;"Width,Height".replace(d,function(e){var t=e.toLowerCase(),n="client"+e,r="scroll"+e,i="offset"+e;$n[t+":get"]=function(t,n,r){var s=-4;if(typeof r==="number"){s=r}n=e==="Width"?["Left","Right"]:["Top","Bottom"];var o=t[i];if(s===2){return o+avalon.css(t,"margin"+n[0],true)+avalon.css(t,"margin"+n[1],true)}if(s<0){o=o-avalon.css(t,"border"+n[0]+"Width",true)-avalon.css(t,"border"+n[1]+"Width",true)}if(s===-4){o=o-avalon.css(t,"padding"+n[0],true)-avalon.css(t,"padding"+n[1],true)}return o};$n[t+"&get"]=function(e){var n=[];ir(e,n);var r=$n[t+":get"](e);for(var i=0,s;s=n[i++];){e=s.node;for(var o in s){if(typeof s[o]==="string"){e.style[o]=s[o]}}}return r};avalon.fn[t]=function(s){var o=this[0];if(arguments.length===0){if(o.setTimeout){return o["inner"+e]||o.document.documentElement[n]}if(o.nodeType===9){var u=o.documentElement;return Math.max(o.body[r],u[r],o.body[i],u[i],u[n])}return $n[t+"&get"](o)}else{return this.css(t,s)}};avalon.fn["inner"+e]=function(){return $n[t+":get"](this[0],void 0,-2)};avalon.fn["outer"+e]=function(e){return $n[t+":get"](this[0],void 0,e===true?2:0)}});avalon.fn.offset=function(){var e=this[0],t={left:0,top:0};if(!e||!e.tagName||!e.ownerDocument){return t}var n=e.ownerDocument,r=n.body,i=n.documentElement,s=n.defaultView||n.parentWindow;if(!avalon.contains(i,e)){return t}if(e.getBoundingClientRect){t=e.getBoundingClientRect()}var o=i.clientTop||r.clientTop,u=i.clientLeft||r.clientLeft,a=Math.max(s.pageYOffset||0,i.scrollTop,r.scrollTop),f=Math.max(s.pageXOffset||0,i.scrollLeft,r.scrollLeft);return{top:t.top+a-o,left:t.left+f-u}};var or=/^<option(?:\s+\w+(?:\s*=\s*(?:"[^"]*"|'[^']*'|[^\s>]+))?)*\s+value[\s=]/i;var ur={"option:get":D?function(e){return or.test(e.outerHTML)?e.value:e.text.trim()}:function(e){return e.value},"select:get":function(e,t){var n,r=e.options,i=e.selectedIndex,s=ur["option:get"],o=e.type==="select-one"||i<0,u=o?null:[],a=o?i+1:r.length,f=i<0?a:o?i:0;for(;f<a;f++){n=r[f];if((n.selected||f===i)&&!n.disabled){t=s(n);if(o){return t}u.push(t)}}return u},"select:set":function(e,t,n){t=[].concat(t);var r=ur["option:get"];for(var i=0,s;s=e.options[i++];){if(s.selected=t.indexOf(r(s))>-1){n=true}}if(!n){e.selectedIndex=-1}}};var ar={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};var fr=e.JSON&&JSON.stringify||function(e){return'"'+e.replace(/[\\\"\x00-\x1f]/g,function(e){var t=ar[e];return typeof t==="string"?t:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})+'"'};var lr=["break,case,catch,continue,debugger,default,delete,do,else,false","finally,for,function,if,in,instanceof,new,null,return,switch,this","throw,true,try,typeof,var,void,while,with","abstract,boolean,byte,char,class,const,double,enum,export,extends","final,float,goto,implements,import,int,interface,long,native","package,private,protected,public,short,static,super,synchronized","throws,transient,volatile","arguments,let,yield,undefined"].join(",");var cr=/\/\*[\w\W]*?\*\/|\/\/[^\n]*\n|\/\/[^\n]*$|"(?:[^"\\]|\\[\w\W])*"|'(?:[^'\\]|\\[\w\W])*'|[\s\t\n]*\.[\s\t\n]*[$\w\.]+/g;var hr=/[^\w$]+/g;var pr=new RegExp(["\\b"+lr.replace(/,/g,"\\b|\\b")+"\\b"].join("|"),"g");var dr=/\b\d[^,]*/g;var vr=/^,+|,+$/g;var mr=new U(512);var gr=function(e){var t=","+e.trim();var n=mr.get(t);if(n){return n}var r=e.replace(cr,"").replace(hr,",").replace(pr,"").replace(dr,"").replace(vr,"").split(/^$|,+/);return mr.put(t,br(r))};var wr=new U(128);var Er=/\w\[.*\]|\w\.\w/;var Sr=/(\$proxy\$[a-z]+)\d+$/;var xr=/\)\s*$/;var Tr=/\)\s*\|/g;var Nr=/\|\s*([$\w]+)/g;var Cr=/"\s*\["/g;var kr=/"\s*\(/g;avalon.parseExprProxy=Or;var Mr=["autofocus,autoplay,async,allowTransparency,checked,controls","declare,disabled,defer,defaultChecked,defaultSelected","contentEditable,isMap,loop,multiple,noHref,noResize,noShade","open,readOnly,selected"].join(",");var _r={};Mr.replace(d,function(e){_r[e.toLowerCase()]=e});var Dr={"accept-charset":"acceptCharset","char":"ch",charoff:"chOff","class":"className","for":"htmlFor","http-equiv":"httpEquiv"};var Pr=["accessKey,bgColor,cellPadding,cellSpacing,codeBase,codeType,colSpan","dateTime,defaultValue,frameBorder,longDesc,maxLength,marginWidth,marginHeight","rowSpan,tabIndex,useMap,vSpace,valueType,vAlign"].join(",");Pr.replace(d,function(e){Dr[e.toLowerCase()]=e});var Hr=/<noscript.*?>(?:[\s\S]+?)<\/noscript>/img;var Br=/<noscript.*?>([\s\S]+?)<\/noscript>/im;var jr=function(){return new(e.XMLHttpRequest||ActiveXObject)("Microsoft.XMLHTTP")};var Fr=avalon.templateCache={};I.attr=function(e,t){var n=e.value.trim(),i=true;if(n.indexOf(ot)>-1&&n.indexOf(ut)>2){i=false;if(at.test(n)&&RegExp.rightContext===""&&RegExp.leftContext===""){i=true;n=RegExp.$1}}if(e.type==="include"){var s=e.element;e.includeRendered=an(s,"data-include-rendered",t);e.includeLoaded=an(s,"data-include-loaded",t);var o=e.includeReplace=!!avalon(s).data("includeReplace");if(avalon(s).data("includeCache")){e.templateCache={}}e.startInclude=r.createComment("ms-include");e.endInclude=r.createComment("ms-include-end");if(o){e.element=e.startInclude;s.parentNode.insertBefore(e.startInclude,s);s.parentNode.insertBefore(e.endInclude,s.nextSibling)}else{s.insertBefore(e.startInclude,s.firstChild);s.appendChild(e.endInclude)}}e.handlerName="attr";Or(n,t,e,i?0:Pn(e.value))};q.attr=function(t,n,i){var o=i.type,u=i.param;if(o==="css"){avalon(n).css(u,t)}else if(o==="attr"){var a=t===false||t===null||t===void 0;if(!T&&Dr[u]){u=Dr[u]}if(a){return n.removeAttribute(u)}if(_r[u]){var f=_r[u];if(typeof n[f]==="boolean"){return n[f]=!!t}}var l=m.test(n)?false:r.namespaces&&nn(n)?true:u in n.cloneNode(false);if(l){n[u]=t}else{n.setAttribute(u,t)}}else if(o==="include"&&t){var c=i.vmodels;var h=i.includeRendered;var p=i.includeLoaded;var d=i.includeReplace;var v=d?n.parentNode:n;var g=function(e){if(p){var n=p.apply(v,[e].concat(c));if(typeof n==="string")e=n}if(h){on(v,function(){h.call(v)},NaN)}var o=i.includeLastID;if(i.templateCache&&o&&o!==t){var u=i.templateCache[o];if(!u){u=i.templateCache[o]=r.createElement("div");s.appendChild(u)}}i.includeLastID=t;while(true){var a=i.startInclude.nextSibling;if(a&&a!==i.endInclude){v.removeChild(a);if(u)u.appendChild(a)}else{break}}var f=Ir(i,t,e);var l=avalon.slice(f.childNodes);v.insertBefore(f,i.endInclude);Cn(l,c)};if(i.param==="src"){if(Fr[t]){avalon.nextTick(function(){g(Fr[t])})}else{var y=jr();y.onreadystatechange=function(){if(y.readyState===4){var e=y.status;if(e>=200&&e<300||e===304||e===1223){g(Fr[t]=y.responseText)}}};y.open("GET",t,true);if("withCredentials"in y){y.withCredentials=true}y.setRequestHeader("X-Requested-With","XMLHttpRequest");y.send(null)}}else{var b=t&&t.nodeType===1?t:r.getElementById(t);if(b){if(b.tagName==="NOSCRIPT"&&!(b.innerHTML||b.fixIE78)){y=jr();y.open("GET",location,false);y.send(null);var w=r.getElementsByTagName("noscript");var E=(y.responseText||"").match(Hr)||[];var S=E.length;for(var x=0;x<S;x++){var C=w[x];if(C){C.style.display="none";C.fixIE78=(E[x].match(Br)||["","&nbsp;"])[1]}}}avalon.nextTick(function(){g(b.fixIE78||b.value||b.innerText||b.innerHTML)})}}}else{if(!N.hasAttribute&&typeof t==="string"&&(o==="src"||o==="href")){t=t.replace(/&amp;/g,"&")}n[o]=t;if(e.chrome&&n.tagName==="EMBED"){var k=n.parentNode;var L=document.createComment("ms-src");k.replaceChild(L,n);k.replaceChild(n,L)}}};"title,alt,src,value,css,include,href".replace(d,function(e){I[e]=I.attr});I["class"]=function(e,t){var n=e.param,r=e.value,i;e.handlerName="class";if(!n||isFinite(n)){e.param="";var s=r.replace(ft,function(e){return e.replace(/./g,"0")});var o=s.indexOf(":");if(o===-1){var a=r}else{a=r.slice(0,o);i=r.slice(o+1);Ar(i,t,e);if(!e.evaluator){u("debug: ms-class '"+(i||"").trim()+"' 不存在于VM中");return false}else{e._evaluator=e.evaluator;e._args=e.args}}var f=at.test(a);if(!f){e.immobileClass=a}Or("",t,e,f?Pn(a):0)}else{e.immobileClass=e.oldStyle=e.param;Or(r,t,e)}};q["class"]=function(e,t,n){var r=avalon(t),i=n.type;if(i==="class"&&n.oldStyle){r.toggleClass(n.oldStyle,!!e)}else{n.toggleClass=n._evaluator?!!n._evaluator.apply(t,n._args):true;n.newClass=n.immobileClass||e;if(n.oldClass&&n.newClass!==n.oldClass){r.removeClass(n.oldClass)}n.oldClass=n.newClass;switch(i){case"class":r.toggleClass(n.newClass,n.toggleClass);break;case"hover":case"active":if(!n.hasBindEvent){var s="mouseenter";var o="mouseleave";if(i==="active"){t.tabIndex=t.tabIndex||-1;s="mousedown";o="mouseup";var u=r.bind("mouseleave",function(){n.toggleClass&&r.removeClass(n.newClass)})}var a=r.bind(s,function(){n.toggleClass&&r.addClass(n.newClass)});var f=r.bind(o,function(){n.toggleClass&&r.removeClass(n.newClass)});n.rollback=function(){r.unbind("mouseleave",u);r.unbind(s,a);r.unbind(o,f)};n.hasBindEvent=true}break}}};"hover,active".replace(d,function(e){I[e]=I["class"]});q.data=function(e,t,n){var r="data-"+n.param;if(e&&typeof e==="object"){t[r]=e}else{t.setAttribute(r,String(e))}};var qr=I.duplex=function(e,t){var n=e.element,r;Or(e.value,t,e,0,1);e.changed=an(n,"data-duplex-changed",t)||A;if(e.evaluator&&e.args){var i=[];var s=O("string,number,boolean,checked");if(n.type==="radio"&&e.param===""){e.param="checked"}if(n.msData){n.msData["ms-duplex"]=e.value}e.param.replace(/\w+/g,function(t){if(/^(checkbox|radio)$/.test(n.type)&&/^(radio|checked)$/.test(t)){if(t==="radio")u("ms-duplex-radio已经更名为ms-duplex-checked");t="checked";e.isChecked=true}if(t==="bool"){t="boolean";u("ms-duplex-bool已经更名为ms-duplex-boolean")}else if(t==="text"){t="string";u("ms-duplex-text已经更名为ms-duplex-string")}if(s[t]){r=true}avalon.Array.ensure(i,t)});if(!r){i.push("string")}e.param=i.join("-");e.bound=function(t,r){if(n.addEventListener){n.addEventListener(t,r,false)}else{n.attachEvent("on"+t,r)}var i=e.rollback;e.rollback=function(){n.avalonSetter=null;avalon.unbind(n,t,r);i&&i()}};for(var o in avalon.vmodels){var a=avalon.vmodels[o];a.$fire("avalon-ms-duplex-init",e)}var f=e.pipe||(e.pipe=Ur);f(null,e,"init");var l=n.tagName;qr[l]&&qr[l](n,e.evaluator.apply(null,e.args),e)}};avalon.duplexHooks={checked:{get:function(e,t){return!t.element.oldValue}},string:{get:function(e){return e},set:Rr},"boolean":{get:function(e){return e==="true"},set:Rr},number:{get:function(e,t){var n=parseFloat(e);if(-e===-n){return n}var r=/strong|medium|weak/.exec(t.element.getAttribute("data-duplex-number"))||["medium"];switch(r[0]){case"strong":return 0;case"medium":return e===""?"":0;case"weak":return e}},set:Rr}};var zr,Wr=[];avalon.tick=function(e){if(Wr.push(e)===1){zr=setInterval(Xr,60)}};var Vr=A;var $r=/text|password|hidden/;new function(){try{var e={};var t=HTMLInputElement.prototype;var n=HTMLTextAreaElement.prototype;function r(t){if(avalon.contains(N,this)){e[this.tagName].call(this,t);if(!$r.test(this.type))return;if(!this.msFocus&&this.avalonSetter){this.avalonSetter()}}}var i=HTMLInputElement.prototype;Object.getOwnPropertyNames(i);e["INPUT"]=Object.getOwnPropertyDescriptor(t,"value").set;Object.defineProperty(t,"value",{set:r});e["TEXTAREA"]=Object.getOwnPropertyDescriptor(n,"value").set;Object.defineProperty(n,"value",{set:r})}catch(s){Vr=avalon.tick}};if(D){avalon.bind(r,"selectionchange",function(e){var t=r.activeElement;if(t&&typeof t.avalonSetter==="function"){t.avalonSetter()}})}qr.INPUT=function(e,t,n){function a(e){n.changed.call(this,e,n)}function f(){o=true}function l(){o=false;setTimeout(c)}var r=e.type,i=n.bound,s=avalon(e),o=false;var c=function(){if(o)return;var r=e.oldValue=e.value;var i=n.pipe(r,n,"get");if(s.data("duplexObserve")!==false){t(i);a.call(e,i);if(s.data("duplex-focus")){avalon.nextTick(function(){e.focus()})}}};n.handler=function(){var r=n.pipe(t(),n,"set")+"";if(r!==e.oldValue){e.value=r}};if(n.isChecked||r==="radio"){var h=D===6;c=function(){if(s.data("duplexObserve")!==false){var r=n.pipe(e.value,n,"get");t(r);a.call(e,r)}};n.handler=function(){var r=t();var i=n.isChecked?!!r:r+""===e.value;e.oldValue=i;if(h){setTimeout(function(){e.defaultChecked=i;e.checked=i},31)}else{e.checked=i}};i("click",c)}else if(r==="checkbox"){c=function(){if(s.data("duplexObserve")!==false){var r=e.checked?"ensure":"remove";var i=t();if(!Array.isArray(i)){u("ms-duplex应用于checkbox上要对应一个数组");i=[i]}avalon.Array[r](i,n.pipe(e.value,n,"get"));a.call(e,i)}};n.handler=function(){var r=[].concat(t());e.checked=r.indexOf(n.pipe(e.value,n,"get"))>-1};i(T?"change":"click",c)}else{var p=e.getAttribute("data-duplex-event")||"input";if(e.attributes["data-event"]){u("data-event指令已经废弃，请改用data-duplex-event")}function v(e){setTimeout(function(){c(e)})}p.replace(d,function(e){switch(e){case"input":if(!D){i("input",c);i("compositionstart",f);i("compositionend",l);i("DOMAutoComplete",c)}else{if(D>8){i("input",c)}else{i("propertychange",function(e){if(e.propertyName==="value"){c()}})}i("dragend",v)}break;default:i(e,c);break}});i("focus",function(){e.msFocus=true});i("blur",function(){e.msFocus=false});if($r.test(r)){Vr(function(){if(N.contains(e)){if(!e.msFocus&&e.oldValue!==e.value){c()}}else if(!e.msRetain){return false}})}e.avalonSetter=c}e.oldValue=e.value;Ft(n);a.call(e,e.value)};qr.TEXTAREA=qr.INPUT;qr.SELECT=function(e,t,n){function i(){if(r.data("duplexObserve")!==false){var i=r.val();if(Array.isArray(i)){i=i.map(function(e){return n.pipe(e,n,"get")})}else{i=n.pipe(i,n,"get")}if(i+""!==e.oldValue){t(i)}n.changed.call(e,i,n)}}var r=avalon(e);n.handler=function(){var n=t();n=n&&n.$model||n;if(Array.isArray(n)){if(!e.multiple){u("ms-duplex在<select multiple=true>上要求对应一个数组")}}else{if(e.multiple){u("ms-duplex在<select multiple=false>不能对应一个数组")}}n=Array.isArray(n)?n.map(String):n+"";if(n+""!==e.oldValue){r.val(n);e.oldValue=n+""}};n.bound("change",i);on(e,function(){Ft(n);n.changed.call(e,t(),n)},NaN)};q.html=function(e,t,n){e=e==null?"":e;var i="group"in n;var s=i?t.parentNode:t;if(!s)return;if(e.nodeType===11){var o=e}else if(e.nodeType===1||e.item){var u=e.nodeType===1?e.childNodes:e.item?e:[];o=C.cloneNode(true);while(u[0]){o.appendChild(u[0])}}else{o=avalon.parseHTML(e)}var a=r.createComment("ms-html");if(i){s.insertBefore(a,t);var f=n.group,l=1;while(l<f){var c=t.nextSibling;if(c){s.removeChild(c);l++}}s.removeChild(t);n.element=a}else{avalon.clearHTML(s).appendChild(a)}if(i){n.group=o.childNodes.length||1}u=avalon.slice(o.childNodes);if(u[0]){if(a.parentNode)a.parentNode.replaceChild(o,a);if(i){n.element=u[0]}}Cn(u,n.vmodels)};I["if"]=I.data=I.text=I.html=function(e,t){Or(e.value,t,e)};q["if"]=function(e,t,n){if(e){if(t.nodeType===8){t.parentNode.replaceChild(n.template,t);t=n.element=n.template}if(t.getAttribute(n.name)){t.removeAttribute(n.name);mn(t,n.vmodels)}n.rollback=null}else{if(t.nodeType===1){var i=n.element=r.createComment("ms-if");t.parentNode.replaceChild(i,t);n.template=t;s.appendChild(t);n.rollback=function(){if(t.parentNode===s){s.removeChild(t)}}}}};var Jr=/\(([^)]*)\)/;I.on=function(e,t){var n=e.value;e.type="on";var r=e.param.replace(/-\d+$/,"");if(typeof I.on[r+"Hook"]==="function"){I.on[r+"Hook"](e)}if(n.indexOf("(")>0&&n.indexOf(")")>-1){var i=(n.match(Jr)||["",""])[1].trim();if(i===""||i==="$event"){n=n.replace(Jr,"")}}Or(n,t,e)};q.on=function(e,t,n){e=function(e){var t=n.evaluator||A;return t.apply(this,n.args.concat(e))};var r=n.param.replace(/-\d+$/,"");if(r==="scan"){e.call(t,{type:r})}else if(typeof n.specialBind==="function"){n.specialBind(t,e)}else{var i=avalon.bind(t,r,e)}n.rollback=function(){if(typeof n.specialUnbind==="function"){n.specialUnbind()}else{avalon.unbind(t,r,i)}}};I.repeat=function(e,t){var n=e.type;Or(e.value,t,e,0,1);e.proxies=[];var i=false;try{var s=e.$repeat=e.evaluator.apply(0,e.args||[]);var o=avalon.type(s);if(o!=="object"&&o!=="array"){i=true;avalon.log("warning:"+e.value+"只能是对象或数组")}}catch(u){i=true}var a=e.value.split(".")||[];if(a.length>1){a.pop();var l=a[0];for(var c=0,h;h=t[c++];){if(h&&h.hasOwnProperty(l)){var p=h[l].$events||{};p[f]=p[f]||[];p[f].push(e);break}}}var d=e.element;d.removeAttribute(e.name);e.sortedCallback=an(d,"data-with-sorted",t);e.renderedCallback=an(d,"data-"+n+"-rendered",t);var v=M(n);var m=e.element=r.createComment(v+":end");e.clone=r.createComment(v);C.appendChild(m);if(n==="each"||n==="with"){e.template=d.innerHTML.trim();avalon.clearHTML(d).appendChild(m)}else{e.template=d.outerHTML.trim();d.parentNode.replaceChild(m,d)}e.template=avalon.parseHTML(e.template);e.rollback=function(){var t=e.element;if(!t)return;q.repeat.call(e,"clear");var n=t.parentNode;var r=e.template;var i=r.firstChild;n.replaceChild(r,t);var s=e.$stamp;s&&s.parentNode&&s.parentNode.removeChild(s);i=e.element=e.type==="repeat"?i:n};if(i){return}e.handler=q.repeat;e.$outer={};var g="$key";var y="$val";if(Array.isArray(s)){g="$first";y="$last"}for(c=0;h=t[c++];){if(h.hasOwnProperty(g)&&h.hasOwnProperty(y)){e.$outer=h;break}}var b=s.$events;var w=(b||{})[f];if(w&&avalon.Array.ensure(w,e)){qt(e,w)}if(o==="object"){e.$with=true;var E=!b?{}:b.$withProxyPool||(b.$withProxyPool={});e.handler("append",s,E)}else if(s.length){e.handler("add",0,s.length)}};q.repeat=function(e,t,n){if(e){var r=this;var i=r.element;var s=i.parentNode;var o=r.proxies;var u=C.cloneNode(false);switch(e){case"add":var a=t+n;var f=r.$repeat;var l=f.length-1;var c=[],h;var p=Qr(r,t);for(var d=t;d<a;d++){var v=ti(d,r);o.splice(d,0,v);Kr(r,u,v,c)}s.insertBefore(u,p);for(d=0;h=c[d++];){Cn(h.nodes,h.vmodels);h.nodes=h.vmodels=null}break;case"del":p=o[t].$stamp;i=Qr(r,t+n);Gr(p,i);var m=o.splice(t,n);ii(m,"each");break;case"clear":var g=r.$stamp||o[0];if(g){p=g.$stamp||g;Gr(p,i)}ii(o,"each");break;case"move":p=o[0].$stamp;var y=p.nodeValue;var b=[];var w=[],E;Gr(p,i,function(){w.unshift(this);if(this.nodeValue===y){b.unshift(w);w=[]}});Bt(o,t);Bt(b,t);while(w=b.shift()){while(E=w.shift()){u.appendChild(E)}}s.insertBefore(u,i);break;case"index":l=o.length-1;for(;n=o[t];t++){n.$index=t;n.$first=t===0;n.$last=t===l}return;case"set":v=o[t];if(v){$t(v.$events.$index)}return;case"append":var S=n;var x=[];c=[];for(var T in t){if(t.hasOwnProperty(T)&&T!=="hasOwnProperty"){x.push(T)}}if(r.sortedCallback){var N=r.sortedCallback.call(s,x);if(N&&Array.isArray(N)&&N.length){x=N}}for(d=0;T=x[d++];){if(T!=="hasOwnProperty"){if(!S[T]){S[T]=ri(T,r)}Kr(r,u,S[T],c)}}var k=r.$stamp=r.clone;s.insertBefore(k,i);s.insertBefore(u,i);for(d=0;h=c[d++];){Cn(h.nodes,h.vmodels);h.nodes=h.vmodels=null}break}if(e==="clear")e="del";var L=r.renderedCallback||A,O=arguments;on(s,function(){L.apply(s,O);if(s.oldValue&&s.tagName==="SELECT"){avalon(s).val(s.oldValue.split(","))}},NaN)}};"with,each".replace(d,function(e){I[e]=I.repeat});var Yr=[];var Zr=[];q.text=function(e,t){e=e==null?"":e;if(t.nodeType===3){try{t.data=e}catch(n){}}else{if("textContent"in t){t.textContent=e}else{t.innerText=e}}};avalon.parseDisplay=si;I.visible=function(e,t){var n=avalon(e.element);var r=n.css("display");if(r==="none"){var i=n[0].style;var s=/visibility/i.test(i.cssText);var o=n.css("visibility");i.display="";i.visibility="hidden";r=n.css("display");if(r==="none"){r=si(n[0].nodeName)}i.visibility=s?o:""}e.display=r;Or(e.value,t,e)};q.visible=function(e,t,n){t.style.display=e?n.display:"none"};I.widget=function(t,n){var r=t.value.match(d);var i=t.element;var s=r[0];var o=r[1];if(!o||o==="$"){o=M(s)}var u=r[2]||s;var a=avalon.ui[s];if(typeof a==="function"){n=i.vmodels||n;for(var f=0,l;l=n[f++];){if(l.hasOwnProperty(u)&&typeof l[u]==="object"){var c=l[u];c=c.$model||c;break}}if(c){var h=c[s+"Id"];if(typeof h==="string"){o=h}}var p=avalon.getWidgetData(i,s);t.value=[s,o,u].join(",");t[s+"Id"]=o;t.evaluator=A;i.msData["ms-widget-id"]=o;var v=t[s+"Options"]=avalon.mix({},a.defaults,c||{},p);i.removeAttribute("ms-widget");var m=a(i,t,n)||{};if(m.$id){avalon.vmodels[o]=m;un(i,m);if(m.hasOwnProperty("$init")){m.$init(function(){avalon.scan(i,[m].concat(n));if(typeof v.onInit==="function"){v.onInit.call(i,m,v,n)}})}t.rollback=function(){try{m.widgetElement=null;m.$remove()}catch(e){}i.msData={};delete avalon.vmodels[m.$id]};qt(t,oi);if(e.chrome){i.addEventListener("DOMNodeRemovedFromDocument",function(){setTimeout(Vt)})}}else{avalon.scan(i,n)}}else if(n.length){i.vmodels=n}};var oi=[];var ui=/<script[^>]*>([\S\s]*?)<\/script\s*>/gim;var ai=/\s+(on[^=\s]+)(?:=("[^"]*"|'[^']*'|[^\s>]+))?/g;var fi=/<\w+\b(?:(["'])[^"]*?(\1)|[^>])*>/ig;var li={a:/\b(href)\=("javascript[^"]*"|'javascript[^']*')/ig,img:/\b(src)\=("javascript[^"]*"|'javascript[^']*')/ig,form:/\b(action)\=("javascript[^"]*"|'javascript[^']*')/ig};var ci=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g;var hi=/([^\#-~| |!])/g;var di=avalon.filters={uppercase:function(e){return e.toUpperCase()},lowercase:function(e){return e.toLowerCase()},truncate:function(e,t,n){t=t||30;n=n===void 0?"...":n;return e.length>t?e.slice(0,t-n.length)+n:String(e)},$filter:function(e){for(var t=1,n=arguments.length;t<n;t++){var r=arguments[t];var i=avalon.filters[r.shift()];if(typeof i==="function"){var s=[e].concat(r);e=i.apply(null,s)}}return e},camelize:jn,sanitize:function(e){return e.replace(ui,"").replace(fi,function(e,t){var n=e.toLowerCase().match(/<(\w+)\s/);if(n){var r=li[n[1]];if(r){e=e.replace(r,function(e,t,n){var r=n.charAt(0);return t+"="+r+"javascript:void(0)"+r})}}return e.replace(ai," ").replace(/\s+/g," ")})},escape:function(e){return String(e).replace(/&/g,"&amp;").replace(ci,function(e){var t=e.charCodeAt(0);var n=e.charCodeAt(1);return"&#"+((t-55296)*1024+(n-56320)+65536)+";"}).replace(hi,function(e){return"&#"+e.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")},currency:function(e,t,n){return(t||"￥")+pi(e,isFinite(n)?n:2)},number:pi};new function(){function e(e){return parseInt(e,10)||0}function t(e,t,n){var r="";if(e<0){r="-";e=-e}e=""+e;while(e.length<t)e="0"+e;if(n)e=e.substr(e.length-t);return r+e}function n(e,n,r,i){return function(s){var o=s["get"+e]();if(r>0||o>-r)o+=r;if(o===0&&r===-12){o=12}return t(o,n,i)}}function r(e,t){return function(n,r){var i=n["get"+e]();var s=(t?"SHORT"+e:e).toUpperCase();return r[s][i]}}function i(e){var n=-1*e.getTimezoneOffset();var r=n>=0?"+":"";r+=t(Math[n>0?"floor":"ceil"](n/60),2)+t(Math.abs(n%60),2);return r}function s(e,t){return e.getHours()<12?t.AMPMS[0]:t.AMPMS[1]}var o={yyyy:n("FullYear",4),yy:n("FullYear",2,0,true),y:n("FullYear",1),MMMM:r("Month"),MMM:r("Month",true),MM:n("Month",2,1),M:n("Month",1,1),dd:n("Date",2),d:n("Date",1),HH:n("Hours",2),H:n("Hours",1),hh:n("Hours",2,-12),h:n("Hours",1,-12),mm:n("Minutes",2),m:n("Minutes",1),ss:n("Seconds",2),s:n("Seconds",1),sss:n("Milliseconds",3),EEEE:r("Day"),EEE:r("Day",true),a:s,Z:i};var u=/((?:[^yMdHhmsaZE']+)|(?:'(?:[^']|'')*')|(?:E+|y+|M+|d+|H+|h+|m+|s+|a|Z))(.*)/;var a=/^\/Date\((\d+)\)\/$/;di.date=function(t,n){var r=di.date.locate,i="",s=[],f,l;n=n||"mediumDate";n=r[n]||n;if(typeof t==="string"){if(/^\d+$/.test(t)){t=e(t)}else if(a.test(t)){t=+RegExp.$1}else{var c=t.trim();var h=[0,0,0,0,0,0,0];var p=new Date(0);c=c.replace(/^(\d+)\D(\d+)\D(\d+)/,function(t,n,r,i){var s=i.length===4?[i,n,r]:[n,r,i];h[0]=e(s[0]);h[1]=e(s[1])-1;h[2]=e(s[2]);return""});var d=p.setFullYear;var v=p.setHours;c=c.replace(/[T\s](\d+):(\d+):?(\d+)?\.?(\d)?/,function(t,n,r,i,s){h[3]=e(n);h[4]=e(r);h[5]=e(i);if(s){h[6]=Math.round(parseFloat("0."+s)*1e3)}return""});var m=0;var g=0;c=c.replace(/Z|([+-])(\d\d):?(\d\d)/,function(t,n,r,i){d=p.setUTCFullYear;v=p.setUTCHours;if(n){m=e(n+r);g=e(n+i)}return""});h[3]-=m;h[4]-=g;d.apply(p,h.slice(0,3));v.apply(p,h.slice(3));t=p}}if(typeof t==="number"){t=new Date(t)}if(avalon.type(t)!=="date"){return}while(n){l=u.exec(n);if(l){s=s.concat(l.slice(1));n=s.pop()}else{s.push(n);n=null}}s.forEach(function(e){f=o[e];i+=f?f(t,r):e.replace(/(^'|'$)/g,"").replace(/''/g,"'")});return i};var f={AMPMS:{0:"上午",1:"下午"},DAY:{0:"星期日",1:"星期一",2:"星期二",3:"星期三",4:"星期四",5:"星期五",6:"星期六"},MONTH:{0:"1月",1:"2月",2:"3月",3:"4月",4:"5月",5:"6月",6:"7月",7:"8月",8:"9月",9:"10月",10:"11月",11:"12月"},SHORTDAY:{0:"周日",1:"周一",2:"周二",3:"周三",4:"周四",5:"周五",6:"周六"},fullDate:"y年M月d日EEEE",longDate:"y年M月d日",medium:"yyyy-M-d H:mm:ss",mediumDate:"yyyy-M-d",mediumTime:"H:mm:ss","short":"yy-M-d ah:mm",shortDate:"yy-M-d",shortTime:"ah:mm"};f.SHORTMONTH=f.MONTH;di.date.locate=f};var vi=avalon.modules={"domReady!":{exports:avalon,state:3},avalon:{exports:avalon,state:4}};vi.exports=vi.avalon;new function(){function o(e,t){var n="js";e=e.replace(/^(\w+)\!/,function(e,t){n=t;return""});if(n==="ready"){u("debug: ready!已经被废弃，请使用domReady!");n="domReady"}var r="";e=e.replace(N,function(e){r=e;return""});var i="."+n;var s=/js|css/.test(i)?i:"";e=e.replace(/\.[a-z0-9]+$/g,function(e){if(e===i){s=e;return""}else{return e}});var o=avalon.mix({query:r,ext:s,res:n,name:e,toUrl:D},t);o.toUrl(e);return o}function l(e){var t=e.name;var n=e.res;var r=vi[t];var i=t&&e.urlNoQuery;if(r&&r.state>=1){return t}r=vi[i];if(r&&r.state>=3){h(r.deps||[],r.factory,i);return i}if(t&&!r){r=vi[i]={id:i,state:1};var s=function(i){T[n]=i;i.load(t,e,function(e){if(arguments.length&&e!==void 0){r.exports=e}r.state=4;E()})};if(!T[n]){h([n],s)}else{s(T[n])}}return t?i:n+"!"}function y(e,t){for(var n=0,r;r=e[n++];){if(vi[r].state!==4&&(r===t||y(vi[r].deps,t))){return true}}}function w(e,t,n){var r=C(e.src);e.onload=e.onreadystatechange=e.onerror=null;if(t||n&&vi[r]&&!vi[r].state){setTimeout(function(){i.removeChild(e);e=null});u("debug: 加载 "+r+" 失败"+t+" "+!vi[r].state)}else{return true}}function E(){e:for(var e=t.length,n;n=t[--e];){var r=vi[n],i=r.deps;if(!i)continue;for(var s=0,o;o=i[s];s++){if(Object(vi[o]).state!==4){continue e}}if(r.state!==4){t.splice(e,1);_(r.id,r.deps,r.factory);E()}}}function x(e,s,o){function p(){if(!"1"[0]&&!l){return l=setTimeout(p,150)}if(c||S.test(a.readyState)){clearTimeout(l);var r=n.pop();r&&r.require(s);if(o){o()}if(w(a,false,!c)){u("debug: 已成功加载 "+e);s&&t.push(s);E()}}}var a=r.createElement("script");a.className=f;var l;var c="onload"in a;var h=c?"onload":"onreadystatechange";a[h]=p;a.onerror=function(){w(a,true)};i.insertBefore(a,i.firstChild);a.src=e;u("debug: 正准备加载 "+e)}function C(e){return(e||"").replace(N,"")}function k(e){return/^(?:[a-z]+:)?\/\//i.test(String(e))}function L(e,t){return"1"[0]?e[t]:e.getAttribute(t,4)}function O(){var t;try{a.b.c()}catch(n){t=n.stack;if(!t&&e.opera){t=(String(n).match(/of linked script \S+/g)||[]).join(" ")}}if(t){t=t.split(/[@ ]/g).pop();t=t[0]==="("?t.slice(1,-1):t.replace(/\s/,"");return C(t.replace(/(:\d+)?:\d+$/i,""))}var r=i.getElementsByTagName("script");for(var s=r.length,o;o=r[--s];){if(o.className===f&&o.readyState==="interactive"){var u=L(o,"src");return o.className=C(u)}}}function _(t,n,r){var i=Object(vi[t]);i.state=4;for(var s=0,o=[],a;a=n[s++];){if(a==="exports"){var f=i.exports||(i.exports={});o.push(f)}else{o.push(vi[a].exports)}}try{var l=r.apply(e,o)}catch(c){u("执行["+t+"]模块的factory抛错： "+c)}if(l!==void 0){i.exports=l}if(M.test(t)){delete vi[t]}delete i.factory;return l}function D(e){if(e.indexOf(this.res+"!")===0){e=e.slice(this.res.length+1)}var t=e;var n=0;var r=this.baseUrl;var i=this.parentUrl||r;F(e,st.paths,function(e,r){t=t.replace(r,e);n=1});if(!n){F(e,st.packages,function(e,n,r){t=t.replace(r.name,r.location)})}if(this.mapUrl){F(this.mapUrl,st.map,function(e){F(t,e,function(e,n){t=t.replace(n,e);i=r})})}var s=this.ext;if(s&&n&&t.slice(-s.length)===s){t=t.slice(0,-s.length)}if(!k(t)){i=this.built||/^\w/.test(t)?r:i;t=R(i,t)}var o=t+s;t=o+this.query;F(e,st.urlArgs,function(e){t+=(t.indexOf("?")===-1?"?":"&")+e});this.url=t;return this.urlNoQuery=o}function P(e,t,n){var r=j(e,t,n);r.sort(I);return r}function H(e){return new RegExp("^"+e+"(/|$)")}function B(t){return function(){var n;if(t.init){n=t.init.apply(e,arguments)}return n||t.exports&&U(t.exports)}}function j(e,t,n){var r=[];for(var i in e){if(b.call(e,i)){var s={name:i,val:e[i]};r.push(s);s.reg=i==="*"&&t?/^/:H(i);if(n&&i!=="*"){s.reg=new RegExp("/"+i.replace(/^\//,"")+"(/|$)")}}}return r}function F(e,t,n){t=t||[];for(var r=0,i;i=t[r++];){if(i.reg.test(e)){n(i.val,i.name,i);return false}}}function I(e,t){var n=e.name;var r=t.name;if(r==="*"){return-1}if(n==="*"){return 1}return r.length-n.length}function R(e,t){if(e.charAt(e.length-1)!=="/"){e+="/"}if(t.slice(0,2)==="./"){return e+t.slice(2)}if(t.slice(0,2)===".."){e+=t;while(q.test(e)){e=e.replace(q,"")}return e}if(t.slice(0,1)==="/"){return e+t.slice(1)}return e+t}function U(t){if(!t){return t}var n=e;t.split(".").forEach(function(e){n=n[e]});return n}var t=[];var n=[];var s=/\.js$/i;var c=[];var p=false;h=avalon.require=function(e,n,r,i){if(!p){c.push(avalon.slice(arguments));if(arguments.length<=2){p=true;var u=c.splice(0,c.length),a;while(a=u.shift()){h.apply(null,a)}}return}if(!Array.isArray(e)){avalon.error("require方法的第一个参数应为数组 "+e)}var f=[];var d={};var v=r||"callback"+setTimeout("1");i=i||{};i.baseUrl=st.baseUrl;var m=!!i.built;if(r){i.parentUrl=r.substr(0,r.lastIndexOf("/"));i.mapUrl=r.replace(s,"")}if(m){var g=o(i.defineName,i);v=g.urlNoQuery}else{e.forEach(function(e){var t=o(e,i);var n=l(t);if(n){if(!d[n]){f.push(n);d[n]="司徒正美"}}})}var y=vi[v];if(!y||y.state!==4){vi[v]={id:v,deps:m?e.concat():f,factory:n||A,state:3}}if(!y){t.push(v)}E()};h.define=function(e,t,r){if(typeof e!=="string"){r=t;t=e;e="anonymous"}if(!Array.isArray(t)){r=t;t=[]}var i={built:!p,defineName:e};var s=[t,r,i];r.require=function(e){s.splice(2,0,e);if(vi[e]){vi[e].state=3;var t=false;try{t=y(vi[e].deps,e)}catch(n){}if(t){avalon.error(e+"模块与之前的模块存在循环依赖，请不要直接用script标签引入"+e+"模块")}}delete r.require;h.apply(null,s)};var o=i.built?"unknown":O();if(o){var u=vi[o];if(u){u.state=2}r.require(o)}else{n.push(r)}};h.config=st;h.define.amd=vi;var d=st["orig.paths"]={};var v=st["orig.map"]={};var m=st["packages"]=[];var g=st["orig.args"]={};avalon.mix(pt,{paths:function(e){avalon.mix(d,e);st.paths=P(d)},map:function(e){avalon.mix(v,e);var t=P(v,1,1);avalon.each(t,function(e,t){t.val=P(t.val)});st.map=t},packages:function(e){e=e.concat(m);var t={};var n=[];for(var r=0,i;i=e[r++];){i=typeof i==="string"?{name:i}:i;var o=i.name;if(!t[o]){var u=R(i.location||o,i.main||"main");u=u.replace(s,"");n.push(i);t[o]=i.location=u;i.reg=H(o)}}st.packages=n.sort()},urlArgs:function(e){if(typeof e==="string"){e={"*":e}}avalon.mix(g,e);st.urlArgs=P(g,1)},baseUrl:function(e){if(!k(e)){var t=i.getElementsByTagName("base")[0];if(t){i.removeChild(t)}var n=r.createElement("a");n.href=e;e=L(n,"href");if(t){i.insertBefore(t,i.firstChild)}}if(e.length>3)st.baseUrl=e},shim:function(e){for(var t in e){var n=e[t];if(Array.isArray(n)){n=e[t]={deps:n}}if(!n.exportsFn&&(n.exports||n.init)){n.exportsFn=B(n)}}st.shim=e}});var S=r.documentMode>=8?/loaded/:/complete|loaded/;var T=h.plugins={ready:{load:A},js:{load:function(e,t,n){var r=t.url;var i=t.urlNoQuery;var o=st.shim[e.replace(s,"")];if(o){h(o.deps||[],function(){var e=avalon.slice(arguments);x(r,i,function(){n(o.exportsFn?o.exportsFn.apply(0,e):void 0)})})}else{x(r,i)}}},css:{load:function(e,t,n){var s=t.url;var o=r.createElement("link");o.rel="stylesheet";o.href=s;i.insertBefore(o,i.firstChild);u("debug: 已成功加载 "+s);n()}},text:{load:function(e,t,n){var r=t.url;var i=jr();i.onreadystatechange=function(){if(i.readyState===4){var e=i.status;if(e>399&&e<600){avalon.error(r+" 对应资源不存在或没有开启 CORS")}else{u("debug: 已成功加载 "+r);n(i.responseText)}}};i.open("GET",r,true);if("withCredentials"in i){i.withCredentials=true}i.setRequestHeader("X-Requested-With","XMLHttpRequest");i.send();u("debug: 正准备加载 "+r)}}};h.checkDeps=E;var N=/(\?[^#]*)$/;var M=/^callback\d+$/;var q=/\/\w+\/\.\./;var z=r.scripts[r.scripts.length-1];var W=z.getAttribute("data-main");if(W){pt.baseUrl(W);var X=st.baseUrl;st.baseUrl=X.slice(0,X.lastIndexOf("/")+1);x(X.replace(s,"")+".js")}else{var V=C(L(z,"src"));st.baseUrl=V.slice(0,V.lastIndexOf("/")+1)}};var mi=[],gi;var yi=function(e){gi=true;if(h){vi["domReady!"].state=4;h.checkDeps()}while(e=mi.shift()){e(avalon)}};if(r.readyState==="complete"){setTimeout(yi)}else if(T){r.addEventListener("DOMContentLoaded",yi)}else{r.attachEvent("onreadystatechange",function(){if(r.readyState==="complete"){yi()}});try{var wi=e.frameElement===null}catch(Nt){}if(N.doScroll&&wi&&e.external){bi()}}avalon.bind(e,"load",yi);avalon.ready=function(e){if(!gi){mi.push(e)}else{e(avalon)}};avalon.config({loader:true});avalon.ready(function(){avalon.scan(r.body)});if(typeof define==="function"&&define.amd){define("avalon",[],function(){return avalon})}var Ei=e.avalon;avalon.noConflict=function(t){if(t&&e.avalon===avalon){e.avalon=Ei}return avalon};if(t===void 0){e.avalon=avalon}return avalon})}(t.exports,t,e);e.____MODULES["65febc6852c794b8bb6827ffacacbdf8"]=t.exports})(this);(function(e){var t={id:"f9bdfeae993c58aeb4557e4b3b897a7a",filename:"avalon.live.js",exports:{}};if(!e.____MODULES){e.____MODULES={}}var n=function(e,t,n){function o(e){var t=e.type;if(t==="select-multiple"){if(e.selectedIndex>-1){var n=[];for(var r=0,i;i=e.options[r++];){n.push(i.selected)}return n.join("-")}else{return""}}else if(e.nodeName.toLowerCase()==="select"){return e.selectedIndex}return e.value}function u(e){var t=f["fixChangechange"];var n=e.target;for(var r=t.length,s;s=t[--r];){var u=s.elem;if(i.contains(u)){if(u===n){var l=o(u);if(s.__change__!==l){e.type="change";s.fn.call(u,e);s.__change__=l}}}else{a(t,s,r)}}}function a(e,t,n){var r=t.elem.parentNode;if(!r||r.nodeType==11){e.splice(n,1)}}var r=document;var i=r.documentElement;var s={change:"click",focus:"focusin",blur:"focusout"};var f=avalon.bindingHandlers.live=function(e,t){var n=e.param;var l=e.element;var c="noFix";e.type="on";if(!r.createEvent){if(/focus|blur/.test(n)){c="fixFocus"}else if(n=="change"){var h=l.type;if(h=="radio"||h==="checkbox"){c="fixFocus";if(!("_just_changed"in l)){l._just_changed=false;l.attachEvent("onpropertychange",function(e){if(e.propertyName=="checked"){l._just_changed=true}})}}else{c="fixChange"}}else if(/submit|reset|select/.test(n)){c=false}}if(c){if(!f[c+n]){f[c+n]=[];if(c==="noFix"){avalon.bind(r,n,function(e){var t=f[c+n];var r=e.target;for(var s=t.length,o;o=t[--s];){if(i.contains(o.elem)){if(o.elem===r||o.elem.contains(r)){o.fn.call(o.elem,e)}}else{a(t,o,s)}}},true)}if(c==="fixFocus"){avalon.bind(r,s[n],function(e){var t=f[c+n];var r=e.target;for(var s=t.length,o;o=t[--s];){var u=o.elem;if(i.contains(u)){if(u===r||u.contains(r)){if(n==="change"){if(u._just_changed===true){e.type="change";o.fn.call(u,e);u._just_changed=false}}else{e.type=n;o.fn.call(u,e)}}}else{a(t,o,s)}}})}if(c==="fixChange"){avalon.bind(r,"beforeactivate",u);avalon.bind(r,"beforedeactivate",u)}}e.specialBind=function(t,r){var i={elem:t,fn:r};if(/focus|blur/.test(n)){t.tabIndex=t.tabIndex||-1}if(c==="fixChange"){i.__change__=o(t)}var s=f[c+n];s.unshift(i);e.specialUnbind=function(){avalon.Array.remove(s,i);delete e.specialBind;delete e.specialUnbind}}}avalon.bindingHandlers.on(e,t)}}(t.exports,t,e);e.____MODULES["f9bdfeae993c58aeb4557e4b3b897a7a"]=t.exports})(this);(function(e){var t={id:"2ab11dddd1a66c979fc4d8cb729fc348",filename:"index.js",exports:{}};if(!e.____MODULES){e.____MODULES={}}var n=function(t,n,r){function i(e,t){if(avalon.type(e)==="array"){t=avalon.mix(true,{},{_:t});e={_:e}}else{t=avalon.mix(true,{},t)}for(var n in e){if(typeof t[n]=="undefined"||!e.hasOwnProperty(n)||n==="hasOwnProperty")continue;switch(avalon.type(e[n])){case"object":i(e[n],t[n]);break;case"array":avalon.each(t[n],function(t,r){var s=typeof e[n][t];if(s==="object"&&e[n][t]!==null){i(e[n][t],r)}else{if(t>=e[n].size()){e[n].push(r)}else{e[n].set(t,r)}}});while(e[n].length>t[n].length){e[n].pop()}break;default:e[n]=t[n];break}}}function s(e,t){var n=t,r;for(var i=0;i<e.length;i++){var s=e[i];if(typeof n[s]!=="undefined"){r=n;n=n[s]}else{return}}return r}e.____MODULES["65febc6852c794b8bb6827ffacacbdf8"];e.____MODULES["f9bdfeae993c58aeb4557e4b3b897a7a"];avalon.config({loader:false});avalon.$ui=function(e){return avalon.vmodels[e]};window.avalon=window.$$=avalon;avalon.assign=i;avalon.getModel=function(e,t){var n=e.split(".");for(var r=0;r<t.length;r++){var i=t[r];var o=s(n,i);if(typeof o!=="undefined")return[n[n.length-1],o,i]}return null};n.exports=avalon}(t.exports,t,e);e.____MODULES["2ab11dddd1a66c979fc4d8cb729fc348"]=t.exports})(this);(function(e){var t={id:"fdc46f922d9abc8918e08dbf90d9d03e",filename:"avalon.getModel.js",exports:{}};if(!e.____MODULES){e.____MODULES={}}var n=function(t,n,r){var i=e.____MODULES["2ab11dddd1a66c979fc4d8cb729fc348"];n.exports=function(){function e(e,t,n){var r=t,i,s;for(var o=0,u=e.length;o<u;o++){var a=e[o];s=r.$model||r;if(typeof s[a]!=="undefined"){i=r;r=r[a]}else{return}}if(n>1){return i[a]}else{return i}}i.getModel=function(t,n){if(!t){return null}var r=t.split("."),i=r.length,s=r[i-1];if(r.length!=1){r.pop()}for(var o=0,u=n.length;o<u;o++){var a=n[o];var f=e(r,a,i);if(typeof f!=="undefined"&&(f.hasOwnProperty(s)||Object.prototype.hasOwnProperty.call(f,s))){return[s,f,a]}}return null};return i}()}(t.exports,t,e);e.____MODULES["fdc46f922d9abc8918e08dbf90d9d03e"]=t.exports})(this);(function(e){var t={id:"ebe019d268672b2e5098adbedeb01097",filename:"avalon.button.js",exports:{}};if(!e.____MODULES){e.____MODULES={}}var n=function(t,n,r){var i=e.____MODULES["2ab11dddd1a66c979fc4d8cb729fc348"];n.exports=function(){function r(t,n){var r,s=e.concat(),o=false,u=n.icon||"",a=n.corner;n.label=n.label||"";if(a){s.push("oni-corner-all");if(a=parseInt(a)){t.style.borderRadius=a+"px"}}if(n.size){s.push("oni-button-"+n.size)}if(n.color){s.push("oni-button-"+n.color)}if(n.disabled){s.push("oni-state-disabled")}i(t).addClass(s.join(" "));if(n.elementType==="input"&&n.label){i(t).val(n.label);return}switch(n.type){case"text":r="<span class='oni-button-text'>"+n.label+"</span>";break;case"labeledIcon":o=true;case"icon":switch(n.iconPosition){case"left":r="<i class='oni-icon oni-icon-left'>"+u.replace(/\\/g,"")+"</i>"+"<span class='oni-button-text oni-button-text-right"+(!o?" oni-button-text-hidden":"")+"'>"+n.label+"</span>";break;case"right":r="<span class='oni-button-text oni-button-text-left"+(!o?" oni-button-text-hidden":"")+"'>"+n.label+"</span>"+"<i class='oni-icon oni-icon-right'>"+u.replace(/\\/g,"")+"</i>";break;case"left-right":var f=u&&u.split("-")||["",""],l=f[0],c=f[1];r="<i class='oni-icon oni-icon-left'>"+l.replace(/\\/g,"")+"&nbsp;</i>"+"<span class='oni-button-text oni-button-text-middle"+(!o?" oni-button-text-hidden":"")+"'>"+n.label+"</span>"+"<i class='oni-icon oni-icon-right'>&nbsp;"+c.replace(/\\/g,"")+"</i>";break}break}t.innerHTML=r}var e=["oni-button","oni-widget","oni-state-default"],t="oni-button-icons-only oni-button-icon-only oni-button-text-icons oni-button-text-icon-primary oni-button-text-icon-secondary oni-button-text-only";var n=i.ui.button=function(e,t,n){function a(e){if(s.disabled){e.preventDefault();e.stopImmediatePropagation()}}var s=t.buttonOptions,o,u=i(e);o={$init:function(){var t=s.data,o="",f=s.label,l=0,c=e.tagName.toLowerCase();if(s.groups&&t.length>1){var h="";t.forEach(function(e,t){var n="<span ms-widget='button'";if(e.type!==void 0){n+=" data-button-type='"+e.type+"'"}if(e.iconPosition!==void 0){n+=" data-button-icon-position='"+e.iconPosition+"'"}if(e.icon!==void 0){n+=" data-button-icon='"+e.icon+"'"}if(e.color!==void 0){n+=" data-button-color='"+e.color+"'"}if(e.size!==void 0){n+=" data-button-size='"+e.size+"'"}if(e.disabled!==void 0){n+=" data-button-disabled='"+e.disabled+"'"}if(e.label!==void 0){n+=" data-button-label='"+e.label+"'"}n+=">"+(e.text||"")+"</span>";h+=n});e.innerHTML=h;e.setAttribute("ms-widget","buttonset");if(s.direction=="vertical"){e.setAttribute("data-buttonset-direction","vertical")}if(!s.corner){e.setAttribute("data-buttonset-corner",s.corner)}if(s.width){e.setAttribute("data-buttonset-width",parseInt(s.width))}i.scan(e,n);return}if(typeof s.disabled!=="boolean"){s.disabled=!!e.disabled}else{e.disabled=s.disabled}if(c==="input"){o="input"}if(l=parseInt(s.width)){e.style.width=l+"px"}u.bind("mousedown",function(e){a(e);u.addClass("oni-state-active")});u.bind("mouseup",function(e){a(e);u.removeClass("oni-state-active")});u.bind("blur",function(){u.removeClass("oni-state-active");u.removeClass("oni-state-focus")});u.bind("focus",function(){u.addClass("oni-state-focus")});if(!s.label){f=o==="input"?e.value:e.innerHTML}s.elementType=o;s.label=f;r(e,s);i.scan(e,n)}};o.$init()};i.ui.buttonset=function(e,t,n){var r=t.buttonsetOptions,s=r.corner,o=r.direction,u=i(e);s=s!==void 0?s:true;var a={$init:function(){var a=[];a.push("oni-buttonset"),firstButtonClass="oni-corner-left",lastButtonClass="oni-corner-right",children=e.childNodes,buttons=[];buttonWidth=r.width,firstElement=true;for(var f=0,l;l=children[f++];){if(l.nodeType===1){l.setAttribute("data-button-corner","false");buttons.push(l);if(firstElement){i(l).addClass("oni-button-first");firstElement=false}}}var c=buttons.length;if(c&&s){if(o==="vertical"){firstButtonClass="oni-corner-top";lastButtonClass="oni-corner-bottom"}i(buttons[0]).addClass(firstButtonClass);i(buttons[c-1]).addClass(lastButtonClass)}if(o==="vertical"){a.push("oni-buttonset-vertical")}u.addClass(a.join(" "));t.buttons=buttons;i.scan(e,n);if(buttonWidth=parseInt(buttonWidth)){(function(e){var t=[].concat(buttons);setTimeout(function(){for(var n=0;button=t[n++];){var r=i(button),s=button.tagName.toLowerCase();if(s==="input"||s==="button"){button.style.width=e+"px"}else{button.style.width=e-parseInt(r.css("border-left-width"))-parseInt(r.css("border-right-width"))-parseInt(r.css("padding-left"))*2+"px"}}},10)})(buttonWidth);return}(function(e){var t=0,n=0;e=e.concat();t=setInterval(function(){var r=0,s=0,o;for(var u=0,a;a=e[u++];){r=Math.max(r,i(a).outerWidth())}if(r===n){n+=1;for(var u=0,a;a=e[u++];){var f=a.tagName.toLowerCase(),o=i(a);if(f==="input"||f==="button"){a.style.width=n+"px"}else{a.style.width=n-parseInt(o.css("border-left-width"))-parseInt(o.css("border-right-width"))-parseInt(o.css("padding-left"))*2+"px"}}clearInterval(t);return}n=r},100)})(buttons)}};a.$init()};n.version=1;n.defaults={groups:false,direction:"",data:[],type:"text",iconPosition:"left",icon:"",size:"",color:"",corner:true,style:"",disabled:false,label:"",width:""};return i}()}(t.exports,t,e);e.____MODULES["ebe019d268672b2e5098adbedeb01097"]=t.exports})(this);(function(e){var t={id:"36e422bfb7dcb2fd648a019317e8a224",filename:"avalon.draggable.js",exports:{}};if(!e.____MODULES){e.____MODULES={}}var n=function(t,n,r){var i=e.____MODULES["2ab11dddd1a66c979fc4d8cb729fc348"];n.exports=function(){function b(e,t){var n="page"+t;return c?e.changedTouches[0][n]:e[n]}function w(e,t,n,r,i){var s=b(e,r);if(n.containment){var o=r==="X"?n.containment[0]:n.containment[1];var u=r==="X"?n.containment[2]:n.containment[3];var a=s-(r==="X"?n.clickX:n.clickY);if(a<o){s+=Math.abs(o-a)}else if(a>u){s-=Math.abs(u-a)}}n["page"+r]=s;var f=m[r];var l=f.toLowerCase();var c=n["start"+f]+s-n["startPage"+r]+(i?n["end"+f]:0);n[l]=c;if(n["drag"+r]){t.style[l]=c+"px"}}function C(e,t){if(!e.containment){if(Array.isArray(t.containment)){return}t.containment=null;return}var n=t.$element.width();var r=t.$element.height();if(e.containment==="window"){var s=i(window);t.containment=[s.scrollLeft(),s.scrollTop(),s.scrollLeft()+s.width()-t.marginLeft-n,s.scrollTop()+s.height()-t.marginTop-r];return}if(e.containment==="document"){t.containment=[0,0,i(document).width()-t.marginLeft,i(document).height()-t.marginTop];return}if(Array.isArray(e.containment)){var o=e.containment;t.containment=[o[0],o[1],o[2]-n,o[3]-r];return}if(e.containment==="parent"||e.containment.charAt(0)==="#"){var u;if(e.containment==="parent"){u=t.element.parentNode}else{u=document.getElementById(e.containment.slice(1))}if(u){var a=i(u).offset();t.containment=[a.left+t.marginLeft,a.top+t.marginTop,a.left+u.offsetWidth-t.marginLeft-n,a.top+u.offsetHeight-t.marginTop-r]}}}var e={ghosting:false,delay:0,axis:"xy",started:true,start:i.noop,beforeStart:i.noop,drag:i.noop,beforeStop:i.noop,stop:i.noop,scrollPlugin:true,scrollSensitivity:20,scrollSpeed:20};var t=document.getElementById("avalonStyle");var n=".ui-helper-global-drag *{ -webkit-touch-callout: none;"+"-khtml-user-select: none;"+"-moz-user-select: none;"+"-ms-user-select: none;"+"user-select: none;}"+".ui-helper-global-drag img{-webkit-user-drag:none; "+"pointer-events:none;}";try{t.innerHTML+=n}catch(r){t.styleSheet.cssText+=n}var s;var o=navigator.userAgent;var u=/Android/i.test(o);var a=/BlackBerry/i.test(o);var f=/IEMobile/i.test(o);var l=/iPhone|iPad|iPod/i.test(o);var c=u||a||f||l;if(!c){var h="mousedown";var p="mousemove";var d="mouseup"}else{h="touchstart";p="touchmove";d="touchend"}var v=i.bindingHandlers.draggable=function(t,n){var r=t.value.match(i.rword)||[];var o=r[0]||"$";var u=r[1]||"draggable";var a,f;if(o!="$"){a=i.vmodels[o];if(!a){return}}t.element.removeAttribute("ms-draggable");if(!a){a=n.length?n[0]:null}var l=a||{};if(a&&typeof a[u]==="object"){f=a[u];if(f.$model){f=f.$model}l=f}var c=t.element;var p=i(c);var d=i.mix({},e,f||{},t[u]||{},i.getWidgetData(c,"draggable"));"drag,stop,start,beforeStart,beforeStop".replace(i.rword,function(e){var t=d[e];if(typeof t==="string"){if(typeof l[t]==="function"){d[e]=l[t]}}});if(d.axis!==""&&!/^(x|y|xy)$/.test(d.axis)){d.axis="xy"}s=document.body;p.bind(h,function(e){var t=i.mix({},d,{element:c,$element:p,pageX:b(e,"X"),pageY:b(e,"Y"),marginLeft:parseFloat(p.css("marginLeft"))||0,marginTop:parseFloat(p.css("marginTop"))||0});t.startPageX=t.pageX;t.startPageY=t.pageY;d.axis.replace(/./g,function(e){t["drag"+e.toUpperCase()]=true});if(!t.dragX&&!t.dragY){t.started=false}if(typeof d.beforeStart==="function"){d.beforeStart.call(t.element,e,t)}if(t.handle&&l){var n=l[t.handle];n=typeof n==="function"?n:t.handle;if(typeof n==="function"){var r=n.call(c,e,t);if(r&&r.nodeType===1){if(!c.contains(r)){return}}else{return}}}S();var o=p.css("position");if(!/^(?:r|a|f)/.test(o)){c.style.position="relative";c.style.top="0px";c.style.left="0px"}if(d.delay&&isFinite(d.delay)){t.started=false;setTimeout(function(){t.started=true},d.delay)}var u=p.offset();if(d.ghosting){var a=c.cloneNode(true);i(a).css("opacity",.7).width(c.offsetWidth).height(c.offsetHeight);t.clone=a;if(o!=="fixed"){a.style.position="absolute";a.style.top=u.top-t.marginTop+"px";a.style.left=u.left-t.marginLeft+"px"}s.appendChild(a)}var f=i(t.clone||t.element);t.startLeft=parseFloat(f.css("left"));t.startTop=parseFloat(f.css("top"));t.endLeft=parseFloat(p.css("left"))-t.startLeft;t.endTop=parseFloat(p.css("top"))-t.startTop;t.clickX=t.pageX-u.left;t.clickY=t.pageY-u.top;C(d,t);v.dragData=t;"start,drag,beforeStop,stop".replace(i.rword,function(e){v[e]=[d[e]]});v.plugin.call("start",e,t)})};var m={X:"Left",Y:"Top"};v.dragData={};v.start=[];v.drag=[];v.stop=[];v.beforeStop=[];v.plugin={add:function(e,t){for(var n in t){var r=t[n];if(typeof r==="function"&&Array.isArray(v[n])){r.isPlugin=true;r.pluginName=e+"Plugin";v[n].push(r)}}},call:function(e,t,n){var r=v[e];if(Array.isArray(r)){r.forEach(function(e){if(typeof e.pluginName==="undefined"?true:n[e.pluginName]){e.call(n.element,t,n)}})}if(e==="stop"){for(var s in v){r=v[s];if(Array.isArray(r)){r.forEach(function(e){if(!e.isPlugin){i.Array.remove(r,e)}})}}}}};var g=new Date-0,y=document.querySelector?12:30;i(document).bind(p,function(e){var t=new Date-g;if(t>y){g=t;var n=v.dragData;if(n.started===true){e.preventDefault();var r=n.clone||n.element;w(e,r,n,"X");w(e,r,n,"Y");v.plugin.call("drag",e,n)}}});i(document).bind(d,function(e){var t=v.dragData;if(t.started===true){x();var n=t.element;v.plugin.call("beforeStop",e,t);if(t.dragX){w(e,n,t,"X",true)}if(t.dragY){w(e,n,t,"Y",true)}if(t.clone){s.removeChild(t.clone)}v.plugin.call("stop",e,t);v.dragData={}}});var E=document.documentElement;var S=function(){i(E).addClass("ui-helper-global-drag")};var x=function(){i(E).removeClass("ui-helper-global-drag")};if(window.VBArray&&!("msUserSelect"in E.style)){var T;function N(){var e=window.event||{};e.returnValue=false}S=function(){T=s.onselectstart;s.onselectstart=N};x=function(){s.onselectstart=T}}return i}()}(t.exports,t,e);e.____MODULES["36e422bfb7dcb2fd648a019317e8a224"]=t.exports})(this);(function(e){var t={id:"d9a0811df9360928cb0a5469c2afd199",filename:"avalon.dialog.js",exports:{}};if(!e.____MODULES){e.____MODULES={}}var n=function(t,n,r){var i=e.____MODULES["fdc46f922d9abc8918e08dbf90d9d03e"],s='<div class="oni-dialog-layout"></div>\nMS_OPTION_WIDGET\n<div ms-widget="dialog,MS_OPTION_ID,MS_OPTION_OPTS" ms-css-position="position">MS_OPTION_DIALOG_CONTENT</div>\nMS_OPTION_INNERWRAPPER\n<div class="oni-dialog-inner"></div>\nMS_OPTION_HEADER\n<div class="oni-dialog-header">\n    <div class="oni-dialog-close" ms-click="_close" ms-if="showClose">\n        <i class="oni-icon oni-icon-times">&#xf003;</i>\n    </div>\n    <div class="oni-dialog-title">{{ title|html }}</div>\n</div>\nMS_OPTION_CONTENT\n<div class="oni-dialog-content"></div>\nMS_OPTION_FOOTER\n<div class="oni-dialog-footer oni-helper-clearfix">\n    <div class="oni-dialog-btns">\n        <button ms-widget="button" data-button-color="success" ms-hover="oni-state-hover" ms-click="_confirm">{{confirmName}}</button>\n        <button ms-widget="button" ms-if="type ==\'confirm\'" ms-click="_cancel">{{cancelName}}</button>\n    </div>\n</div>\nMS_OPTION_LAYOUT_SIMULATE\n<div></div>';e.____MODULES["ebe019d268672b2e5098adbedeb01097"];e.____MODULES["36e422bfb7dcb2fd648a019317e8a224"];n.exports=function(){function v(e){var t=e;if(t){if(i.type(t)==="string"){t=i.vmodels[t]}}else{t=i.define("dialogVM"+setTimeout("1"),function(e){})}if(!t){throw new Error("您查找的"+t+"不存在")}if(i.isPlainObject(t)&&!t.$id&&!t.$accessors){t=i.define("dialogVM"+setTimeout("1"),function(t){i.mix(t,e)})}return[].concat(t)}function m(e,t,n,r){var i=null;var s;return function(){var o=this,u=+(new Date);clearTimeout(i);if(!s){s=u}if(u-s>=n){e.apply(o,r);s=u}else{i=setTimeout(function(){e.apply(o,r)},t)}}}function g(e,t,n){var s,o,u,l,h=i(r),p=i(a),d=i(t),v,m,g,y=0,b=0;if(!e.toggle)return;g=document.compatMode&&document.compatMode.toLowerCase()=="css1compat"?document.documentElement:document.body;s=document.documentElement.clientWidth?document.documentElement.clientWidth:document.body.clientWidth;o=document.documentElement.clientHeight?document.documentElement.clientHeight:document.body.clientHeight;v=document.body.scrollTop+document.documentElement.scrollTop;m=g.scrollLeft;u=t.offsetWidth;l=t.offsetHeight;if(l<o){y=(o-l)/2}else{y=0}if(u<s){b=(s-u)/2+m}else{b=0}if(l<o&&u<s){if(!c){e.position="fixed"}}else{if(!c){e.position="absolute"}}if(n&&e.position=="fixed")return;if(e.position==="absolute"){if(f.length>1){for(var w=0;w<f.length-1;w++){f[w].widgetElement.style.display="none"}}h.css({height:o,width:s,top:v,position:"absolute"});p.css({height:o,width:s,top:v,overflow:"auto",position:"absolute"})}else{if(f.length>1){for(var w=0;w<f.length-1;w++){f[w].widgetElement.style.display="block"}}h.css({height:"auto",width:"auto",top:0,position:"fixed"});p.css({height:"auto",width:"auto",top:0,position:"static"})}d.css({left:b,top:y})}function y(){var e=document.body.children,t=10,n;for(var s=0,o;o=e[s++];){if(o.nodeType===1){if(o===r)continue;n=~~i(o).css("z-index");if(n){t=Math.max(t,n)}}}return t+1}function b(){var e=document.createElement('<iframe src="javascript:\'\'" style="position:absolute;top:0;left:0;bottom:0;margin:0;padding:0;right:0;zoom:1;width:'+r.style.width+";height:"+r.style.height+";z-index:"+(r.style.zIndex-1)+';"></iframe>');document.body.appendChild(e);return e}var e=s,t=e.split("MS_OPTION_WIDGET"),n=t[0],r=i.parseHTML(n).firstChild,o=false,u=e.split("MS_OPTION_LAYOUT_SIMULATE")[1],a=i.parseHTML(u).firstChild,f=[],l=0,c=(window.navigator.userAgent||"").toLowerCase().indexOf("msie 6")!==-1,h=null,p=document.compatMode&&document.compatMode.toLowerCase()=="css1compat"?document.documentElement:document.body;var d=i.ui.dialog=function(t,n,s){l++;var u=n.dialogOptions;u.type=u.type.toLowerCase();u.template=u.getTemplate(e,u);var d=u.template.split("MS_OPTION_FOOTER"),w=d[0].split("MS_OPTION_CONTENT"),E=w[0].split("MS_OPTION_HEADER"),S=E[0].split("MS_OPTION_INNERWRAPPER"),x=w[1],T=E[1],N=d[1].split("MS_OPTION_LAYOUT_SIMULATE")[0],C=S[1],k="",L="",A=i(t),O=u.onConfirm,M=null,_=u.onCancel,D=null,P=u.onOpen,H=null,B=u.onClose,j=null,F=true,I=c?"absolute":"fixed";if(typeof O==="string"){M=i.getModel(O,s);u.onConfirm=M&&M[1][M[0]]||i.noop}if(typeof _==="string"){D=i.getModel(_,s);u.onCancel=D&&D[1][D[0]]||i.noop}if(typeof B==="string"){i.log("ms-widget='dialog' data-dialog-on-close 此用法已经被废弃");j=i.getModel(B,s);u.onClose=j&&j[1][j[0]]||i.noop}if(typeof P==="string"){H=i.getModel(P,s);u.onOpen=H&&H[1][H[0]]||i.noop}N=u.getFooter(N,u);var q=i.define(n.dialogId,function(e){i.mix(e,u);e.$skipArray=["widgetElement","template","container","modal","zIndexIncrementGlobal","initChange","content"];e.widgetElement=t;e.position=I;e.showClose=e.type==="alert"?false:e.showClose;e.initChange=true;e._confirm=function(e){if(typeof q.onConfirm!=="function"){throw new Error("onConfirm必须是一个回调方法")}if(q.onConfirm.call(e.target,e,q)!==false){q._close(e)}};e._open=function(e){var n=0,s=document.getElementsByTagName("select").length,o=q.zIndex;i.Array.ensure(f,q);n=f.length;if(n){i(r).css("display","block");i(a).css("display","block")}r.style.zIndex=2*n+o-1;a.style.zIndex=2*n+o-1;t.style.zIndex=2*n+o;if(e){return}document.documentElement.style.overflow="hidden";g(q,t);if(c&&s&&h===null&&q.modal){h=b()}else if(c&&s&&q.modal){h.style.display="block";h.style.width=r.style.width;h.style.height=r.style.height;h.style.zIndex=r.style.zIndex-1}q.onOpen.call(t,q)};e._close=function(n){i.Array.remove(f,e);var s=f.length,o=q.zIndex,u=s&&f[s-1];if(n){F=false}q.toggle=false;if(u&&u.modal){i(r).css("display","block");i(a).css("display","block");u.widgetElement.style.display="block";g(u,u.widgetElement)}else{i(r).css("display","none");i(a).css("display","none");if(h!==null){h.style.display="none"}document.documentElement.style.overflow="";q.onClose.call(t,q);return}var l=2*s+o-1;r.style.zIndex=l;a.style.zIndex=l;if(h){h.style.zIndex=l-1}q.onClose.call(t,q)};e._cancel=function(e){if(typeof q.onCancel!="function"){throw new Error("onCancel必须是一个回调方法")}if(q.onCancel.call(e.target,e,q)!==false){q._close(e)}};e.setContent=function(e,t,n){var r=n?n:[q].concat(s);k=e;L.innerHTML=k;if(!t){i.scan(L,r)}return q};e.setTitle=function(e){q.title=e;return q};e.setModel=function(e){if(!!e.$content){q.setContent(e.$content,e.noScan,[q].concat(v(e)).concat(s))}if(!!e.$title){q.title=e.$title}return q};e._renderView=function(){var e=null;t.setAttribute("ms-css-width","width");L=i.parseHTML(x).firstChild;k=t.innerHTML||q.content;t.innerHTML="";L.innerHTML=k;e=i.parseHTML(C).firstChild;e.innerHTML=T;e.appendChild(L);e.appendChild(i.parseHTML(N));t.appendChild(e);if(!o){document.body.appendChild(r);document.body.appendChild(a);o=true}};e.$init=function(n){var r=q.container,o=p.clientHeight,f=document.body,l=(i.type(r)==="object"&&r.nodeType===1&&f.contains(r)?r:document.getElementById(r))||f,c=i.ui.dialog.defaults;if(!c.zIndex){c.zIndex=y()}if(i(f).height()<o){i(f).css("min-height",o)}if(q.draggable){A.attr("ms-draggable","");q.draggable={handle:function(e){var t=e.target;do{if(t.className==="oni-dialog-header"){return t}if(t.className==="oni-dialog"){return}}while(t=t.parentNode)}}}q.zIndex=q.zIndex+q.zIndexIncrementGlobal;q.title=q.title||"&nbsp;";A.addClass("oni-dialog");if(t.getAttribute("id")=="groupEdit"){A.addClass("self-gm-group")}t.setAttribute("ms-visible","toggle");t.setAttribute("ms-css-position","position");e._renderView();if(f.contains(a)&&f==l){a.appendChild(t)}else{l.appendChild(t)}t.resizeCallback=i(window).bind("resize",m(g,50,100,[q,t]));t.scrollCallback=i(window).bind("scroll",m(g,50,100,[q,t,true]));i.scan(t,[q].concat(s));if(n){n()}else{i.log("avalon请尽快升到1.3.7+");i.scan(t,[q].concat(s));if(typeof u.onInit==="function"){u.onInit.call(t,q,u,s)}}};e.$remove=function(){l--;t.innerHTML="";i.unbind(window,"resize",t.resizeCallback);i.unbind(window,"scroll",t.scrollCallback);if(!l){r.parentNode.removeChild(r);r.parentNode.removeChild(a);o=false}};e.$watch("toggle",function(e){if(e){q._open();t.style.display="block";t.resizeCallback()}else{if(F===false){F=true}else{q._close()}}});e.$watch("zIndex",function(e){if(q.initChange){q.initChange=false}else{q._open(true)}})});return q};d.version=1;d.defaults={width:480,title:"&nbsp;",draggable:false,type:"confirm",content:"",onConfirm:i.noop,onOpen:i.noop,onCancel:i.noop,onClose:i.noop,setTitle:i.noop,setContent:i.noop,setModel:i.noop,showClose:true,toggle:false,widgetElement:"",container:"body",confirmName:"确定",cancelName:"取消",getTemplate:function(e,t){return e},getFooter:function(e){return e},modal:true,zIndex:0,zIndexIncrementGlobal:0};i(window).bind("keydown",function(e){var t=e.which,n=f.length;if(t===27&&n){f[n-1].toggle=false}});return i}()}(t.exports,t,e);e.____MODULES["d9a0811df9360928cb0a5469c2afd199"]=t.exports})(this);(function(e){var t={id:"2f17dbeb5563c45e749f1774d593001c",filename:"mmPromise.js",exports:{}};if(!e.____MODULES){e.____MODULES={}}var n=function(t,n,r){var i=e.____MODULES["2ab11dddd1a66c979fc4d8cb729fc348"];n.exports=function(){function e(e){return e}function t(e){throw e}function n(e){return this.then(e,t)}function r(t){return this.then(e,t)}function s(){var e={};e.promise=new this(function(t,n){e.resolve=t;e.reject=n});return e}function u(e,t){if(typeof e.async==="boolean"){var n=e.async}else{n=e.async=true}if(n){window.setTimeout(t,0)}else{t()}}function f(e,t){if(e._state!=="pending")return;if(t&&typeof t.then==="function"){var n=t instanceof o?"_then":"then";t[n](function(t){c(e,t,true)},function(t){c(e,t,false)})}else{c(e,t,true)}}function l(e,t){if(e._state!=="pending")return;c(e,t,false)}function c(e,t,n){e._fired=true;e._value=t;e._state=n?"fulfilled":"rejected";u(e,function(){e._callbacks.forEach(function(t){e._fire(t.onSuccess,t.onFail)})})}function h(e,t){t=Array.isArray(t)?t:[];var n=0,r=[],i;return new o(function(s,o){function u(u,a){u.then(function(o){if(!i){r[a]=o;n++;if(e||n>=t.length){s(e?o:r);i=true}}},function(e){i=true;o(e)})}if(!t.length)s();for(var a=0,f=t.length;a<f;a++){u(t[a],a)}})}var o=function(e){this._callbacks=[];var t=this;if(typeof this!=="object")throw new TypeError("Promises must be constructed via new");if(typeof e!=="function")throw new TypeError("not a function");e(function(e){f(t,e)},function(e){l(t,e)})};o.resolve=function(e){return new o(function(t){t(e)})};o.reject=function(e){return new o(function(t,n){n(e)})};o.prototype={constructor:o,_state:"pending",_fired:false,_fire:function(e,t){if(this._state==="rejected"){if(typeof t==="function"){t(this._value)}else{throw this._value}}else{if(typeof e==="function"){e(this._value)}}},_then:function(e,t){if(this._fired){var n=this;u(n,function(){n._fire(e,t)})}else{this._callbacks.push({onSuccess:e,onFail:t})}},then:function(n,r){n=typeof n==="function"?n:e;r=typeof r==="function"?r:t;var i=this;var s=new o(function(e,t){i._then(function(r){try{r=n(r)}catch(i){t(i);return}e(r)},function(n){try{n=r(n)}catch(i){t(i);return}e(n)})});for(var u in i){if(!a[u]){s[u]=i[u]}}return s},done:n,"catch":r,fail:r};var a={_state:1,_fired:1,_value:1,_callbacks:1};o.all=function(e){return h(false,e)};o.race=function(e){return h(true,e)};o.defer=s;i.Promise=o;var p=window.Promise;if(/native code/.test(p)){p.prototype.done=n;p.prototype.fail=r;if(!p.defer){p.defer=s}}return window.Promise=p||o}()}(t.exports,t,e);e.____MODULES["2f17dbeb5563c45e749f1774d593001c"]=t.exports})(this);(function(e){var t={id:"2911e08ffe5ce1f604ded6a87a2c86ff",filename:"avalon.validation.js",exports:{}};if(!e.____MODULES){e.____MODULES={}}var n=function(t,n,r){var i=e.____MODULES["2ab11dddd1a66c979fc4d8cb729fc348"];e.____MODULES["2f17dbeb5563c45e749f1774d593001c"];n.exports=function(){function e(e){if(/^\d{15}$/.test(e)){return true}else if(/^\d{17}[0-9xX]$/.test(e)){var t="1,0,x,9,8,7,6,5,4,3,2".split(","),n="7,9,10,5,8,4,2,1,6,3,7,9,10,5,8,4,2".split(","),r=e.toLowerCase().split(""),i=0;for(var s=0;s<17;s++){i+=n[s]*r[s]}return t[i%11]==r[17]}}function t(e){if(n.test(e)){var t=parseInt(RegExp.$1,10);var r=parseInt(RegExp.$2,10);var i=parseInt(RegExp.$3,10);var s=new Date(i,r-1,t,12,0,0,0);if(s.getUTCFullYear()===i&&s.getUTCMonth()===r-1&&s.getUTCDate()===t){return true}}return false}function a(e){if(e.target){return e}var t={};for(var n in e){t[n]=e[n]}var r=t.target=e.srcElement;if(e.type.indexOf("key")===0){t.which=e.charCode!=null?e.charCode:e.keyCode}else if(/mouse|click/.test(e.type)){var i=r.ownerDocument||document;var s=i.compatMode==="BackCompat"?i.body:i.documentElement;t.pageX=e.clientX+(s.scrollLeft>>0)-(s.clientLeft>>0);t.pageY=e.clientY+(s.scrollTop>>0)-(s.clientTop>>0);t.wheelDeltaY=t.wheelDelta;t.wheelDeltaX=0}t.timeStamp=new Date-0;t.originalEvent=e;t.preventDefault=function(){e.returnValue=false};t.stopPropagation=function(){e.cancelBubble=true};return t}function c(){var e=this.data||{};return this.message.replace(l,function(t,n){return e[n]==null?"":e[n]})}if(!i.duplexHooks){throw new Error("你的版本少于avalon1.3.7，不支持ms-duplex2.0，请使用avalon.validation.old.js")}var n=/^\d{4}\-\d{1,2}\-\d{1,2}$/;var r=/^([A-Z0-9]+[_|\_|\.]?)*[A-Z0-9]+@([A-Z0-9]+[_|\_|\.]?)*[A-Z0-9]+\.[A-Z]{2,3}$/i;var s=/^(25[0-5]|2[0-4]\d|[01]?\d\d?)\.(25[0-5]|2[0-4]\d|[01]?\d\d?)\.(25[0-5]|2[0-4]\d|[01]?\d\d?)\.(25[0-5]|2[0-4]\d|[01]?\d\d?)$/i;var o=/^((([0-9A-Fa-f]{1,4}:){7}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){6}:[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){5}:([0-9A-Fa-f]{1,4}:)?[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){4}:([0-9A-Fa-f]{1,4}:){0,2}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){3}:([0-9A-Fa-f]{1,4}:){0,3}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){2}:([0-9A-Fa-f]{1,4}:){0,4}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){6}((\b((25[0-5])|(1\d{2})|(2[0-4]\d)|(\d{1,2}))\b)\.){3}(\b((25[0-5])|(1\d{2})|(2[0-4]\d)|(\d{1,2}))\b))|(([0-9A-Fa-f]{1,4}:){0,5}:((\b((25[0-5])|(1\d{2})|(2[0-4]\d)|(\d{1,2}))\b)\.){3}(\b((25[0-5])|(1\d{2})|(2[0-4]\d)|(\d{1,2}))\b))|(::([0-9A-Fa-f]{1,4}:){0,5}((\b((25[0-5])|(1\d{2})|(2[0-4]\d)|(\d{1,2}))\b)\.){3}(\b((25[0-5])|(1\d{2})|(2[0-4]\d)|(\d{1,2}))\b))|([0-9A-Fa-f]{1,4}::([0-9A-Fa-f]{1,4}:){0,5}[0-9A-Fa-f]{1,4})|(::([0-9A-Fa-f]{1,4}:){0,6}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){1,7}:))$/i;var u={cm:/^(?:0?1)((?:3[56789]|5[0124789]|8[278])\d|34[0-8]|47\d)\d{7}$/,cu:/^(?:0?1)(?:3[012]|4[5]|5[356]|8[356]\d|349)\d{7}$/,ce:/^(?:0?1)(?:33|53|8[079])\d{8}$/,cn:/^(?:0?1)[3458]\d{9}$/};i.mix(i.duplexHooks,{trim:{get:function(e,t){if(t.element.type!=="password"){e=String(e||"").trim()}return e}},required:{message:"必须填写",get:function(e,t,n){n(e!=="");return e}},norequired:{message:"可以不写",get:function(e,t,n){n(true);return e}},"int":{message:"必须是整数",get:function(e,t,n){n(/^\-?\d+$/.test(e));return e}},phone:{message:"手机号码不合法",get:function(e,t,n){var r=false;for(var i in u){if(u[i].test(e)){r=true;break}}n(r);return e}},decimal:{message:"必须是小数",get:function(e,t,n){n(/^\-?\d*\.?\d+$/.test(e));return e}},alpha:{message:"必须是字母",get:function(e,t,n){n(/^[a-z]+$/i.test(e));return e}},alpha_numeric:{message:"必须为字母或数字",get:function(e,t,n){n(/^[a-z0-9]+$/i.test(e));return e}},alpha_dash:{message:"必须为字母或数字及下划线等特殊字符",validate:function(e,t,n){n(/^[a-z0-9_\-]+$/i.test(e));return e}},chs:{message:"必须是中文字符",get:function(e,t,n){n(/^[\u4e00-\u9fa5]+$/.test(e));return e}},chs_numeric:{message:"必须是中文字符或数字及下划线等特殊字符",get:function(e,t,n){n(/^[\\u4E00-\\u9FFF0-9_\-]+$/i.test(e));return e}},qq:{message:"腾讯QQ号从10000开始",get:function(e,t,n){n(/^[1-9]\d{4,10}$/.test(e));return e}},id:{message:"身份证格式错误",get:function(t,n,r){r(e(t));return t}},ipv4:{message:"ip地址不正确",get:function(e,t,n){n(s.test(e));return e}},ipv6:{message:"ip地址不正确",get:function(e,t,n){n(o.test(e));return e}},email:{message:"邮件地址错误",get:function(e,t,n){n(r.test(e));return e}},url:{message:"URL格式错误",get:function(e,t,n){n(/^(ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?$/.test(e));return e}},repeat:{message:"密码输入不一致",get:function(e,t,n){var r=t.element.getAttribute("data-duplex-repeat")||"";var s=i(document.getElementById(r)).val()||"";n(e===s);return e}},date:{message:"必须符合日期格式 YYYY-MM-DD",get:function(e,n,r){r(t(e));return e}},passport:{message:"护照格式错误或过长",get:function(e,t,n){n(/^[a-zA-Z0-9]{4,20}$/i.test(e));return e}},minlength:{message:"最少输入{{min}}个字",get:function(e,t,n){var r=t.element;var i=parseInt(r.getAttribute("minlength"),10);if(!isFinite(i)){i=parseInt(r.getAttribute("data-duplex-minlength"),10)}var s=t.data.min=i;n(e.length>=s);return e}},maxlength:{message:"最多输入{{max}}个字",get:function(e,t,n){var r=t.element;var i=parseInt(r.getAttribute("maxlength"),10);if(!isFinite(i)){i=parseInt(r.getAttribute("data-duplex-maxlength"),10)}var s=t.data.max=i;n(e.length<=s);return e}},gt:{message:"必须大于{{max}}",get:function(e,t,n){var r=t.element;var i=parseInt(r.getAttribute("max"),10);if(!isFinite(i)){i=parseInt(r.getAttribute("data-duplex-gt"),10)}var s=t.data.max=i;n(parseFloat(e)>s);return e}},lt:{message:"必须小于{{min}}",get:function(e,t,n){var r=t.element;var i=parseInt(r.getAttribute("min"),10);if(!isFinite(i)){i=parseInt(r.getAttribute("data-duplex-lt"),10)}var s=t.data.min=i;n(parseFloat(e)<s);return e}},eq:{message:"必须等于{{eq}}",get:function(e,t,n){var r=t.element;var i=parseInt(r.getAttribute("data-duplex-eq"),10);var s=t.data.eq=i;n(parseFloat(e)==s);return e}},contains:{message:"必须包含{{array}}中的一个",get:function(e,t,n){var r=[].concat(e).map(String);var i=(t.element.getAttribute("data-duplex-contains")||"").split(",");t.data.array=i;var s=false;for(var o=0,u=r.length;o<u;o++){var a=r[o];if(i.indexOf(a)>=0){s=true;break}}n(s);return e}},contain:{message:"必须包含{{array}}",get:function(e,t,n){var r=[].concat(e).map(String);var i=(t.element.getAttribute("data-duplex-contain")||"").split(",");t.data.array=i.join("与");if(!r.length){var s=false}else{s=true;for(var o=0,u=i.length;o<u;o++){var a=i[o];if(r.indexOf(a)===-1){s=false;break}}}n(s);return e}},pattern:{message:"必须匹配/{{pattern}}/这样的格式",get:function(e,t,n){var r=t.element;var i=r.getAttribute("pattern");var s=r.getAttribute("data-duplex-pattern");var o=t.data.pattern=i||s;var u=new RegExp("^(?:"+o+")$");n(u.test(e));return e}}});var f=i.ui.validation=function(e,t,n){var r=t.validationOptions;var s;var o=i.define(t.validationId,function(t){i.mix(t,r);t.$skipArray=["widgetElement","data","validationHooks","validateInKeyup","validateAllInSubmit","resetInBlur"];t.widgetElement=e;t.data=[];t.$init=function(){e.setAttribute("novalidate","novalidate");i.scan(e,[o].concat(n));if(t.validateAllInSubmit){s=i.bind(e,"submit",function(e){e.preventDefault();t.validateAll(t.onValidateAll)})}if(typeof r.onInit==="function"){r.onInit.call(e,o,r,n)}};t.$destory=function(){t.data=[];s&&i.unbind(e,"submit",s);e.textContent=e.innerHTML=""};t.validateAll=function(e){var n=typeof e==="function"?e:t.onValidateAll;var r=t.data.filter(function(e){var t=e.element;return t&&!t.disabled&&o.widgetElement.contains(t)}).map(function(e){return t.validate(e,true)});Promise.all(r).then(function(e){var r=[];for(var i=0,s;s=e[i++];){r=r.concat(s)}if(t.deduplicateInValidateAll){var o={};r=r.filter(function(e){var t=e.element;var n=t.getAttribute("data-validation-id");if(!n){n=setTimeout("1");t.setAttribute("data-validation-id",n)}if(o[n]){return false}else{o[n]=true;return true}})}n.call(t.widgetElement,r)})};t.resetAll=function(e){t.data.filter(function(e){return e.element}).forEach(function(e){try{t.onReset.call(e.element,{type:"reset"},e)}catch(n){}});var n=typeof e=="function"?e:t.onResetAll;n.call(t.widgetElement)};t.validate=function(e,n,r){var s=e.valueAccessor();var u=o.validationHooks;var a=i.duplexHooks;var f=[];var l=e.element;e.validateParam.replace(/\w+/g,function(t){var n=u[t]||a[t];if(!l.disabled){var r,i;f.push(new Promise(function(e,t){r=e;i=t}));var o=function(i){if(e.norequired&&s===""){i=true}if(i){r(true)}else{var o={element:l,data:e.data,message:l.getAttribute("data-duplex-"+t+"-message")||l.getAttribute("data-duplex-message")||n.message,validateRule:t,getMessage:c};r(o)}};e.data={};n.get(s,e,o)}});var h=Promise.all(f).then(function(e){var i=[];for(var s=0,o;o=e[s++];){if(typeof o==="object"){i.push(o)}}if(!n){if(i.length){t.onError.call(l,i,r)}else{t.onSuccess.call(l,i,r)}t.onComplete.call(l,i,r)}return i});return h};t.$watch("avalon-ms-duplex-init",function(n){var r=o.validationHooks;n.valueAccessor=n.evaluator.apply(null,n.args);switch(i.type(n.valueAccessor())){case"array":n.valueResetor=function(){this.valueAccessor([])};break;case"boolean":n.valueResetor=function(){this.valueAccessor(false)};break;case"number":n.valueResetor=function(){this.valueAccessor(0)};break;default:n.valueResetor=function(){this.valueAccessor("")};break}var s=i.duplexHooks;if(typeof n.pipe!=="function"&&i.contains(e,n.element)){var u=[];var f=[];n.param.replace(/\w+/g,function(e){var t=r[e]||s[e];if(t&&typeof t.get==="function"&&t.message){f.push(e)}else{u.push(e)}if(e==="norequired"){n.norequired=true}});n.validate=t.validate;n.param=u.join("-");n.validateParam=f.join("-");if(f.length){if(t.validateInKeyup){n.bound("keyup",function(e){var r=n.element&&n.element.getAttribute("data-duplex-event");if(!r||/^(?:key|mouse|click|input)/.test(r)){var i=a(e);setTimeout(function(){t.validate(n,0,i)})}})}if(t.validateInBlur){n.bound("blur",function(e){t.validate(n,0,a(e))})}if(t.resetInFocus){n.bound("focus",function(e){t.onReset.call(n.element,a(e),n)})}var l=t.data.filter(function(e){return e.element});i.Array.ensure(l,n);t.data=l}return false}})});return o};var l=/\\?{{([^{}]+)\}}/gm;f.defaults={validationHooks:{},onSuccess:i.noop,onError:i.noop,onComplete:i.noop,onValidateAll:i.noop,onReset:i.noop,onResetAll:i.noop,validateInBlur:true,validateInKeyup:true,validateAllInSubmit:true,resetInFocus:true,deduplicateInValidateAll:false}}()}(t.exports,t,e);e.____MODULES["2911e08ffe5ce1f604ded6a87a2c86ff"]=t.exports})(this);(function(e){var t={id:"2f07999ff4151bac4f30b3501573c99f",filename:"avalon.loading.js",exports:{}};if(!e.____MODULES){e.____MODULES={}}var n=function(t,n,r){var i=e.____MODULES["2ab11dddd1a66c979fc4d8cb729fc348"],s='<div class="oni-helper-reset oni-helper-clearfix oni-widget oni-loading-modal" \n     ms-class-100="oni-helper-max-index:toggle" \n     ms-if="modal" \n     ms-attr-id="\'modal\'+$loadingID" \n     style="z-index:999;" \n     ms-css-opacity="modalOpacity" \n     ms-css-background-color="modalBackground" \n     ms-visible="toggle">\n     <iframe allowTransparency="true" frameborder="none" src="javascript:\'\'"></iframe>\n     </div>\n<div class="oni-helper-reset oni-helper-clearfix oni-widget oni-widget-content oni-loading" \n     ms-class-100="oni-helper-max-index:toggle" \n     ms-visible="toggle" \n     ms-css-width="width" \n     ms-css-height="height" \n     ms-css-margin-left="-width/2+\'px\'" \n     ms-css-margin-top="-height/2+\'px\'" \n     ms-attr-id="\'oni-loading-\'+$loadingID"><div \n     ms-css-width="width" \n     ms-css-height="height">{{MS_WIDGET_HTML}}</div></div>',o='{{MS_WIDGET_BALL}}\n<v:oval ms-repeat-item="data" style="position:absolute;" stroked="false" \n  ms-attr-fillcolor="color" \n  ms-css-left="item.x + \'px\'" \n  ms-css-top="item.y + \'px\'" \n  ms-css-width="item.r * 2 + \'px\'" \n  ms-css-height="item.r * 2 + \'px\'">\n</v:oval>\n{{MS_WIDGET_DIVIDER}}\n<svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%">\n  <circle  \n          ms-attr-r="data[$index].r" \n          ms-attr-cx="data[$index].x+data[$index].r" \n          ms-attr-cy="data[$index].y+data[$index].r" \n          ms-repeat="data" \n          ms-attr-fill="color">\n      <animate attributeName="opacity" from="1" to=".1" repeatCount="indefinite" \n               ms-if="type==\'ball\'" \n               ms-attr-dur="svgDur" \n               ms-attr-begin="data[$index].begin"/>\n      <animate attributeName="r" repeatCount="indefinite" keySplines="0.2 0.2 0.4 0.8;0.2 0.2 0.4 0.8;0.2 0.2 0.4 0.8" calcMode="spline" \n               ms-attr-values="\'0;\'+data[$index].r+\';0;0\'"\n               ms-attr-dur="svgDur" \n               ms-if="type==\'spinning-bubbles\'" \n               ms-attr-begin="data[$index].begin"/>\n      <animate attributeName="r" repeatCount="indefinite" keytimes="0;0.2;0.7;1" keySplines="0.2 0.2 0.4 0.8;0.2 0.6 0.4 0.8;0.2 0.6 0.4 0.8" calcMode="spline" \n        ms-if="type==\'bubbles\'"\n        ms-attr-begin="data[$index].begin"  \n        ms-attr-dur="svgDur" \n        ms-attr-values="\'0;\'+data[$index].r+\';0;0\'" />\n  </circle>\n</svg>\n{{MS_WIDGET_TYPE}}\n{{MS_WIDGET_SPIN}}\n<v:oval stroked="true" filled="F" \n        ms-attr-strokecolor="color" \n        ms-css-height="width+\'px\'" \n        ms-css-width="width+\'px\'" \n        ms-css-opacity="opacity" \n        ms-attr-strokeweight="width / 2 - widthInner / 2+\'px\'" \n        ms-repeat="data" \n  style="position:absolute;z-index:2;left:0;top:0;"></v:oval>\n<v:arc stroked="true" filled="F" \n    ms-attr-strokecolor="color" \n    ms-attr-strokeweight="width / 2 - widthInner / 2+\'px\'" \n    style="position:absolute;z-index:3;text-indent:-1000px;overflow:hidden;left:0;top:0;" \n    ms-attr-startangle="startangle" \n    ms-attr-endangle="endangle" \n    ms-css-height="width+\'px\'" \n    ms-css-width="width+\'px\'" \n    ms-repeat="data">\n  </v:arc>\n{{MS_WIDGET_DIVIDER}}\n<svg width="100%" height="100%" version="1.1" xmlns="http://www.w3.org/2000/svg">\n  <path \n    ms-attr-d="arc" \n    ms-attr-stroke="color" \n    ms-attr-stroke-width="radius" \n    ms-attr-transform="\'rotate(0 \' + spinPoint +\')\'"\n    stroke-linejoin="round" fill="none">\n      <animateTransform attributeName="transform" repeatCount="indefinite" attributeType="XML" type="rotate" begin="0s" \n        ms-attr-from="0 + \' \' + spinPoint" \n        ms-attr-to="360 + \' \' + spinPoint" \n        ms-attr-dur="svgDur" />\n    </path>\n  <path stroke-linejoin="round" \n    ms-attr-d="circle" \n    ms-attr-stroke-width="radius" \n    ms-attr-stroke="color" \n    ms-css-opacity="opacity" \n    fill="none"></path>\n  </svg>\n{{MS_WIDGET_TYPE}}\n{{MS_WIDGET_SPINNING_SPIN}}\n<v:arc stroked="true" filled="F" \n    ms-attr-strokecolor="color" \n    ms-attr-strokeweight="radius+\'px\'" \n    style="position:absolute;z-index:3;text-indent:-1000px;overflow:hidden;left:0;top:0;" \n    ms-attr-startangle="item.startangle" \n    ms-attr-endangle="item.endangle" \n    ms-css-opacity="opacities[$index]" \n    ms-css-height="width+\'px\'" \n    ms-css-width="width+\'px\'" \n    ms-repeat-item="data">\n  </v:arc>\n{{MS_WIDGET_DIVIDER}}\n<svg width="100%" height="100%" version="1.1" xmlns="http://www.w3.org/2000/svg">\n  <path \n    ms-attr-d="arc" \n    ms-attr-stroke="color" \n    ms-attr-stroke-width="radius" \n    ms-attr-transform="item.rotate" \n    ms-repeat-item="data" \n    ms-css-opacity="opacities[$index]" \n    stroke-linejoin="round" fill="none">\n      <animate ms-if="0" attributeName="opacity" from="1" to=".2" repeatCount="indefinite" \n               ms-attr-dur="svgDur" \n               ms-attr-begin="item.begin"/>\n    </path>\n  </svg>\n{{MS_WIDGET_TYPE}}\n{{MS_WIDGET_SPOKES}}\n<v:rect style="position:absolute;" stroked="false" \n        ms-attr-fillcolor="color" \n        ms-css-left="item.spokesLeft+\'px\'" \n        ms-css-top="item.spokesTop+\'px\'"\n        ms-css-width="spokesWidth+\'px\'" \n        ms-css-height="spokesHeight+\'px\'" \n        ms-css-rotation="item.spokesRotation" \n        ms-repeat-item="data">\n        <v:fill \n                ms-attr-color="color"></v:fill>\n  </v:rect>\n{{MS_WIDGET_DIVIDER}}\n<svg width="100%" height="100%" version="1.1" xmlns="http://www.w3.org/2000/svg">\n  <path opacity=".1" ms-attr-d="svgPath" \n      ms-attr-transform="data[$index].rotate" \n        ms-repeat="data" \n    ms-attr-fill="color">\n    <animate attributeName="opacity" from="1" to=".1" repeatCount="indefinite" \n             ms-attr-dur="svgDur" \n             ms-attr-begin="data[$index].begin"/></path>\n  </svg>\n{{MS_WIDGET_TYPE}}\n{{MS_WIDGET_IMG}}\n<img width="100%" height="100%" ms-attr-src="src">';n.exports=function(){function f(e,t,n,r){t["drawer"]=n;t["effect"]=r;a[e]=t}function l(e){return document.getElementById(e)}function c(e,t,n){var r=[],i=n||36,e=e-t,s,o,u,a;for(var f=0;f<=i;f++){s=Math.PI/2-Math.PI*2/i*f;o=Math.cos(s)*e+e*1+t*1;u=(1-Math.sin(s).toFixed(4))*e+t*1;a=(f?" L":"M")+o+" "+u+(f==100?"Z":"");r.push(a)}return r}var e=0,t=navigator.userAgent.match(/msie/gi)||"ActiveXObject"in window,n=99999-Math.random()*1e4>>0,r={},u=o.split("{{MS_WIDGET_TYPE}}"),a={};i.each(u,function(e,t){var n,t=t.trim().replace(/^\{\{MS_WIDGET_[^\}]+\}\}/g,function(e){n=e.replace(/\{\{MS_WIDGET_|\}\}/g,"").replace(/_/g,"-").toLowerCase();return""});if(n){n=n;t=t.split("{{MS_WIDGET_DIVIDER}}");r[n]={svg:t[1]||t[0],vml:t[0]}}});f("ball",{width:32,widthInner:28,count:10,interval:120,circleMargin:1,svgDur:"1s"},function(e){var t=e.type,n=e.count,r=e.width,i=r/2,s=e.interval,o=(r-e.widthInner)/2;if(t==="ball")e.svgDur=s*n/1e3+"s";return function(t){var r=Math.PI*(.5-2*t/n);e.data.push({x:(i-o)*(Math.cos(r)+1),y:(o-i)*(Math.sin(r)-1),r:o,begin:[s*t/1e3,"s"].join("")});e.opacities.push((t/n).toFixed(2))}},function(e,n,r,s){if(!t&&e.type!=="ticks"&&e.type!="spinning-spin")return;var r=Array.isArray(r)?r:["circle","oval"],o=e.svgSupport?r[0]:r[1],n=n.getElementsByTagName(o),u=n.length,a=u,f=[],l;i.each(n,function(t,n){f.push(i(n));if(t===u-1&&!e.svgSupport){n.style.display="none";n.style.display="block"}});if(e.type==="ticks"){a=0;return function(){for(var t=0;t<u;t++){var n=t>a?e.opacities[1]:e.opacities[0];if(f[t]){f[t].css("visibility",n>=1?"visible":"hidden")}}a++;if(a>=u){a=-1}}}return function(){a--;if(a<0){a=u-1}for(var t=0;t<u;t++){if(s){s(f[t],t,a)}else{var n=e.opacities[(t+a)%u]*100/100;f[t]&&f[t].css("opacity",n)}}}});f("ticks",i.mix({},a["ball"],{count:3,height:20,interval:360}),function(e){var t=e.count,n=2+e.circleMargin,r=(e.width-e.widthInner)/2,i=(e.width-r*(3*t-1))/2;return function(t){e.data.push({x:i+t*n*r,y:e.height/2-r,r:r,begin:[e.interval*t/1e3,"s"].join("")});e.opacities.push(t?0:1)}},a["ball"].effect);r["ticks"]=r["ball"];f("spin",{width:32,widthInner:26,angel:90,arc:"",circle:"",radius:"",opacity:.2,startangle:0,endangle:0,interval:36,$circleData:"",$partsData:"",spinPoint:"23 23",svgDur:"1s",data:[1]},function(e){e.radius=e.width/2-e.widthInner/2;if(e.svgSupport){e.svgDur=e.interval*36/1e3+"s";e.spinPoint=[e.width/2,e.width/2].join(" ");var t=e.$circleData=c(e.width/2,e.width/2-e.widthInner/2),n=e.$partsData=t.slice(0,Math.floor(e.angel/360*(t.length-1)));e.arc=n.join("");e.circle=t.join("")}else{e.startangle=0;e.endangle=e.angel}},function(e,n){if(!t)return;var r=stepper=e.angel;if(e.svgSupport){var s=e.$circleData.length,n=i(n.getElementsByTagName("path")[0]);r=stepper=Math.floor(e.angel/360*s);return function(){stepper+=1;if(stepper>=s)stepper=0;n.attr("transform","rotate("+stepper*10+" "+e.spinPoint+")")}}return function(){stepper+=10;var t=stepper-r;if(stepper>360){stepper=stepper-360;t=t-360}e.startangle=t;e.endangle=stepper}});f("spokes",{count:8,width:32,spokesWidth:4,spokesHeight:8,interval:125,svgPath:"M14 0 H18 V8 H14 z",svgDur:"1s"},function(e){var t=e.count,n=e.width,r=e.spokesWidth,i=e.spokesHeight,s=0,o=e.interval;if(e.svgSupport){e.svgPath=["M",(n-r)/2," 0 H",(n+r)/2," V",i," H",(n-r)/2," z"].join("");e.svgDur=o*t/1e3+"s";var u=360/t;return function(r){e.data.push({begin:[o*r/1e3,"s"].join(""),rotate:["rotate(",r*u," ",[n/2,n/2].join(" ")+")"].join("")});e.opacities.push((r/t).toFixed(2))}}var u=Math.PI*2/t,a,f=r/2;return function(i){a=Math.PI/2-u*i;var s=Math.sin(a),o=Math.cos(a),f=(i/t).toFixed(2);e.data.push({spokesRotation:360*i/t,spokesOpacity:f*50,spokesLeft:(n/2-r)*(1+o),spokesTop:(n/2-r)*(1-s)});e.opacities.push(f)}},function(e,t){return a["ball"].effect(e,t,["path","rect"])});f("spinning-bubbles",i.mix({},a["ball"],{width:64,widthInner:54,$zooms:[]}),function(e){var t=a["ball"].drawer(e),n=e.count;if(n>=7){e.$zooms=[.2,.4,.8,1,.8,.4,.2]}else if(n>=5){e.$zooms=[.2,.8,1,.8,.2]}else{e.$zooms=[1,.1,.1,.1]}while(e.$zooms.length<e.count){e.$zooms.push(.1)}return function(e){t(e)}},function(e,t){var n=(e.width-e.widthInner)/2,r=e.count;if(e.svgSupport)return a["ball"].effect(e,t,["circle","oval"],function(t,i,s){t.attr("r",n*e.$zooms[(i+s)%r])});return a["ball"].effect(e,t,["circle","oval"],function(t,n,r){t.css("zoom",e.$zooms[(n+r)%e.count])})});f("bubbles",i.mix({},a["spinning-bubbles"],{height:30,widthInner:50,count:3,interval:360,circleMargin:.5}),function(e){a["spinning-bubbles"].drawer(e);return a["ticks"].drawer(e)},a["spinning-bubbles"].effect);f("spinning-spin",i.mix({},a["spin"],{opacities:[],data:[],radius:1,interval:a["ball"].interval,count:8,width:46,widthInner:38,padding:5}),function(e){function u(t){var n=(t/i).toFixed(2);n=n>.6?n:.2;e.opacities.push(n)}var t=360/e.padding*3,n=e.width/2,r=c(n,n-e.widthInner/2,t),i=e.count,s=e.interval,o=360/i;e.radius=e.width/2-e.widthInner/2;if(e.svgSupport){e.svgDur=s*i/1e3+"s";e.arc=r.slice(0,Math.floor((1/i-e.padding/360)*r.length)).join("");return function(t){e.data.push({rotate:"rotate("+o*t+" "+n+" "+n+")",begin:[s*t/1e3,"s"].join("")});u(t)}}return function(t){e.data.push({startangle:t/i*360,endangle:(t+1)/i*360-10});u(t)}},function(e,t){return a["ball"].effect(e,t,["path","arc"])});f("img",{src:"https://source.qunarzz.com/piao/images/loading_camel.gif",width:52,height:39,miao:0},void 0,void 0);var h=!!document.createElementNS&&!!document.createElementNS("http://www.w3.org/2000/svg","svg").createSVGRect;var p=i.ui.loading=function(t,o,u){var f=o.loadingOptions;f.template=f.getTemplate(s,f);if(!a[f.type]){f.type="ball"}i.each(a[f.type],function(e,t){if(f[e]===void 0)f[e]=t});var c=i.define(o.loadingId,function(s){s.height="";s.width="";s.data=[];s.opacities=[];i.mix(s,f);s.widgetElement=t;s.svgSupport=h;s.$loadingID=e+""+n;s.$timer="";s.$skipArray=["widgetElement","template","opacities","data"];var o;s.$init=function(e){if(o)return;o=true;var n,s=f.container||c.widgetElement,a=(i.type(s)==="object"&&s.nodeType===1&&document.body.contains(s)?s:document.getElementById(s))||document.body,l=c.type,h=(r[l]||r["ball"])[c.svgSupport?"svg":"vml"],p=0;c.width=c.width==false?c.height:c.width;c.height=c.height==false?c.width:c.height;if(c.drawer){var d=0,v=c.drawer(c);while(d<c.count&&v){v(d);d++}}a.appendChild(i.parseHTML(c.template.replace("{{MS_WIDGET_HTML}}",h).replace("{{MS_WIDGET_ID}}",c.$loadingID)));i.log("avalon请尽快升到1.3.7+");i.scan(a,[c].concat(u));if(typeof f.onInit==="function"){f.onInit.call(t,c,f,u)}c._effect()};s._effect=function(){if(c.toggle){var e=document.getElementById("oni-loading-"+c.$loadingID);if(e){var t=c.effect&&c.effect(c,e);if(t){clearInterval(c.$timer);c.$timer=setInterval(t,c.interval)}}}};s.$remove=function(){clearInterval(c.$timer);t.innerHTML=t.textContent=""};s.showLoading=function(){if(c.toggle)return;c.toggle=true;c._effect()};s.hideLoading=function(){c.toggle=false};s.destroyLoading=function(){c.toggle=false;c.$remove()};s.appendTo=function(e){var t=e||s.widgetElement,n=l("modal"+s.$id),r=l("loading"+s.$id);if(n)t.appendChild(n);if(r)t.appendChild(r)}});c.$watch("toggle",function(e){if(!e){clearInterval(c.$timer)}else{c._effect()}});e++;return c};p.defaults={onInit:i.noop,color:"#619FE8",type:"ball",toggle:true,modal:true,modalOpacity:.1,modalBackground:"#fff",container:void 0,getTemplate:function(e,t,n){return e},$author:"skipper@123"}}()}(t.exports,t,e);e.____MODULES["2f07999ff4151bac4f30b3501573c99f"]=t.exports})(this);(function(e){var t={id:"ca0ba5727fb7bafe48a3959abb62361c",filename:"avalon.pager.js",exports:{}};if(!e.____MODULES){e.____MODULES={}}var n=function(t,n,r){var i=e.____MODULES["2ab11dddd1a66c979fc4d8cb729fc348"],s='<div class="oni-pager" onselectstart="return false;" unselectable="on" ms-visible="!!totalPages">\n    <span class="oni-pager-prev"\n          ms-class="oni-state-disabled:firstPage==1"\n          ms-if="isShowPrev()"\n          ms-attr-title="getTitle(\'prev\')" \n          ms-click="jumpPage($event,\'prev\')" \n          ms-text="prevText"\n          ></span>\n    <span class="oni-pager-item"\n          ms-visible="firstPage!==1" \n          ms-attr-title="getTitle(\'first\', currentPage)" \n          ms-click="jumpPage($event,\'first\')" \n          ms-class-oni-state-active="currentPage == 1"\n          ms-hover="oni-state-hover">1</span>\n    <span class=\'oni-pager-omit\'\n          ms-if="showFirstOmit" \n          ms-text="ellipseText"\n          ></span>\n    <span  class="oni-pager-item" \n           ms-repeat="pages" \n           ms-attr-title="getTitle(el, currentPage)"\n           ms-hover="oni-state-hover"\n           ms-click="jumpPage($event,el)"\n           ms-class-oni-state-active="el == currentPage" \n           ms-text="el"\n           ></span>\n    <span class="oni-pager-omit"\n          ms-if="showLastOmit" \n          ms-text="ellipseText"\n          ></span>\n    <span class="oni-pager-item "\n          ms-visible="lastPage!==totalPages" \n          ms-attr-title="getTitle(\'last\', currentPage, totalPages)" \n          ms-hover="oni-state-hover" \n          ms-click="jumpPage($event,\'last\')"  \n          ms-text="totalPages"\n          ></span>\n    <span class="oni-pager-next"\n          ms-if="isShowNext()" \n          ms-attr-title="getTitle(\'next\')"\n          ms-click="jumpPage($event,\'next\')" \n          ms-class="oni-state-disabled:lastPage==totalPages"\n          ms-text="nextText"\n          ></span>\n    <div class="oni-pager-jump" ms-if="showJumper">\n        <span class="oni-pager-text" ms-html="_getTotalPages(totalPages)"></span>\n        <div class="oni-pager-textbox-wrapper">\n            <input class="oni-pager-textbox" ms-duplex="_currentPage" data-duplex-event="change" ms-keyup="changeCurrentPage">\n        </div>\n        <span class="oni-pager-text">{{regional.pageText}}</span>\n        <button class="oni-pager-button" ms-click="changeCurrentPage" >{{regional.confirmText}}</button>\n    </div>\n</div>\n';n.exports=function(){function t(e,t){var n={};for(var r=0,i=e.length;r<i;r++){var s=e[r];n[s]={action:"del",el:s}}for(var r=0,o=t.length;r<o;r++){var s=t[r];if(n[s]){n[s]={action:"retain",el:s}}else{n[s]={action:"add",el:s}}}var u=[];for(var r in n){u.push({action:n[r].action,el:n[r].el})}u.sort(function(e,t){return e.el-t.el});u.forEach(function(e,t){e.index=t});var a=[];for(var r=0,s;s=u[r++];){switch(s.action){case"add":e.splice(s.index,0,s.el);break;case"del":a.unshift(s);break}}for(var r=0,s;s=a[r++];){e.splice(s.index,1)}}function n(e){var t=e.currentPage,n=Math.ceil(e.totalItems/e.perPages),r=[],i=e.showPages,s=t,o=t;e.totalPages=n;if(n<=i){for(var u=1;u<=n;u++){r.push(u)}}else{r.push(t);while(true){if(r.length>=i){break}if(s>1){r.unshift(--s)}if(r.length>=i){break}if(o<n){r.push(++o)}}}e.firstPage=r[0]||1;e.lastPage=r[r.length-1]||1;e.showFirstOmit=e.firstPage>2;e.showLastOmit=e.lastPage<n-1;return r}var e=i.ui.pager=function(r,o,u){var a=o.pagerOptions;var f=a.options;if(Array.isArray(f)){a.options=f.map(function(e){var t={};switch(typeof e){case"number":case"string":t.value=e;t.text=e;return t;case"object":return e}})}else{a.options=[]}if(u.cb){s=s.replace(/ms-title/g,"ms-attr-title")}a.template=a.getTemplate(s,a);a._currentPage=a.currentPage;var l=i.define(o.pagerId,function(s){i.mix(s,a,{regional:e.defaultRegional});s.widgetElement=r;s.$skipArray=["showPages","widgetElement","template","ellipseText","alwaysShowPrev","alwaysShowNext"];s.$init=function(e){var t=a.template;r.style.display="none";setTimeout(function(){r.innerHTML=t;r.style.display="block";if(e){e()}else{i.log("avalon请尽快升到1.3.7+");i.scan(r,[l].concat(u));if(typeof a.onInit==="function"){a.onInit.call(r,l,a,u)}}},100)};s.$remove=function(){r.innerHTML=r.textContent=""};s.jumpPage=function(e,i){e.preventDefault();if(i!==s.currentPage){switch(i){case"first":s.currentPage=1;break;case"last":s.currentPage=s.totalPages;break;case"next":s.currentPage++;if(s.currentPage>s.totalPages){s.currentPage=s.totalPages}break;case"prev":s.currentPage--;if(s.currentPage<1){s.currentPage=1}break;default:s.currentPage=i;break}if(this.className.indexOf("state-disabled")===-1){s.onJump.call(r,e,s);t(s.pages,n(s))}}};s.$watch("totalItems",function(){t(s.pages,n(s))});s.$watch("perPages",function(e){s.currentPage=1;t(s.pages,n(s))});s.$watch("currentPage",function(e){l._currentPage=e;t(s.pages,n(s))});s.isShowPrev=function(){var e=s.alwaysShowPrev;var t=s.firstPage;return e||t!==1};s.isShowNext=function(){var e=s.alwaysShowNext;var t=s.lastPage;var n=s.totalPages;return e||t!==n};s.changeCurrentPage=function(e,t){if(e.type==="keyup"){t=this.value;if(e.keyCode!==13)return}else{t=l._currentPage}t=parseInt(t,10)||1;if(t>l.totalPages||t<1)return;l.currentPage=t;l.pages=n(l);l.onJump.call(r,e,s)};s.pages=[];s.getPages=n;s.setRegional=function(e){l.regional=e};s._getTotalPages=function(e){var t=l.regional,n=[t.totalText,e];if(e>1){n.push(t.pagesText)}else{n.push(t.pageText)}n=n.concat([" ",t.jumpToText,t.numberText]);return n.join("")};s.getTitle=function(e,t,n){var r=l.regional;switch(e){case"first":if(t==1){return r.currentText}return r.jumpToText+" "+r.firstText;case"prev":return r.jumpToText+" "+r.prevText;case"next":return r.jumpToText+" "+r.nextText;case"last":if(t==n){return r.currentText}return r.jumpToText+" "+r.lastText;default:if(e===t){return r.currentText}return r.jumpToText+r.numberText+" "+e+r.pageText}}});l.pages=n(l);return l};e.regional=[];e.regional["zh-CN"]={prevText:"上一页",nextText:"下一页",confirmText:"确定",totalText:"共",pagesText:"页",pageText:"页",toText:"到",jumpToText:"跳转到",currentText:"当前页",firstText:"第一页",lastText:"最后一页",numberText:"第"};e.defaultRegional=e.regional["zh-CN"];e.defaults={perPages:10,showPages:10,currentPage:1,_currentPage:1,totalItems:200,totalPages:0,pages:[],nextText:">",prevText:"<",ellipseText:"…",firstPage:0,lastPage:0,alwaysShowNext:false,alwaysShowPrev:false,showFirstOmit:false,showLastOmit:false,showJumper:false,getTemplate:function(e,t){return e},options:[],onJump:function(e,t){}};return i}()}(t.exports,t,e);e.____MODULES["ca0ba5727fb7bafe48a3959abb62361c"]=t.exports})(this);(function(e){var t={id:"af1787d0319534d10e2ca9dfe2e69cc1",filename:"avalon.scrollbar.js",exports:{}};if(!e.____MODULES){e.____MODULES={}}var n=function(t,n,r){var i=e.____MODULES["2ab11dddd1a66c979fc4d8cb729fc348"],s='<div ms-repeat-pos="_position" class="oni-scrollbar oni-helper-reset oni-helper-clearfix oni-widget"\n     ms-visible="!disabled"\n	 ms-class-100="oni-scrollbar-{{pos}}" \n	 ms-class-101="oni-scrollbar-{{size}} oni-scrollbar-{{pos}}-{{size}}" \n	 ms-class-102="oni-state-disabled:disabled" \n	 ms-mouseenter="_show($event, \'always\', $index)" \n	 ms-visible="toggle">\n	<div ms-if="showBarHeader" class="oni-scrollbar-arrow oni-scrollbar-arrow-up" \n	 ms-click="_arrClick($event, \'up\', pos, $index)" \n	 ms-mousedown="_arrDown($event,\'up\', pos, $index)" \n	 ms-class-100="oni-state-disabled:disabled" \n	 ms-mouseup="_arrDown($event,\'up\', pos, $index,\'release\')" \n	 ms-hover="oni-state-hover oni-scrollbar-arrow-hover"><b class="oni-scrollbar-trangle  oni-scrollbar-trangle-up"></b></div>\n	<div class="oni-scrollbar-draggerpar" ms-click="_barClick($event, pos, $index)">\n		<div class="oni-scrollbar-dragger"\n		ms-attr-data-draggable-axis="pos == \'left\' || pos == \'right\' ? \'y\' : \'x\'" \n		ms-click="_stopPropagation($event)" \n		ms-class-100="oni-state-disabled:disabled" \n		ms-mouseover="_show($event,\'always\',$index)" \n		ms-mousedown="_draggerDown($event, true)" \n		ms-mouseup="_draggerDown($event, false)" \n		ms-mouseout="_draggerDown($event, false)" \n		ms-hover="oni-state-hover"\n		>{{draggerHTML | html}}</div>\n	</div>\n	<div ms-if="showBarHeader" class="oni-scrollbar-arrow oni-scrollbar-arrow-down"\n	 ms-click="_arrClick($event, \'down\', pos, $index)"\n	 ms-mousedown="_arrDown($event,\'down\', pos, $index)" \n	 ms-mouseup="_arrDown($event,\'down\', pos, $index,\'release\')" \n	 ms-class-100="oni-state-disabled:disabled" \n	 ms-hover="oni-state-hover"><b class="oni-scrollbar-trangle oni-scrollbar-trangle-down"></b></div>\n</div>';e.____MODULES["36e422bfb7dcb2fd648a019317e8a224"];n.exports=function(){function e(e,t){var t=t||document.body;if(t.getElementsByClassName){return t.getElementsByClassName(e)}else{var n=t.getElementsByTagName("*"),r=[];i.each(n,function(t,n){var s=i(n);if(s.hasClass(e))r.push(n)});return r}}function t(e){return Math.round(parseFloat(e))||0}var n,r=[],o=[];var u=i.ui.scrollbar=function(u,a,f){var l=a.scrollbarOptions;l.template=l.getTemplate(s,l);var c=i.define(a.scrollbarId,function(s){i.mix(s,l);s.widgetElement=u;s.draggerHeight=s.draggerWidth="";s.inFocuse=false;s._position=[];s.viewElement=u;s.dragging=false;var a,h=[],p;s.$init=function(e){if(a)return;a=true;c.widgetElement.style.position="relative";c.viewElement=c.widgetElement==document.body?document.getElementsByTagName("html")[0]:c.widgetElement;c.viewElement.style.overflow=c.viewElement.style.overflowX=c.viewElement.style.overflowY="hidden";if(c.widgetElement==document.body)c.widgetElement.style.overflow=c.widgetElement.style.overflowX=c.widgetElement.style.overflowY="hidden";c._position=c.position.split(",");var s=i.parseHTML(l.template);c.widgetElement.appendChild(s);if(e){e()}else{i.log("avalon请尽快升到1.3.7+");i.scan(u,[c].concat(f));if(typeof l.onInit==="function"){l.onInit.call(u,c,l,f)}}var d=c.widgetElement.childNodes;i.each(d,function(e,t){var n=i(t);if(n.hasClass("oni-scrollbar")||n.hasClass("ui-scrollbar")){h.push(n)}else if(n.hasClass("oni-scrollbar-scroller")||n.hasClass("ui-scrollbar-scroller")){p=n}});if(c.position.match(/left|right/g)){var v=[],m=[];i.each(c._position,function(e,t){if(t.match(/left|right/g)){v.push([e,t])}else{m.push([e,t])}});function g(e,t,n,r){i.each(t,function(t,i){if(!h[t].data("oni-scrollbar-needed"))return;c._computer(r||function(t){return c._clickComputer(t,e)},i[0],i[1],function(e){if(!e)n.preventDefault()},"breakOutCallbackCannotIgnore")})}function y(e){if(c.disabled)return;if(c.inFocuse){g(e.wheelDelta>0?"up":"down",v,e)}}function b(e){if(c.disabled)return;var n=e.keyCode;if(n>32&&n<41&c.inFocuse){if(n in{37:1,39:1,38:1,40:1}){g(n in{37:1,38:1}?"up":"down",n in{38:1,40:1}?v:m,e)}else{var r=n in{33:1,36:1}?"up":"down";g(r,v,e,function(i){var s=p[0].scrollTop;if(n in{33:1,36:1}){if(s)e.preventDefault()}else{if(s<i.scrollerH-i.viewH)e.preventDefault()}if(n in{36:1,35:1}){return{x:0,y:n==36?0:i.draggerparHeight-i.draggerHeight+100}}else{var o=(i.draggerparHeight-i.draggerHeight)*i.viewH/(i.scrollerH-i.viewH);return c._clickComputer(i,r,t(o)||1)}})}}}if(c.widgetElement==document.body){c.inFocuse=true;r.push(y);o.push(b)}else{i.bind(u,"mouseenter",function(e){c.inFocuse=true;r.push(y);o.push(b)});i.bind(u,"mouseleave",function(e){c.inFocuse=false;for(var t=0,n=r.length;t<n;t++){if(r[t]===y){r.splice(t,1);o.splice(t,1);break}}})}if(!n){n=true;i.bind(document,"mousewheel",function(e){var t=r[r.length-1];t&&t(e)});i.bind(document,"keydown",function(e){var t=o[o.length-1];t&&t(e)})}}i.bind(u,"mouseenter",function(){i.each(h,function(e,t){c._show("e",false,t)})});i.bind(u,"mouseleave",function(){c._hide()});c.update("init")};s.$draggableOpts={beforeStart:function(){c.dragging=true},drag:function(e,n){var r=i(n.element);c._computer(function(e){var n={x:t(r.css("left"))>>0,y:t(r.css("top"))>>0};if(n.x==e.draggerparWidth-e.draggerWidth)n.x+=100;if(n.y==e.draggerparHeight-e.draggerHeight)n.y+=100;return n},r.attr("oni-scrollbar-index"),r.attr("oni-scrollbar-pos"))},handle:function(e,t){return!c.disabled&&this},containment:"parent"};s.$draggableOpts.stop=function(e,t){c.$draggableOpts.drag(e,t);c.dragging=false;i(t.element).removeClass("oni-state-active")};s.$remove=function(){i.each(h,function(e,t){t[0]&&t[0].parentNode&&t[0].parentNode.removeChild(t[0])})};s._onScroll=function(){if(c.show!="scrolling")return;i.each(h,function(e,t){c._show("e",false,t)})};s._show=function(e,t,n){if(c.show!="scrolling")return;e.stopPropagation&&e.stopPropagation();var r=n.css?n:h[n];if(r){clearTimeout(r.data("oni-scrollbar-hidetimer"));r.css("visibility","visible");r.css("opacity",1);if(!t){r.data("oni-scrollbar-hidetimer",setTimeout(function(){r.css("opacity",0)},1e3))}}};s._hide=function(e,t){if(c.show!="scrolling")return;if(t&&h[t]){h[t].css("opacity",0)}else{i.each(h,function(e,t){t.css("opacity",0)})}};s.getBars=function(){return h};s.getScroller=function(){return p};s.update=function(n,r,s){if(c.disabled)return;var o=i(c.viewElement),u,a,f=c.widgetElement===document.body?c.viewElement.clientHeight:t(o.css("height")),l=t(o.css("width")),d=c.viewHeightGetter(o),v=c.viewWidthGetter(o),m=c.position,g,y={},s=s==void 0?c.scrollTop:s,r=r==void 0?c.scrollLeft:r;if(c.viewElement!=c.widgetElement){m.match(/right|left/g)&&i(c.widgetElement).css("height",f)}var b=p.width()-p.innerWidth(),w=p.height()-p.innerHeight();p.css("height",d+w);p.css("width",v+b);u=p[0].scrollWidth;a=p[0].scrollHeight;g={top:m.match(/top/g)&&u>v,right:m.match(/right/g)&&a>d,bottom:m.match(/bottom/g)&&u>v,left:m.match(/left/g)&&a>d};if(h.length>1){var E=["top","right","bottom","left"];for(var S=0;S<4;S++){y[E[S]]=[(g[S?E[S-1]:E[3]]&&1)>>0,(g[S<3?E[S+1]:E[0]]&&1)>>0];if(S>1)y[E[S]]=y[E[S]].reverse()}}d=p.innerHeight();v=p.innerWidth();i.each(c._position,function(o,m){var E=h[o],S=m.match(/left|right/),T;if(E){T=i(e("oni-scrollbar-dragger",E.element)[0])}if(n&&T){T.attr("ms-draggable","$,$draggableOpts");T.attr("oni-scrollbar-pos",m);T.attr("oni-scrollbar-index",o);i.scan(T[0],c)}if(!g[m]){if(E){E.css("opacity",0);E.css("visibility","hidden");E.data("oni-scrollbar-needed",false)}return}else{if(E){E.data("oni-scrollbar-needed",true);E.css("visibility","visible");if(c.show=="scrolling"||c.show=="never"){E.css("opacity",0)}else{E.css("opacity",1)}}}if(E){var N=t(E.css("height")),C=t(E.css("width")),k=N,L=C,A=i(e("oni-scrollbar-draggerpar",E[0])[0]),O=c.showBarHeader?2:0;var M=[];if(h.length>1){var _=[],D=y[m];if(S){_=[["top",D[0]*L],["height",f-L*(D[0]+D[1])]];M=[["top",O/2*L],["height",f-L*(D[0]+D[1]+O)]]}else{_=[["left",D[0]*k],["width",l-k*(D[0]+D[1])]];M=[["left",O/2*k],["width",l-k*(O+D[0]+D[1])]]}i.each(_,function(e,t){E.css.apply(E,t)});k=E.height();L=E.width()}else{if(S){M=[["top",L],["height",f-L*2]]}else{M=[["left",k],["width",l-k*2]]}}var P;if(S){P=c.show=="always"?L:0;p.css("width",v+b-P)}else{P=c.show=="always"?k:0;p.css("height",d+w-P)}i.each(M,function(e,t){A.css.apply(A,t)});N=k-O*L;C=L-O*k;var H;if(S){var B=s,j=t(d*N/a);j=c.limitRateV*L>j&&c.limitRateV*L||j;B=B<0?0:B;B=B>a-d?a-d:B;B=t((N-j)*B/(a-d));B=Math.min(N-j,B);H=[["width","100%"],["height",j],["top",B]];s=s>0?s>a-d+P?a-d+P:s:0}else{var F=r,I=t(v*C/u);I=c.limitRateH*k>I&&c.limitRateH*k||I;F=F<0?0:F;F=F>u-v?u-v:F;F=t((C-I)*F/(u-v));F=Math.min(C-I,F);H=[["height","100%"],["width",I],["left",F]];r=r>0?r>u-v+P?u-v+P:r:0}i.each(H,function(e,t){T.css.apply(T,t)});if(n){if(S){c._scrollTo(void 0,s)}else{c._scrollTo(r,void 0)}}if(c.showBarHeader){if(s==0&&S||!S&&r==0){i(e("oni-scrollbar-arrow-up",E[0])[0]).addClass("oni-state-disabled")}else{i(e("oni-scrollbar-arrow-up",E[0])[0]).removeClass("oni-state-disabled")}if(s>=A.innerHeight()-T.innerHeight()&&S||!S&&r>=A.innerWidth()-T.innerWidth()){!c.breakOutCallback&&i(e("oni-scrollbar-arrow-down",E[0])[0]).addClass("oni-state-disabled")}else{i(e("oni-scrollbar-arrow-down",E[0])[0]).removeClass("oni-state-disabled")}}}})};s._arrClick=function(e,t,n,r){if(c.disabled)return;c._computer(function(e){return c._clickComputer(e,t)},r,n)};s._clickComputer=function(e,n,r){var r=r||e.step||40,i=t(e.dragger.css("left"))>>0,s=t(e.dragger.css("top"))>>0,o=n=="down"?i+r:i-r,u=n=="down"?s+r:s-r;return{x:o,y:u}};s._arrDown=function(e,t,n,r,s){if(c.disabled)return;var o=this,u=i(o);clearInterval(u.data("mousedownTimer"));clearTimeout(u.data("setTimer"));var a=h[r];if(s||u.hasClass("oni-state-disabled")){return u.removeClass("oni-state-active")}u.data("setTimer",setTimeout(function(){u.addClass("oni-state-active");u.data("mousedownTimer",setInterval(function(){return c._computer(function(e){return c._clickComputer(e,t)},r,n,function(e){if(!e)return;clearInterval(u.data("mousedownTimer"));clearTimeout(u.data("setTimer"))})},120))},10))};s._barClick=function(e,t,n){if(c.disabled)return;var r=i(this);if(r.hasClass("oni-scrollbar-dragger"))return;c._computer(function(t){return{x:Math.ceil(e.pageX-t.offset.left-t.draggerWidth/2),y:Math.ceil(e.pageY-t.offset.top-t.draggerHeight/2)}},n,t)};s._computer=function(n,r,s,o,u){if(c.disabled)return;var a=h[r];if(a&&a.data("oni-scrollbar-needed")){var f={},l=s.match(/left|right/g);f.dragger=i(e("oni-scrollbar-dragger",a[0])[0]);f.draggerWidth=t(f.dragger.css("width"));f.draggerHeight=t(f.dragger.css("height"));f.draggerpar=i(f.dragger[0].parentNode);f.draggerparWidth=t(f.draggerpar.css("width"));f.draggerparHeight=t(f.draggerpar.css("height"));f.offset=f.draggerpar.offset();f.up=i(e("oni-scrollbar-arrow-up",a[0])[0]);f.down=i(e("oni-scrollbar-arrow-down",a[0])[0]);f.viewer=i(c.viewElement);f.viewH=p.innerHeight();f.viewW=p.innerWidth();f.scrollerH=p[0].scrollHeight;f.scrollerW=p[0].scrollWidth;f.step=l?40*(f.draggerparHeight-f.draggerHeight)/(f.scrollerH-f.viewH):40*(f.draggerparWidth-f.draggerWidth)/(f.scrollerW-f.viewW);f.step=t(f.step)||1;var d=n(f),v;d.x=t(d.x);d.y=t(d.y);if(l){if(d.y<0){d.y=0;f.up.addClass("oni-state-disabled");v=["v","up"]}else{f.up.removeClass("oni-state-disabled")}if(d.y>f.draggerparHeight-f.draggerHeight){d.y=f.draggerparHeight-f.draggerHeight;v=["v","down"];f.down.addClass("oni-state-disabled")}else{f.down.removeClass("oni-state-disabled")}var m=t((f.scrollerH-f.viewH)*d.y/(f.draggerparHeight-f.draggerHeight))-c.scrollTop;f.dragger.css("top",d.y);c._scrollTo(void 0,t((f.scrollerH-f.viewH)*d.y/(f.draggerparHeight-f.draggerHeight)))}else{if(d.x<0){d.x=0;v=["h","up"];f.up.addClass("oni-state-disabled")}else{f.up.removeClass("oni-state-disabled")}if(d.x>f.draggerparWidth-f.draggerWidth){d.x=f.draggerparWidth-f.draggerWidth;v=["h","down"];!c.breakOutCallback&&f.down.addClass("oni-state-disabled")}else{f.down.removeClass("oni-state-disabled")}f.dragger.css("left",d.x);c._scrollTo(t((f.scrollerW-f.viewW)*d.x/(f.draggerparWidth-f.draggerWidth)),void 0)}}(!c.breakOutCallback||u)&&o&&o(v);c.breakOutCallback&&c.breakOutCallback(v,c,f)};s._scrollTo=function(e,t){if(t!=void 0){p[0].scrollTop=t;c.scrollTop=p[0].scrollTop}if(e!=void 0){p[0].scrollLeft=e;c.scrollLeft=p[0].scrollLeft}};s.scrollTo=function(e,t){c.update(!"ifInit",e,t);s._scrollTo(e,t)};s._initWheel=function(e,t){if(t=="enter"){c.inFocuse=true}else{c.inFocuse=false}};s._draggerDown=function(e,t){if(c.disabled)return;var n=i(this);if(t){n.addClass("oni-state-active")}else{n.removeClass("oni-state-active")}};s._stopPropagation=function(e){e.stopPropagation()}});c.$watch("scrollLeft",function(e,t){c._onScroll();c.onScroll&&c.onScroll(e,t,"h",c)});c.$watch("scrollTop",function(e,t){c._onScroll();c.onScroll&&c.onScroll(e,t,"v",c)});return c};u.defaults={disabled:false,toggle:true,position:"right",limitRateV:1.5,limitRateH:1.5,scrollTop:0,scrollLeft:0,show:"always",showBarHeader:true,draggerHTML:"",breakOutCallback:false,onInit:i.noop,viewHeightGetter:function(e){return e.innerHeight()},viewWidthGetter:function(e){return e.innerWidth()},getTemplate:function(e,t){return e},onScroll:function(e,t,n,r){},size:"normal",$author:"skipper@123"}}()}(t.exports,t,e);e.____MODULES["af1787d0319534d10e2ca9dfe2e69cc1"]=t.exports})(this);(function(e){var t={id:"98a5cfa106f8b10f565f3806beac70e3",filename:"avalon.dropdown.js",exports:{}};if(!e.____MODULES){e.____MODULES={}}var n=function(t,n,r){var i=e.____MODULES["2ab11dddd1a66c979fc4d8cb729fc348"],s='<div class="oni-dropdown"\n     ms-class="oni-state-disabled:!enable"\n     ms-class-1="{{titleClass}}"\n     ms-css-width="{{width}}"\n     ms-class-2="oni-state-focus: focusClass"\n     ms-hover="oni-state-hover"\n     ms-keydown="_keydown"\n     tabindex="0">\n    <div class="oni-dropdown-source">\n        <div class="oni-dropdown-input"\n             ms-title="title"\n             ms-css-width="titleWidth"\n             id="title-MS_OPTION_ID">{{label|sanitize|html}}</div>\n        <div class="oni-dropdown-icon-wrap">\n            <i class="oni-dropdown-icon oni-icon oni-icon-angle-up"\n               ms-visible="toggle">&#xf028;</i>\n            <i class="oni-dropdown-icon oni-icon oni-icon-angle-down"\n               ms-visible="!toggle">&#xf032;</i>\n        </div>\n    </div>\n</div>\nMS_OPTION_TEMPLATE\n<div class="oni-dropdown"\n     ms-class="oni-dropdown-menu:!multiple"\n     ms-class-1="{{listClass}}"\n     ms-css-width="{{listWidth}}"\n     ms-mouseenter="_listenter"\n     ms-mouseleave="_listleave"\n     ms-visible="toggle||multiple">\n    <div class="oni-dropdown-menu-inner"\n         ms-css-width="menuWidth"\n         ms-css-height="menuHeight"\n         ms-widget="scrollbar,scrollbar-MS_OPTION_ID" id="menu-MS_OPTION_ID">\n        <div class="oni-scrollbar-scroller"\n             id="list-MS_OPTION_ID">\n            <div ms-repeat="data" class="oni-dropdown-item"\n                 ms-click-12="_select($index, $event)"\n                 ms-title="el.title||el.label"\n                 ms-visible="el.toggle"\n                 ms-hover="oni-state-hover: el.enable"\n                 ms-class-1="oni-state-disabled:!el.enable"\n                 ms-class-2="oni-state-active:isActive(el, multipleChange)"\n                 ms-class-4="oni-dropdown-group:el.group"\n                 ms-class-5="oni-dropdown-divider:el.group && !$first"\n                 data-repeat-rendered="repeatRendered"\n                 >{{el.label|sanitize|html}}</div>\n        </div>\n    </div>\n</div>\n';e.____MODULES["fdc46f922d9abc8918e08dbf90d9d03e"];e.____MODULES["af1787d0319534d10e2ca9dfe2e69cc1"];n.exports=function(){function r(e){try{e=e==="true"?true:e==="false"?false:e==="null"?null:+e+""===e?+e:e}catch(t){}return e}function o(e,t,n){var r=t||[];n=n||null;for(var i=0,s;s=e[i++];){if(Array.isArray(s.options)){r.push({label:s.label,value:s.value,enable:a(s.enable,true),group:true,parent:n,toggle:true});o(s.options,r,s)}else{if(typeof s==="string"){s={label:s,value:s,title:s}}r.push({label:s.label,value:s.value,title:s.title,enable:a(n&&n.enable,true)&&a(s.enable,true),group:false,parent:n,data:s,toggle:true})}}return r}function u(e){var t=document.createDocumentFragment(),n,r;for(var i=0,s;s=e[i++];){if(s.group){r=document.createElement("optgroup");r.label=s.label;r.disabled=!s.enable;t.appendChild(r);n=r}else{r=document.createElement("option");r.text=s.label;r.value=s.value;r.disabled=!s.enable;if(s.parent&&n){n.appendChild(r)}else{t.appendChild(r)}}}return t}function a(e,t){return typeof e==="boolean"?e:t}function f(e,t,n){var i=t||[];var s=e.children;n=n||null;for(var o=0,u;u=s[o++];){if(u.nodeType===1){if(u.tagName==="OPTGROUP"){n={label:u.label,value:"",enable:!u.disabled,group:true,parent:false,toggle:true};i.push(n);f(u,i,n)}else if(u.tagName==="OPTION"){i.push({label:u.label.trim()||u.text.trim()||u.value.trim(),title:u.title.trim(),value:r(u.value.trim()||u.text.trim()),enable:a(n&&n.enable,true)&&!u.disabled,group:false,parent:n,toggle:true})}}}return i}function l(e,t,n){var r=e.size(),i=[],s=[],o={},u,a;for(u=0;u<t;u++){o=e[u];if(o.enable&&!o.group&&o.toggle){i.push(u)}}for(u=t+1;u<r;u++){o=e[u];if(o.enable&&!o.group&&o.toggle){s.push(u)}}if(i.length===0&&s.length===0){a=null}else if(n){a=s.length>0?s.shift():i.shift()}else{a=i.length>0?i.pop():s.pop()}return a}function h(e){var t=[];for(;e;e=e.nextSibling){if(e.nodeType===1){t.push(e)}}return t}var e=/^(\d+).*$/;var t=!-[1]&&!window.XMLHttpRequest;var n=i.ui.dropdown=function(n,a,p){function _(){i.each(n.getElementsByTagName("option"),function(e,t){if(M.value.$model.indexOf(t.value)>-1||M.value.$model.indexOf(r(t.value))>-1){try{t.selected=true}catch(n){i(t).attr("selected","selected")}}else{try{t.selected=false}catch(n){t.removeAttribute("selected")}}})}function D(e){var t=(n.msData["ms-duplex"]||"").trim();var s;if(t&&(s=i.getModel(t,p))){e.value=s[1][s[0]];e.$hasDuplex=true}else if(!g){if(!Array.isArray(e.value)){e.value=[e.value||""]}}else{var o=[];Array.prototype.forEach.call(n.options,function(e){if(e.selected){o.push(r(e.value))}});e.value=o}if(!e.multiple){if(Array.isArray(e.value)){e.value=e.value[0]!==void 0?e.value[0]:""}var u=e.data.filter(function(t){return t.value===e.value&&!t.group}),a=e.data.filter(function(e){return!e.group});if(u.length===0&&a.length>0){e.value=a[0].value;if(s){s[1][s[0]]=e.value}}}var f=d.attr("data-duplex-changed"),l;if(f&&(l=i.getModel(f,p))){e.changedCallback=l[1][l[0]]}e.duplexName=t;var c=document.body,h=e.container;e.container=(i.type(h)==="object"&&h.nodeType===1&&c.contains(h)?h:document.getElementById(h))||c}function P(){return i.parseHTML(S)}function H(e){var t=M.data.$model.filter(function(t){return t.value===e});t=t.length>0?t[0]:null;if(!t){i.log("[log] avalon.dropdown 设置label出错")}else{M.label=t.label;M.title=t.title||t.label||""}return t}function B(){var t=document.getElementById("title-"+M.$id),n=i(t);return M.width-n.css("paddingLeft").replace(e,"$1")-n.css("paddingRight").replace(e,"$1")}function j(){if(!M.multiple&&O){M._position()}}var d=i(n),v=n.parentNode,m=a.dropdownOptions,g=true,y,b,w,E,S,x,T,N,C=false;"multiple,size".replace(i.rword,function(e){if(c(n,e)){m[e]=n[e]}});m.enable=!n.disabled;w=m.template=m.getTemplate(s,m).replace(/MS_OPTION_ID/g,a.dropdownId).split("MS_OPTION_TEMPLATE");E=w[0];S=w[1];y=m.data.$model||m.data;n.removeAttribute("ms-duplex");i.scan(n,p);b=f(n);g=!!b.length;if(b.length===0){b=o(y)}m.data=b;i(n).css("display","none");D(m);for(var k=0,L=b.length;k<L;k++){if(b[k].value==m.value){m.activeIndex=k;m.currentOption=b[k];break}}var A,O;var M=i.define(a.dropdownId,function(r){i.mix(r,m);r.$skipArray=["widgetElement","duplexName","menuNode","dropdownNode","scrollWidget"];if(r.multiple&&r.$hasDuplex&&r.$skipArray.indexOf("value")===-1){r.$skipArray.push("value")}r.render=function(e){if(e===void 0){return}M.data=o(e.$model||e);if(M.toggle){M._styleFix(true)}};r.widgetElement=n;r.menuWidth="auto";r.menuHeight=r.height;r.dataSource=y;r.focusClass=false;r.$init=function(e){if(M.multiple){O=P();var t=O.firstChild;v.insertBefore(O,n);t.appendChild(n)}else{var r;A=i.parseHTML(E);r=A.firstChild;v.insertBefore(A,n);r.appendChild(n);A=r;M.titleWidth=B();H(M.value);x=i.bind(document.body,"click",function(e){if(A.contains(e.target)){M._toggle();return}else if(O&&O.contains(e.target)){return}if(!M.__cursorInList__&&!M.multiple&&M.toggle){M.toggle=false}});if(M.position){T=i.bind(window,"scroll",j);N=i.bind(window,"resize",j)}}if(!g){n.appendChild(u(b));i.each(["multiple","size"],function(e,t){i(n).attr(t,M[t])})}if(!M.multiple){var s=(n.msData["ms-duplex"]||"").trim(),o;if(s&&(o=i.getModel(s,p))){o[1].$watch(o[0],function(e){M.value=e})}M.$watch("value",function(e,t){function s(r){if(r){C=true;M.value=t}else{if(o){o[1][o[0]]=e;n.value=e}M.currentOption=H(e)}}var r=i.type(M.onChange)==="function"&&M.onChange||false;if(C){C=false;return}if(r&&r.call(n,e,t,M,s)!==false||!r){if(o){o[1][o[0]]=e;n.value=e}M.currentOption=H(e)}})}else{M.value.$watch("length",function(){M.multipleChange=!M.multipleChange;_()})}var a=n.msData["ms-disabled"],f,l=n.msData["ms-enabled"],c;if(a&&(f=i.getModel(a,p))){f[1].$watch(f[0],function(e){M.enable=!e});M.enable=!f[1][f[0]]}if(l&&(c=i.getModel(l,p))){c[1].$watch(c[0],function(e){M.enable=e});M.enable=c[1][c[0]]}M.enable=!n.disabled;var h=M.readonlyAttr,d;if(h&&(d=i.getModel(h,p))){d[1].$watch(d[0],function(e){M.readOnly=e});M.readOnly=d[1][d[0]]}if(M.$source){if(i.type(M.$source)==="string"){var y=i.getModel(M.$source,p);y&&(M.$source=y[1][y[0]])}else if(!M.$source.$id){M.$source=null}else if(M.$source.length>0){M._refresh(M.$source.length)}M.$source&&M.$source.$watch&&M.$source.$watch("length",function(e){M._refresh(e)})}i.scan(n.parentNode,[M].concat(p));if(e){e()}else{i.log("请尽快升到avalon1.3.7+");if(typeof m.onInit==="function"){m.onInit.call(n,M,m,p)}}M.multiple&&_()};r.repeatRendered=function(){if(M.multiple){i.vmodels["scrollbar-"+M.$id].update()}};r.$remove=function(){if(x){i.unbind(window,"click",x)}if(T){i.unbind(window,"scroll",T)}if(N){i.unbind(window,"resize",N)}M.toggle=false;O&&M.container&&M.container.contains(O)&&M.container.removeChild(O);i.log("dropdown $remove")};r._select=function(e,t){var r=M.data[e].$model;if(r&&r.enable&&!r.group){var s=M.value;if(M.multiple){e=M.value.indexOf(r.value);if(e>-1){M.value.splice(e,1)}else{M.value.push(r.value)}}else{M.value=r.value}M.toggle=false;if(i.type(M.onSelect)==="function"){M.onSelect.call(n,t,M.value,s,M)}M.activeIndex=e}};r._refresh=function(e){M.data.clear();M.label="";M.__cursorInList__=false;if(e>0){M._disabledScrollbar(false);M.data.pushArray(o(M.$source.$model||M.$source));var t;if(!(t=H(M.value))){M.currentOption=M.data[0].$model;M.activeIndex=0;H(M.value=M.data[0].value)}else{M.activeIndex=M.data.$model.indexOf(t)}if(M.menuNode){M._styleFix(true)}}};r._keydown=function(e){if(M.keyboardEvent===false){return}if(!M.multiple){var t=M.activeIndex||0,r=M.value;switch(e.keyCode){case 9:case 27:e.preventDefault();break;case 13:M._select(t,e);break;case 38:case 63233:e.preventDefault();t=l(M.data,t);if(t===null){return}M.value=M.data[t].value;M.activeIndex=t;M.scrollTo(t);if(i.type(M.onSelect)==="function"){M.onSelect.call(n,e,M.value,r,M)}break;case 40:case 63235:e.preventDefault();t=l(M.data,t,true);if(t===null){return}M.value=M.data[t].value;M.activeIndex=t;M.scrollTo(t);if(i.type(M.onSelect)==="function"){M.onSelect.call(n,e,M.value,r,M)}break}}};r._toggle=function(e){if(M.data.length===0&&!M.realTimeData||!M.enable||M.readOnly){M.toggle=false;return}if(!O){var t;O=P();t=O.firstChild;M.container.appendChild(O);O=t;i.scan(t,[M].concat(p));M.menuNode=document.getElementById("menu-"+M.$id);M.dropdownNode=document.getElementById("list-"+M.$id)}if(typeof e!=="boolean"){M.toggle=!M.toggle;return}if(!e){i.type(M.onHide)==="function"&&M.onHide.call(n,O,M)}else{var r,s,o=M.value;if(i.type(o)!=="array"){o=[o]}if(M.activeIndex==null){i.each(M.data,function(e,t){if(r===void 0&&t.enable){r=e}if(t.value===o[0]){s=e;return false}return true});if(!s){s=r}M.activeIndex=s||0}M.scrollWidget=i.vmodels["scrollbar-"+M.$id];M._styleFix();M._position();if(i.type(M.onShow)==="function"){M.onShow.call(n,O,M)}}};r.$watch("toggle",function(e){M.focusClass=e;M._toggle(e)});r.toggle=false;r._position=function(){var t=i(A);var n=t.offset(),r=t.outerHeight(true),s=i(O),o=i(A.firstChild),u=s.height(),a=i(window),f={},l=O.offsetParent,c=i(l);while(o.element&&o.element.nodeType!=1){o=i(o.element.nextSibling)}if(m.position&&n.top+r+u>a.scrollTop()+a.height()&&n.top-u>a.scrollTop()){f.top=n.top-u}else{f.top=n.top+r-o.css("borderBottomWidth").replace(e,"$1")}if(l&&l.tagName!=="BODY"&&l.tagName!=="HTML"){f.top=f.top-c.offset().top+O.offsetParent.scrollTop;f.left=n.left-c.offset().left+O.offsetParent.scrollLeft}else{f.left=n.left}s.css(f)};r.__cursorInList__=false;r._listenter=function(){M.__cursorInList__=true};r._listleave=function(){M.__cursorInList__=false};r._blur=function(){if(!M.__cursorInList__&&!M.multiple&&M.toggle){M.toggle=false}};r.val=function(e){if(typeof e!=="undefined"){if(i.type(e)!=="array"){e=[e]}M.value=e}return M.value};r.isActive=function(e){var t=e.value,n=e.enable,r=e.group;if(M.multiple){return M.value.indexOf(t)>-1&&n&&!r}else{return M.value===t&&n&&!r}};r._styleFix=function(n){var r=m.height||200,s=i(M.menuNode),o="";if(n){M.menuHeight="";i(M.dropdownNode).css({height:""})}o=M.dropdownNode.scrollHeight;M.menuWidth=!t?M.listWidth-s.css("borderLeftWidth").replace(e,"$1")-s.css("borderRightWidth").replace(e,"$1"):M.listWidth;if(o>r){M._disabledScrollbar(false);o=r;i(M.dropdownNode).css({width:M.menuWidth-M.scrollWidget.getBars()[0].width()})}else{M._disabledScrollbar(true);i(M.dropdownNode).css({width:M.menuWidth})}M.menuHeight=o;M.updateScrollbar();M.scrollTo(M.activeIndex)};r.updateScrollbar=function(){M.scrollWidget.update()};r.scrollTo=function(e){if(!M.dropdownNode)return;var t=h(M.dropdownNode.firstChild),n=i(t[e]),r=M.menuHeight,s=t.length?n.position().top-i(t[0]).position().top:0,o=t.length?n.height():0,u=M.dropdownNode.scrollTop;if(s>u+r-o||s+o<u){M.scrollWidget.scrollTo(0,s+o-r)}};r._disabledScrollbar=function(e){M.scrollWidget&&(M.scrollWidget.disabled=!!e)}});M.$watch("enable",function(e){if(!e){M.toggle=false}});M.$watch("readOnly",function(e){if(!!e){M.toggle=false}});return M};n.version="1.0";n.defaults={realTimeData:false,container:null,width:200,listWidth:200,titleWidth:0,height:200,enable:true,readOnly:false,readonlyAttr:null,currentOption:null,data:[],$source:null,textFiled:"text",valueField:"value",value:[],label:"",multiple:false,listClass:"",title:"",titleClass:"",activeIndex:null,size:1,menuNode:null,dropdownNode:null,scrollWidget:null,position:true,onSelect:null,onShow:null,onHide:null,onChange:null,$hasDuplex:false,multipleChange:false,keyboardEvent:true,getTemplate:function(e,t){return e},onInit:i.noop};var c=document.documentElement.hasAttribute?function(e,t){return e.hasAttribute(t)}:function(e,t){var n=e.outerHTML,r=n.slice(0,n.search(/\/?['"]?>(?![^<]*<['"])/));return(new RegExp("\\s"+t+"\\b","i")).test(r)};return i}()}(t.exports,t,e);e.____MODULES["98a5cfa106f8b10f565f3806beac70e3"]=t.exports})(this);(function(e){var t={id:"4eee70cc619e792f6bdeb1973f28dedd",filename:"avalon.smartgrid.js",exports:{}};if(!e.____MODULES){e.____MODULES={}}var n=function(t,n,r){var i=e.____MODULES["2ab11dddd1a66c979fc4d8cb729fc348"],s='<div class="oni-smartgrid">\n    <table>\n        <colgroup>\n            <col ms-repeat-column="columns" \n                 ms-class="oni-smartgrid-{{column.toggle? \'show\': \'hide\'}}"\n                 ms-css-width="column.width"/>\n        </colgroup>\n        <thead class="oni-smartgrid-header">\n            <tr class="oni-smartgrid-header-fixed" \n                ms-if="isAffix"\n                ms-css-top="_headerTop" \n                ms-visible="_fixHeaderToggle" \n                ms-css-position="_position" \n                ms-css-width="_gridWidth">\n                <th ms-repeat-column="columns" \n                    ms-visible="column.toggle" \n                    ms-css-width="column._fixWidth" \n                    ms-css-text-align="column.align" \n                    ms-class="{{column.customClass}}"\n                    ms-class-1="oni-state-hidden: _hiddenAffixHeader(column, allChecked)">\n                    {{column.name|sanitize|html}}\n                    <span  ms-click="sortColumn(column, $index, $event)"\n                           ms-if="column.sortable" \n                           ms-class="oni-helper-{{column.sortTrend}}">\n                        <span class="oni-helper-sort-top"></span>\n                        <span class="oni-helper-sort-bottom"></span>\n                    </span>\n                </th>\n            </tr>\n            <tr>\n                <th ms-repeat-column="columns" \n                    ms-visible="_toggleColumn(column.toggle, $index)" \n                    ms-css-text-align="column.align" \n                    ms-class="{{column.customClass}}"\n                    ms-class-1="oni-state-hidden: _hiddenAffixHeader(column, allChecked)">\n                    {{column.name|sanitize|html}}\n                    <span  ms-click="sortColumn(column, $index, $event)"\n                           ms-if="column.sortable" \n                           ms-class="oni-helper-{{column.sortTrend}}">\n                        <span class="oni-helper-sort-top"></span>\n                        <span class="oni-helper-sort-bottom"></span>\n                    </span>\n                </th>\n            </tr>\n        </thead>\n        <tbody class="oni-smartgrid-body">\n        </tbody>\n        <tfoot class="oni-smartgrid-footer">\n            <tr>\n                <td ms-attr-colspan="{{columns.size()}}" class="oni-smartgrid-pager-wrapper">\n                    <div ms-visible="pageable && _pagerShow">\n                        <div ms-if="pageable" ms-widget="pager, $, $pagerConfig"></div>\n                    </div>\n                </td>\n            </tr>\n        </tfoot>\n    </table>\n    <div ms-widget="loading"></div>\n</div>\nMS_OPTION_EJS\n<&- var trl = @data.length &>\n<&- if(!trl) { &>\n    <tr><td colspan="<&=@columns.length&>"><div class="oni-smartgrid-nodata"><&=@noResult&></div></td></tr>\n<&- } else { &>\n    <&- for(var i=0, tr; i<trl; i++) { &>\n        <&- tr = @data[i]; \n            var selectedClass = "";\n            if (i%2==0) {\n                selectedClass = "oni-smartgrid-odd";\n\n            } else {\n                selectedClass = "oni-smartgrid-even"\n            } \n            if (tr.selected && @checkRow) {\n                selectedClass += " oni-smartgrid-selected"\n            }\n            if (tr.disable) {\n                selectedClass += " oni-state-disabled"\n            }&>\n        <tr id="<&=tr.$id&>" class="<&=selectedClass&>" ms-hover="oni-state-hover">\n            <&- for(var j=0, tdl=@columns.length, td; j<tdl; j++) { &>\n                <&- td=@columns[j].$model; \n                    var display=td.toggle ? "display:table-cell;" : "display:none;", \n                    textAlign="text-align:"+td.align, style=display+textAlign,\n                    customClass = td.customClass || "",\n                    format = td.format;&>\n                <td style="<&= style &>" class="<&= customClass &>">\n                    <&= format(@vmId, td.key , i, tr[td.key], tr, tr.disable) &>\n                </td>\n            <& } &>\n        </tr>  \n    <& } &>  \n<& } &>    \n';e.____MODULES["2f07999ff4151bac4f30b3501573c99f"];e.____MODULES["ca0ba5727fb7bafe48a3959abb62361c"];e.____MODULES["98a5cfa106f8b10f565f3806beac70e3"];n.exports=function(){function h(){return"smartgridTr"+c++}function v(e,t){var n=e.container;if(n){if(typeof n=="string"){n=document.getElementById(n)}if(!n.nodeType||n.nodeType!=1||!document.body.contains(n)){n=null}}n=n||t;e.container=n}function m(e){if(!e.selectable)return;var t=e.selectable.type,n=e._container;if(t==="Checkbox"||t==="Radio"){i.bind(n,"click",function(t){var n=t.target,r=i(n),s=i(n.parentNode.parentNode),o=e.data,u=e.onSelectAll,a=e._enabledData,f=e._disabledData,l=r.attr("data-index"),c=e._filterCheckboxData;if(!r.attr("data-role")||l===null){return}if(r.attr("data-role")==="selected"){var h=o[l],p=n.checked;if(p){e.selectable.type==="Checkbox"?s.addClass("oni-smartgrid-selected"):0;if(e.selectable.type==="Radio"){a.splice(0,a.length)}h.selected=true;i.Array.ensure(a,h)}else{s.removeClass("oni-smartgrid-selected");h.selected=false;i.Array.remove(a,h)}if(i.type(e.onRowSelect)==="function"){e.onRowSelect.call(s[0],h,p)}}if(a.length==o.length-f.length-c.length){e._allSelected=true}else{e._allSelected=false}})}}function g(e){var t=e.data,n=e._enabledData=[],r=e._disabledData=[],i=e._filterCheckboxData=[];for(var s=0,o=t.length,u;s<o;s++){u=t[s];if(u.disable){r.push(u);continue}if(u.checkboxShow==false){i.push(u);continue}n.push(u)}e._allEnabledData=n.concat()}function y(e){var t=e.data,n=e._enabledData=[];for(var r=0,i=t.length;r<i;r++){var s=t[r],o=s.selected;if(o&&!s.disable){n.push(s)}}}function b(e,t){for(var n=0,r=e.length;n<r;n++){var i=e[n],s=i.type;s=s===void 0?"String":s;if(i.toggle&&s==="String"){return i}}if(t.selectable&&t.selectable.type){return e[1]}else{return e[0]}}function w(e){var t=0;for(var n=0,r=e.length;n<r;n++){var i=e[n];if(i.toggle){t+=parseInt(i.configWidth)||0}}return t}function E(e){var t=true,n=e.length,r=0;if(!n){t=false;return}for(var i=0;i<n;i++){var s=e[i];if(s.selected===void 0){s.selected=false}if(s.checkboxShow!==false&&!s.selected&&!s.disable){t=false}if(s.checkboxShow===false){r++}}if(r===n){t=false}return t}function S(e,t){var n=e.columns,r={},s=i(t.parentNode).width(),o=0,u=0,a={};for(var f=0,l=n.length;f<l;f++){var c=n[f],h=c.format,p="",d=c.width,v=~~d;c.align=c.align||"center";if(c.toggle===void 0||c.isLock){c.toggle=true}c.configWidth=v;if(!v){if(d.indexOf("%")){v=s*parseInt(d)/100;c.configWidth=v}else{v="auto"}}c.width=c._fixWidth=v;o+=~~v;~~v>u?(u=v)&&(a=c):0;c.customClass=c.customClass||"";if(c.sortable){c.sortTrend="ndb"}if(h&&!e.htmlHelper[h]){e.htmlHelper[h]=function(e,t,n,r,s){i.log("方法"+h+"未定义");return r}}p=e.htmlHelper[h];if(!p){p=function(e,t,n,r,i){return r}}c.format=p;}if(e.selectable){var m=e.selectable.type,g,y=true;if(m==="Checkbox"||m==="Radio"){g=function(e,t,n,r,i,s,o){if(o&&m==="Radio")return;if(i.checkboxShow===false){return""}return"<input type='"+m.toLowerCase()+"'"+" ms-disabled='_getAllCheckboxDisabledStatus("+(o?true:false)+", _dataRender)' "+(r?"checked='checked'":"")+" name='selected' "+(o?" ms-click='_selectAll' ms-duplex-radio='_allSelected'":" data-index='"+n+"'")+" data-role='selected'/>"};y=E(e.data)||false;e._allSelected=y}r={key:"selected",name:g(e.$id,"selected",-1,y,[],null,true),width:25,configWidth:25,sortable:false,type:e.selectable.type,format:g,toggle:true,align:"center",customClass:""};o+=25;r.width=r._fixWidth=25;n.unshift(r)}if(o>s){if(~~a.width){a.width="auto"}else{for(f=0;f<l;f++){c=n[f];if(~~c.width){c.width="auto";break}}}}e.columns=n}var e=new Date-0,t=s.split("MS_OPTION_EJS"),n=t[0],r=(window.navigator.userAgent||"").toLowerCase(),o=r.indexOf("msie 6")!==-1||r.indexOf("msie 7")!==-1,u=/^function\s+\w*\s*\([^)]*\)\s*{\s*}$/m,a=false,f={};s=t[1];var l=i.ejs=function(e,t,n){var r,s;if(!l.cache[e]){n=n||{};var o=n.doc||document;t=t||{};if($.fn){r=$(e,o)[0]}else if(o.querySelectorAll){r=o.querySelectorAll(e)[0]}else{r=o.getElementById(e.slice(1))}if(!r)throw"can not find the target element";s=r.innerHTML;if(!/script|textarea/i.test(r.tagName)){s=i.filters.unescape(s)}var u=l.compile(s,n);ejs.cache[e]=u}return ejs.cache[e](t)};l.compile=function(e,t){t=t||{};var n=t.tid;if(typeof n==="string"&&typeof l.cache[n]=="function"){return l.cache[n]}var r=t.open||"<&";var s=t.close||"&>";var o=[],u=[];for(var a in t){if(t.hasOwnProperty(a)&&typeof t[a]=="function"){o.push(a);u.push(t[a])}}var f=true;var c=[];var h=new Date*1;var p=" ;r += txt"+h+"[";var d="];";var v="return function(data){'use strict'; try{var r = '',line"+h+" = 0;";var m=/(^|[^\w\u00c0-\uFFFF_])(@)(?=\w)/g;var g=/(['"])(?:\\[\s\S]|[^\ \\r\n])*?\1/g;var y=/(^-|-$)/g;var b=/mass/;var w=[];var E=0,S,x,T;for(var N=0,C=e.length;N<C;){S=e.indexOf(f?r:s,N);if(S<E){if(f){v+=p+c.length+d;x=e.slice(E+s.length);if(T){x=x.trim();T=false}c.push(x)}else{throw Error("发生错误了")}break}x=e.slice(N,S);E=S;if(f){v+=p+c.length+d;if(T){x=x.trim();T=false}c.push(x);N=S+r.length}else{w.push(x);v+=";line"+h+"="+w.length+";";switch(x.charAt(0)){case"=":x=x.replace(y,function(){T=true;return""});x=x.replace(m,"$1data.");if(x.indexOf("|")>1){var k=[];var L=x.replace(g,function(e){k.push(e);return"mass"}).replace(/\|\|/g,"@");if(L.indexOf("|")>1){var A=L.split("|");var O=A.shift().replace(/\@/g,"||").replace(b,function(){return k.shift()});for(var M;M=k.shift();){A=M.split(":");a=A[0];P="";if(A[1]){P=", "+A[1].replace(b,function(){return k.shift()})}O="avalon.filters."+a+"("+O+P+")"}x="="+O}}v+=" ;r +"+x+";";break;case"#":break;case"-":default:x=x.replace(y,function(){T=true;return""});v+=x.replace(m,"$1data.");break}N=S+s.length}f=!f}v+=" return r; }catch(e){ avalon.log(e);\navalon.log(js"+h+"[line"+h+"-1]) }}";var _=["txt"+h,"js"+h,"filters"];var D=Function.apply(Function,_.concat(o,v));var P=[c,w,i.filters];var H=D.apply(this,P.concat(u));if(typeof n==="string"){return l.cache[n]=H}return H};l.cache={};i.filters.unescape=function(e){return e.replace(/&quot;/g,'"').replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&");return e.replace(/&#([\d]+);/g,function(e,t){return String.fromCharCode(parseInt(t,10))})};var c=0;var p=0;var d=i.ui.smartgrid=function(t,r,c){var p=r.smartgridOptions,d=i(t),x=p.pager,T=r.smartgridId,N=true;S(p,t);v(p,t);p._position=o?"absolute":"fixed";p.loading.onInit=function(e,t,n){k.loadingVModel=e};p.$pagerConfig={canChangePageSize:true,options:[10,20,50,100],onInit:function(e,t,n){k&&(k.pager=e);e&&k._entryCount(e)}};p.pageable=p.pageable!==void 0?p.pageable:true;if(i.type(x)==="object"){x.prevText=x.prevText||"上一页";x.nextText=x.nextText||"下一页";if(p.pageable){x.getTemplate=typeof x.getTemplate==="function"?x.getTemplate:function(e,t){var n="";if(Array.isArray(x.options)&&t.canChangePageSize){n='<div class="oni-smartgrid-pager-options"><div class="oni-smartgrid-showinfo">每页显示</div><select ms-widget="dropdown" data-dropdown-list-width="50" data-dropdown-width="50" ms-duplex="perPages"><option ms-repeat="options" ms-value="el.value" ms-attr-label="el.value">{{el.text}}</option></select><div class="oni-smartgrid-showinfo">条, {{totalItems}}条结果</div></div>'}else{n='<div class="oni-smartgrid-pager-options">{{totalItems}}条结果</div>'}return e+n}}if(x.onInit&&typeof x.onInit==="function"){var C=x.onInit;x.onInit=function(e,t,n){k&&(k.pager=e);C(e,t,n);e&&k._entryCount(e)}}i.mix(p.$pagerConfig,p.pager)}p.pager=null;p.template=p.getTemplate(s,p);p.$skipArray=["_allEnabledData","template","widgetElement","container","_container","_position","htmlHelper","selectable","loadingVModel","loading","pageable","noResult","sortable","pager","data","containerMinWidth","_disabledData","_enabledData","_filterCheckboxData"].concat(p.$skipArray);var k=i.define(T,function(r){i.mix(r,p);r.widgetElement=t;r._headerTop=0+p.affixHeight;r._container=null;r._fixHeaderToggle=false;r._gridWidth=0;r._pagerShow=false;r._allEnabledData=[];r._disabledData=[];r._enabledData=[];r._filterCheckboxData=[];r.loadingVModel=null;r._dataRender=false;r.perPages=void 0;r._hiddenAffixHeader=function(e,t){var n=k.selectable;return n&&n.type&&e.key=="selected"&&!t};r.getRawData=function(){return k.data};r.getSelected=function(){var e=k._disabledData,t=[];e.forEach(function(e,n){if(e.selected){t.push(e)}});return t.concat(k._enabledData)};r._entryCount=function(e){function t(e){var t=r.data;r.perPages=e;if(t.length>e)r.render(t.slice(0,e))}if(r.perPages!==void 0)return;e.$watch("perPages",t);t(e.perPages)};r.selectAll=function(e){e=e!==void 0?e:true;k._selectAll(null,e)};r.isSelectAll=function(){return k._allSelected};r.sortColumn=function(e,t,n){var r=n.target,s=i(r),o="",f=e.key,l=0,c=k.onColumnSort;if(!k.data.length)return;if(s.hasClass("oni-helper-sort-top")){o="asc"}else{o="desc"}a=true;o=="asc"?l=1:l=-1;e.sortTrend=o;if(k.sortable.remoteSort&&typeof k.remoteSort==="function"&&!u.test(k.remoteSort)){k.remoteSort(f,o,k);}else if(typeof e.localSort==="function"&&!u.test(e.localSort)){k.data.sort(function(t,n){return l*e.localSort(t,n,f,k.$model)||0});k.render();if(i.type(c)==="function"){c.call(k,o,f)}}else{if(e.type==="Number"){k.data.sort(function(e,t){return l*(e[f]-t[f])||0})}else{k.data.sort(function(e,t){return l*e[f].localeCompare(t[f])})}k.render();if(i.type(c)==="function"){c.call(k,o,f)}}};r.setColumns=function(e,t){var n=k.columns;e=[].concat(e);t=t!==void 0?t:true;for(var r=0,i=n.length;r<i;r++){var s=n[r],o=s.$model.key,u=e.indexOf(o);if(u!=-1&&!s.isLock){s.toggle=t}}};r.showNoResult=function(e){k.noResult=e||k.noResult;k.data=[];k.render()};r.showLoading=function(){k.loadingVModel.toggle=true};r.hideLoading=function(){k.loadingVModel.toggle=false};r._selectAll=function(e,t){var n=k.data,r=k._container.getElementsByTagName("tr"),s=k.onSelectAll;setTimeout(function(){var o=e?e.target.checked:t,u=n.concat();k._allSelected=o;for(var a=0,f=r.length;a<f;a++){var l=r[a],c=i(l),h,p=l.cells[0].getElementsByTagName("input")[0],d=p&&i(p).attr("data-index");if(d!==null&&d!==void 0){h=n[d];if(!h.disable){h.selected=o;p.checked=o;c[o?"addClass":"removeClass"]("oni-smartgrid-selected")}}else{continue}}if(o){k._enabledData=k._allEnabledData.concat()}else{k._enabledData=[]}if(i.type(s)==="function"){s.call(k,n,o)}},100)};r._toggleColumn=function(e,t){if(!k._container)return e;var n=k._container.getElementsByTagName("tr"),r=null;for(var i=0,s,o=n.length;i<o;i++){s=n[i];r=s.cells[t];if(r){if(e){s.cells[t].style.display="table-cell"}else{s.cells[t].style.display="none"}}}setTimeout(function(){k._setColumnWidth()},100);return e};r._setColumnWidth=function(e){var t=k._container.getElementsByTagName("tr")[0].cells,n=k.columns,s=n.$model,o=i(k.container),u=o.width(),a=w(s),f=b(n,k);if(a>u&&!e||!r.autoResize){o.css("width",a);f.width=f.configWidth}else{o.css("width","auto");f.width="auto"}for(var l=0,c=t.length;l<c;l++){var h=i(t[l]),p=h.width(),d=n[l];d._fixWidth=p}k._gridWidth=u};r._getTemplate=function(t,n){var s,o,u="smartgrid_tmp_"+e,f=t||k.data,c=k.columns,h=c.$model,d=k.selectable&&k.selectable.type||"",v=[];i.each(f,function(e,t){if(t.$id&&t.$id!="remove")v.push(t)});var m=v.length;checkRow=d==="Checkbox";if(!l[u]){s=l.compile(p.template,k.htmlHelper);l[u]=s}else{s=l[u]}for(var g=0,y=h.length;g<y;g++){var b=h[g],w=b.key;if(!a){c[g].sortTrend&&(c[g].sortTrend="ndb")}for(var E=0;E<m;E++){var S=v[E];S[w]=S[w]!==void 0?S[w]:b.defaultValue}}if(r.pageable&&r.pager&&r.pager.perPages){if(v.length>r.pager.perPages)v=v.slice(0,r.pager.perPages)}o=s({data:v,columns:c,len:2,noResult:k.noResult,vmId:T,startIndex:n||0,checkRow:checkRow});return o};r._getAllCheckboxDisabledStatus=function(e){var t=k._filterCheckboxData.length,n=k._disabledData.length,r=t+n;if(e){return r===k.data.length?true:false}else{return false}};r.addRows=function(e,t,n){if((!e||!e.length)&&!t)return;var r="",s,o=k.container,u=o.getElementsByTagName("tbody")[0]||o.getElementsByTagName("table")[0],f=k.selectable,l=k.getLen(k.data),p=k.data.length;if(!u)return;if(l===0||t)i.clearHTML(u);k._pagerShow=!l?false:true;if(e){var d=[];i.each(e,function(e,t){d.push(i.mix({},t));d[e].$id=h()});k.data.push.apply(k.data,d)}i.each(k.data,function(e,t){t.$id=t.$id||h()});r=k.addRow(k._getTemplate(e?k.data.slice(p):e,e?p:0),k.columns.$model,c);s=i.parseHTML(r);u.appendChild(s);if(f&&(f.type==="Checkbox"||f.type==="Radio")){var v=E(k.data);k._allSelected=v;y(k)}if(!n)k.showLoading(k.data);i.nextTick(function(){i.scan(k.container,[k].concat(c));k._setColumnWidth();if(!n)k.hideLoading()});if(a)a=false};r.getLen=function(e){var t=0;for(var n=0,r=e.length;n<r;n++){if(e[n]&&e[n].$id!="remove")t++}return t};r.removeRow=function(e,t){var n=k.data[e];if(!n)return;var r=n.$id,i=document.getElementById(r);i&&i.parentNode.removeChild(i);if(t===false){n.$id="remove"}else{k.data.splice(e,1)}if(!k.getLen(k.data))k.render(void 0,true)};r.render=function(e,t,n){if(i.type(e)==="array"){k.data=e}else{t=e}t=t===void 0||t?true:false;if(!N){g(k);k._dataRender=!k._dataRender}else{N=false}k.addRows(void 0,t,n);if(a){a=false}else if(!t){k.container.scrollIntoView()}};r.$init=function(){var e=k.container,r="";r=n.replace("MS_OPTION_ID",k.$id);e.innerHTML=r;g(k);i.scan(e,k);i.nextTick(function(){k._container=e.getElementsByTagName("tbody")[0];k.render(true);m(k)});if(k.isAffix){f.scrollCallback=i(window).bind("scroll",function(){var e=Math.max(document.body.scrollTop,document.documentElement.scrollTop),n=d.offset().top,r=i(t.getElementsByTagName("thead")[0]).css("height"),s=e-n+k.affixHeight,o=i(window).height(),u=d.outerHeight(),a=k._position;if(u>o&&e>n+r&&n+u>e){if(a==="absolute"){k._headerTop=Math.floor(s)}if(!k.$model._fixHeaderToggle){k._fixHeaderToggle=true}}else{if(a==="absolute"){k._headerTop=0}if(k.$model._fixHeaderToggle){k._fixHeaderToggle=false}}})}t.resizeTimeoutId=0;f.resizeCallback=i(window).bind("resize",function(){if(!k.autoResize)return;clearTimeout(t.resizeTimeoutId);var e=i(window).width();if(e<=k.containerMinWidth){t.style.width=k.containerMinWidth+"px"}t.resizeTimeoutId=setTimeout(function(){k._container&&k._setColumnWidth(true)},150)});if(typeof p.onInit==="function"){p.onInit.call(t,k,p,c)}};r.$remove=function(){var e=k.container;e.innerHTML=e.textContent="";i(window).unbind("resize",f.resizeCallback).unbind("scroll",f.scrollCallback)}});return k};d.defaults={container:"",autoResize:true,data:[],columns:[],allChecked:true,htmlHelper:{},noResult:"暂时没有数据",remoteSort:i.noop,isAffix:false,affixHeight:0,containerMinWidth:600,selectable:false,loading:{toggle:false,modal:true,modalBackground:"#000"},sortable:{remoteSort:true},addRow:function(e,t,n){return e},getTemplate:function(e,t){return e}};return i}()}(t.exports,t,e);e.____MODULES["4eee70cc619e792f6bdeb1973f28dedd"]=t.exports})(this);(function(__context){var module={id:"8b03a9fae1e76b43eccda98d88191431",filename:"mmRequest.js",exports:{}};if(!__context.____MODULES){__context.____MODULES={}}var r=function(exports,module,global){var avalon=__context.____MODULES["2ab11dddd1a66c979fc4d8cb729fc348"];__context.____MODULES["2f17dbeb5563c45e749f1774d593001c"];module.exports=function(){function IE(){if(window.VBArray){var e=document.documentMode;return e?e:window.XMLHttpRequest?7:6}else{return 0}}function parseJS(code){var indirect=eval;code=code.trim();if(code){if(code.indexOf("use strict")===1){var script=document.createElement("script");script.text=code;head.appendChild(script).parentNode.removeChild(script)}else{indirect(code)}}}function parseXML(e,t,n){try{var r=document.documentMode;if(window.DOMParser&&(!r||r>8)){n=new DOMParser;t=n.parseFromString(e,"text/xml")}else{t=new ActiveXObject("Microsoft.XMLDOM");t.async="false";t.loadXML(e)}}catch(i){t=void 0}if(!t||!t.documentElement||t.getElementsByTagName("parsererror").length){avalon.error("Invalid XML: "+e)}return t}function ajaxExtend(e){e=avalon.mix({},defaults,e);e.type=e.type.toUpperCase();var t=typeof e.data==="string"?e.data:avalon.param(e.data);e.querystring=t||"";e.url=e.url.replace(rhash,"").replace(rprotocol,location.protocol+"//");if(typeof e.crossDomain!=="boolean"){var n=document.createElement("a");try{n.href=e.url;var r=!"1"[0]?n.getAttribute("href",4):n.href;n.href=r;e.crossDomain=originAnchor.protocol+"//"+originAnchor.host!==n.protocol+"//"+n.host}catch(i){e.crossDomain=true}}e.hasContent=!rnoContent.test(e.type);if(!e.hasContent){if(t){e.url+=(rquery.test(e.url)?"&":"?")+t}if(e.cache===false){e.url+=(rquery.test(e.url)?"&":"?")+"_time="+(new Date-0)}}return e}function ok(e){return e}function ng(e){throw e}function paramInner(e,t,n){var r;if(Array.isArray(t)){avalon.each(t,function(t,r){paramInner(e+"["+(typeof r==="object"?t:"")+"]",r,n)})}else if(avalon.isPlainObject(t)){for(r in t){paramInner(e+"["+r+"]",t[r],n)}}else{n(e,t)}}function trimLine(e){return e.replace(rline,"\r\n")}var global=this||(0,eval)("this");var DOC=global.document;var encode=encodeURIComponent;var decode=decodeURIComponent;var rlocalProtocol=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/;var rheaders=/^(.*?):[ \t]*([^\r\n]*)\r?$/gm;var rnoContent=/^(?:GET|HEAD)$/;var rprotocol=/^\/\//;var rhash=/#.*$/;var rquery=/\?/;var rjsonp=/(=)\?(?=&|$)|\?\?/;var r20=/%20/g;var originAnchor=document.createElement("a");originAnchor.href=location.href;var accepts={xml:"application/xml, text/xml",html:"text/html",text:"text/plain",json:"application/json, text/javascript",script:"text/javascript, application/javascript","*":["*/"]+["*"]};var useOnload=IE()===0||IE()>8;if(!String.prototype.startsWith){String.prototype.startsWith=function(e,t){t=t||0;return this.lastIndexOf(e,t)===t}}var head=DOC.getElementsByTagName("head")[0];var isLocal=false;try{isLocal=rlocalProtocol.test(location.protocol)}catch(e){}new function(){var s=["XMLHttpRequest","ActiveXObject('MSXML2.XMLHTTP.6.0')","ActiveXObject('MSXML2.XMLHTTP.3.0')","ActiveXObject('MSXML2.XMLHTTP')","ActiveXObject('Microsoft.XMLHTTP')"];s[0]=IE()<8&&IE()!==0&&isLocal?"!":s[0];for(var i=0,axo;axo=s[i++];){try{if(eval("new "+axo)){avalon.xhr=new Function("return new "+axo);break}}catch(e){}}};var supportCors="withCredentials"in avalon.xhr();var defaults={type:"GET",contentType:"application/x-www-form-urlencoded; charset=UTF-8",async:true,jsonp:"callback"};var XHRMethods={setRequestHeader:function(e,t){this.requestHeaders[e]=t;return this},getAllResponseHeaders:function(){return this.readyState===4?this.responseHeadersString:null},getResponseHeader:function(e,t){if(this.readyState===4){while(t=rheaders.exec(this.responseHeadersString)){this.responseHeaders[t[1]]=t[2]}t=this.responseHeaders[e]}return t===undefined?null:t},overrideMimeType:function(e){this.mimeType=e;return this},abort:function(e){e=e||"abort";if(this.transport){this.respond(0,e)}return this},dispatch:function(e,t){var n=t;if(!this.transport){return}this.readyState=4;var r=e>=200&&e<300||e===304;if(r){if(e===204){n="nocontent"}else if(e===304){n="notmodified"}else{if(typeof this.response==="undefined"){var i=this.options.dataType||this.options.mimeType;if(!i&&this.responseText||this.responseXML){i=this.getResponseHeader("Content-Type")||"";i=i.match(/json|xml|script|html/)||["text"];i=i[0]}var s=this.responseText||"",o=this.responseXML||"";try{this.response=avalon.ajaxConverters[i].call(this,s,o)}catch(u){r=false;this.error=u;n="parsererror"}}}}this.status=e;this.statusText=n+"";if(this.timeoutID){clearTimeout(this.timeoutID);delete this.timeoutID}this._transport=this.transport;if(r){this._resolve([this.response,n,this])}else{this._reject([this,n,this.error])}delete this.transport}};avalon.ajax=function(e,t){if(!e||!e.url){avalon.error("参数必须为Object并且拥有url属性")}e=ajaxExtend(e);var n={responseHeadersString:"",responseHeaders:{},requestHeaders:{},querystring:e.querystring,readyState:0,uniqueID:(""+Math.random()).replace(/0\./,""),status:0};var r,i;var t=new avalon.Promise(function(e,t){i=e;r=t});t.options=e;t._reject=r;t._resolve=i;var s=[],o=[];Array("done","fail","always").forEach(function(e){t[e]=function(t){if(typeof t==="function"){if(e!=="fail")s.push(t);if(e!=="done")o.push(t)}return this}});var u=e.async===false;if(u){avalon.log("warnning:与jquery1.8一样,async:false这配置已经被废弃");t.async=false}avalon.mix(t,n,XHRMethods);t.then(function(e){e=Array.isArray(e)?e:e===void 0?[]:[e];for(var n=0,r;r=s[n++];){r.apply(t,e)}return e},function(e){e=Array.isArray(e)?e:e===void 0?[]:[e];for(var n=0,r;r=o[n++];){r.apply(t,e)}return e});t.done(e.success).fail(e.error).always(e.complete);var a=e.dataType;var f=avalon.ajaxTransports;if((e.crossDomain&&!supportCors||rjsonp.test(e.url))&&a==="json"&&e.type==="GET"){a=e.dataType="jsonp"}var l=e.form?"upload":a;var c=f[l]||f.xhr;avalon.mix(t,c);if(t.preproccess){a=t.preproccess()||a}if(e.contentType){t.setRequestHeader("Content-Type",e.contentType)}t.setRequestHeader("Accept",accepts[a]?accepts[a]+", */*; q=0.01":accepts["*"]);for(var h in e.headers){t.setRequestHeader(h,e.headers[h])}if(e.async&&e.timeout>0){t.timeoutID=setTimeout(function(){t.abort("timeout");t.dispatch(0,"timeout")},e.timeout)}t.request();return t};"get,post".replace(avalon.rword,function(e){avalon[e]=function(t,n,r,i){if(typeof n==="function"){i=i||r;r=n;n=void 0}return avalon.ajax({type:e,url:t,data:n,success:r,dataType:i})}});avalon.getScript=function(e,t){return avalon.get(e,null,t,"script")};avalon.getJSON=function(e,t,n){return avalon.get(e,t,n,"json")};avalon.upload=function(e,t,n,r,i){if(typeof n==="function"){i=r;r=n;n=void 0}return avalon.ajax({url:e,type:"post",dataType:i,form:t,data:n,success:r})};avalon.ajaxConverters={text:function(e){return e},xml:function(e,t){return t!==void 0?t:parseXML(e)},html:function(e){return avalon.parseHTML(e)},json:function(e){if(!avalon.parseJSON){avalon.log("avalon.parseJSON不存在,请升级到最新版")}return avalon.parseJSON(e)},script:function(e){parseJS(e);return e},jsonp:function(){var e,t;if(this.jsonpCallback.startsWith("avalon.")){t=this.jsonpCallback.replace(/avalon\./,"");e=avalon[t];delete avalon[t]}else{e=window[this.jsonpCallback]}return e}};avalon.param=function(e){var t,n=[],r=function(e,t){t=t==null?"":t;n[n.length]=encode(e)+"="+encode(t)};if(Array.isArray(e)||!avalon.isPlainObject(e)){avalon.each(e,function(e,t){r(e,t)})}else{for(t in e){paramInner(t,e[t],r)}}return n.join("&").replace(r20,"+")};avalon.unparam=function(e){var t,n,r=/\[(.*?)\]/g,i=/(.+?)\[/,s={};if((n=avalon.type(e))!="string"||n=="string"&&!n.length)return{};if(e.indexOf("?")!==-1){e=e.split("?").pop()}t=decode(e).split("&");if(!(n=t.length)||n==1&&n==="")return s;t.forEach(function(e){if(!e.length)return;n=e.split("=");var t=n.shift(),o=n.join("=").replace(/\+/g," "),u,a,f=[];if(!t.length)return;while(n=r.exec(t))f.push(n[1]);if(!(u=f.length)){s[t]=o;return}u--;n=i.exec(t);if(!n||!(t=n[1])||!t.length)return;if(avalon.type(s[t])!=="object")s[t]={};a=s[t];avalon.each(f,function(e,t){if(!(n=t).length){n=0;avalon.each(a,function(e){if(!isNaN(e)&&e>=0&&e%1===0&&e>=n)n=Number(e)+1})}if(e==u){a[n]=o}else if(avalon.type(a[n])!=="object"){a=a[n]={}}else{a=a[n]}})});return s};var rinput=/select|input|button|textarea/i;var rcheckbox=/radio|checkbox/;var rline=/\r?\n/g;avalon.serialize=function(e){var t={};Array.prototype.filter.call(e.getElementsByTagName("*"),function(e){if(rinput.test(e.nodeName)&&e.name&&!e.disabled){return rcheckbox.test(e.type)?e.checked:true}}).forEach(function(e){var n=avalon(e).val();n=Array.isArray(n)?n.map(trimLine):trimLine(n);var r=e.name;if(r in t){if(Array.isArray(n)){t[r].push(n)}else{t[r]=[t[r],n]}}else{t[r]=n}});return avalon.param(t,false)};var transports=avalon.ajaxTransports={xhr:{request:function(){var e=this;var t=this.options;var n=this.transport=new avalon.xhr;n.open(t.type,t.url,t.async,t.username,t.password);if(this.mimeType&&n.overrideMimeType){n.overrideMimeType(this.mimeType)}if(t.crossDomain&&"withCredentials"in n){n.withCredentials=true}if(!t.crossDomain){this.requestHeaders["X-Requested-With"]="XMLHttpRequest"}for(var r in this.requestHeaders){n.setRequestHeader(r,this.requestHeaders[r]+"")}if(t.progressCallback){var i=document.all&&!window.atob;if(!i){n.upload.onprogress=t.progressCallback}}var s=t.dataType;if("responseType"in n&&/^(blob|arraybuffer|text)$/.test(s)){n.responseType=s;this.useResponseType=true}n.send(t.hasContent&&(this.formdata||this.querystring)||null);if(!t.async||n.readyState===4){this.respond()}else{if(useOnload){n.onload=n.onerror=function(t){this.readyState=4;this.status=t.type==="load"?200:500;e.respond()}}else{n.onreadystatechange=function(){e.respond()}}}},respond:function(e,t){var n=this.transport;if(!n){return}if(t&&this.timeoutID){clearTimeout(this.timeoutID);delete this.timeoutID}try{var r=n.readyState===4;if(t||r){n.onreadystatechange=avalon.noop;if(useOnload){n.onerror=n.onload=null}if(t){if(!r&&typeof n.abort==="function"){n.abort()}}else{var i=n.status;var s=n.responseText;this.responseText=typeof s==="string"?s:void 0;try{var o=n.responseXML;this.responseXML=o.documentElement}catch(u){}if(this.useResponseType){this.response=n.response}this.responseHeadersString=n.getAllResponseHeaders();try{var a=n.statusText}catch(u){this.error=u;a="firefoxAccessError"}if(!i&&isLocal&&!this.options.crossDomain){i=this.responseText?200:404}else if(i===1223){i=204}this.dispatch(i,a)}}}catch(f){if(!t){this.dispatch(500,f)}}}},jsonp:{preproccess:function(){var e=this.options;var t=this.jsonpCallback=e.jsonpCallback||"avalon.jsonp"+setTimeout("1");if(rjsonp.test(e.url)){e.url=e.url.replace(rjsonp,"$1"+t)}else{e.url=e.url+(rquery.test(e.url)?"&":"?")+e.jsonp+"="+t}if(t.startsWith("avalon.")){t=t.replace(/avalon\./,"");avalon[t]=function(e){avalon[t]=e}}else{window[t]=function(e){window[t]=e}}return"script"}},script:{request:function(){var e=this.options;var t=this.transport=DOC.createElement("script");if(e.charset){t.charset=e.charset}var n=this;t.onerror=t[useOnload?"onload":"onreadystatechange"]=function(){n.respond()};t.src=e.url;head.insertBefore(t,head.firstChild)},respond:function(e,t){var n=this.transport;if(!n){return}if(t&&this.timeoutID){clearTimeout(this.timeoutID);delete this.timeoutID}var r=/loaded|complete|undefined/i.test(n.readyState);if(t||r){n.onerror=n.onload=n.onreadystatechange=null;var i=n.parentNode;if(i){i.removeChild(n)}if(!t){var s;if(this.jsonpCallback){var o=this.jsonpCallback.startsWith("avalon.")?avalon[this.jsonpCallback.replace(/avalon\./,"")]:window[this.jsonpCallback];s=typeof o==="function"?[500,"error"]:[200,"success"]}else{s=[200,"success"]}this.dispatch.apply(this,s)}}}},upload:{preproccess:function(){var e=this.options,t;if(typeof e.form.append==="function"){t=e.form;e.contentType=""}else{t=new FormData(e.form)}avalon.each(e.data,function(e,n){t.append(e,n)});this.formdata=t}}};avalon.mix(transports.jsonp,transports.script);avalon.mix(transports.upload,transports.xhr);if(!window.FormData){var str='Function BinaryToArray(binary)\r\n                 Dim oDic\r\n                 Set oDic = CreateObject("scripting.dictionary")\r\n                 length = LenB(binary) - 1\r\n                 For i = 1 To length\r\n                     oDic.add i, AscB(MidB(binary, i, 1))\r\n                 Next\r\n                 BinaryToArray = oDic.Items\r\n              End Function';execScript(str,"VBScript");avalon.fixAjax=function(){function e(e){var t=avalon.parseHTML("<iframe "+" id='"+e+"'"+" name='"+e+"'"+" style='position:absolute;left:-9999px;top:-9999px;'/>").firstChild;return(DOC.body||DOC.documentElement).insertBefore(t,null)}function t(e,t){var n=[],r,i,s,o,u;for(r in t){i=Array.isArray(t[r]);s=i?t[r]:[t[r]];for(o=0;o<s.length;o++){u=DOC.createElement("input");u.type="hidden";u.name=r;u.value=s[o];e.appendChild(u);n.push(u)}}return n}avalon.ajaxConverters.arraybuffer=function(){var e=this.tranport&&this.tranport.responseBody;if(e){return(new VBArray(BinaryToArray(e))).toArray()}};avalon.ajaxTransports.upload={request:function(){var n=this;var r=this.options;var i="iframe-upload-"+this.uniqueID;var s=r.form;var o=this.transport=e(i);var u={target:s.target||"",action:s.action||"",enctype:s.enctype,method:s.method};var a=r.data?t(s,r.data):[];s.target=i;s.action=r.url;s.method="POST";s.enctype="multipart/form-data";this.uploadcallback=avalon.bind(o,"load",function(e){n.respond(e)});s.submit();for(var f in u){s[f]=u[f]}a.forEach(function(e){s.removeChild(e)})},respond:function(e){var t=this.transport,n;if(!t){return}if(e&&e.type==="load"){var r=t.contentWindow.document;this.responseXML=r;if(r.body){this.responseText=r.body.innerHTML;if((n=r.body.firstChild)&&n.nodeName.toUpperCase()==="PRE"&&n.firstChild){this.responseText=n.firstChild.nodeValue}}this.dispatch(200,"success")}this.uploadcallback=avalon.unbind(t,"load",this.uploadcallback);delete this.uploadcallback;setTimeout(function(){t.parentNode.removeChild(t)})}};delete avalon.fixAjax};avalon.fixAjax()}return avalon}()}(module.exports,module,__context);__context.____MODULES["8b03a9fae1e76b43eccda98d88191431"]=module.exports})(this);(function(e){var t={id:"86d1e3b4840496091920cb12b77f0089",filename:"jquery.cookie.js",exports:{}};if(!e.____MODULES){e.____MODULES={}}var n=function(e,t,n){jQuery.cookie=function(e,t,n){if(arguments.length>1&&String(t)!=="[object Object]"){n=jQuery.extend({},n);if(t===null||t===undefined){n.expires=-1}if(typeof n.expires==="number"){var r=n.expires,i=n.expires=new Date;i.setDate(i.getDate()+r)}t=String(t);return document.cookie=[encodeURIComponent(e),"=",n.raw?escape(t):encodeURIComponent(t),n.expires?"; expires="+n.expires.toUTCString():"",n.path?"; path="+n.path:"",n.domain?"; domain="+n.domain:"",n.secure?"; secure":""].join("")}n=t||{};var s,o=n.raw?function(e){return unescape(e)}:decodeURIComponent;return(s=(new RegExp("(?:^|; )"+encodeURIComponent(e)+"=([^;]*)")).exec(document.cookie))?o(s[1]):null}}(t.exports,t,e);e.____MODULES["86d1e3b4840496091920cb12b77f0089"]=t.exports})(this);(function(e){var t={id:"02061ba61277a1df7ceca0753929967b",filename:"auto-height-client.js",exports:{}};if(!e.____MODULES){e.____MODULES={}}var n=function(e,t,n){(function(e,t){function a(e){if(u.test(e)){return RegExp.$1}else{return e}}function c(){if(e.document.documentElement.offsetHeight&&e.document.documentElement.scrollHeight&&$.browser.mozilla){return Math.min(e.document.documentElement.offsetHeight,e.document.documentElement.scrollHeight)}return Math.max(e.document.documentElement.offsetHeight,e.document.documentElement.scrollHeight)}var n={query:"auto",origin:"*",interval:"1000",id:"",url:""};var r=location.hash;var i,s;var o=e.autoheight=e.autoheight||{name:"autoheight"};o.config=o.config||{name:"config"};var u=/^([\w-]+:\/\/[^\/]+)/;var f=o.scroll=function(e,t){var n="id="+o.config.id+"&top="+e;if(typeof t!="undefined"){n+="&left="+t}o.config.origin=o.config.origin||a(o.config.url)||"*";s(n,o.config.origin)};var l=o.send=function(e){var n,r;if(typeof e=="number"){r=e;if(typeof arguments[1]=="number"){n=r;r=arguments[1]}}else if(typeof e=="object"){r="height"in e?e.height:"h"in e?e.h:"y"in e?e.y:t;n="width"in e?e.width:"w"in e?e.w:"x"in e?e.x:t}var s=[];s.push("id="+o.config.id);if(typeof n!=="undefined"){s.push("width="+n)}if(typeof r!=="undefined"){s.push("height="+r)}s.push("IFRAM_DATA="+window.IFRAM_DATA);o.config.origin=o.config.origin||a(o.config.url)||"*";i(s.join("&"),o.config.origin)};if(e.postMessage){i=function(t,r){clearInterval(i.itv);i.itv=setInterval(function(){e.parent.postMessage(t,r)},o.config.interval||n.interval)};s=function(t,n){e.parent.postMessage(t,n)}}else{$(function(){var t=0;var n=document.createElement("iframe");var r=n.id="_ifr_"+Math.random();var u=o.config.url;var a=o.config.interval;n.src="about:blank";n.style.display="none";e.document.body.appendChild(n);n=null;i=function(e,n){var i=document.getElementById(r);if(u!=o.config.url||a!=o.config.interval){u=o.config.url;a=o.config.interval}i.src=u+"?interval="+a+"&r="+t++%2+"#"+e};s=function(e,n){var i=document.getElementById(r);if(u!=o.config.url||a!=o.config.interval){u=o.config.url;a=0}i.src=u+"?interval="+a+"&r="+t++%2+"#"+e}})}var h;var p;$(function(){if(window!=top){h=setTimeout(function e(){if(o.config.id){var r=o.config.query||n.query;var i;if(typeof r=="function"){i=r();if(i===t){i=c()}}else if(r=="auto"){i=c()}else{i=r}if(p!==i){p=i;l(i)}if(parseInt(o.config.interval)!=0){h=setTimeout(e,o.config.interval||n.interval)}}else{h=setTimeout(e,13)}},50)}})})(this)}(t.exports,t,e);e.____MODULES["02061ba61277a1df7ceca0753929967b"]=t.exports})(this);(function(e){var t={id:"fc889a1e71c18b8357adeceada1618bf",filename:"iframeAutoHeight.js",exports:{}};if(!e.____MODULES){e.____MODULES={}}var n=function(t,n,r){e.____MODULES["86d1e3b4840496091920cb12b77f0089"];e.____MODULES["02061ba61277a1df7ceca0753929967b"];$(function(){var e="";if(/^http(s)?:\/\/.+$/.test($.cookie("QN52"))){e=$.cookie("QN52")}autoheight.config={id:"show_info",interval:"100",url:e+"/delegate.html",origin:"*",query:function(){}}})}(t.exports,t,e);e.____MODULES["fc889a1e71c18b8357adeceada1618bf"]=t.exports})(this);(function(e){var t={id:"de94d619bf153377a11b03603434812c",filename:"editGM.string",exports:{}};if(!e.____MODULES){e.____MODULES={}}var n=function(e,t,n){if(typeof window.QTMPL==="undefined")window.QTMPL={};window.QTMPL["editGM"]='<form ms-widget="validation, $editGMDlg, $editGMDlg" ms-controller="editGM" onselectstart="return false">\n	<div class="m-filter-row clearfix mt_5">\n		<label class="m-filter-tit">用户名：</label>\n		<div class="m-filter-con2">\n			<input type="text" class="form-txtctr" ms-attr-disabled="datas.id!=\'\'" maxlength="30" ms-duplex-required-maxlength-username="datas.qunarName" placeholder="用户名/手机号/邮箱">\n		</div>\n	</div>\n	<div class="m-filter-row clearfix mt_5 bt">\n		<label class="m-filter-tit">网络名称：</label>\n		<div class="m-filter-con2">\n			<input type="text" class="form-txtctr" maxlength="30" ms-duplex-required-maxlength="datas.webName" placeholder="网络名称"></div>\n	</div>\n	<!--<div class="m-filter-row clearfix bt">\n		<label class="m-filter-tit">优先级：</label>\n		<div class="m-filter-con2">\n			<input type="text" class="form-txtctr" maxlength="2" ms-duplex-required-int-maxlength="datas.webName" placeholder="优先级">\n			<p class="red">(值越大优先级越高)</p>\n		</div>\n	</div>-->\n	<div class="m-filter-row clearfix mt_5">\n		<label class="m-filter-tit">所属商家：</label>\n	</div>\n	<div class="m-filter-row clearfix bt mt_5 pl60">\n		<!-- <a href="javascript:void(0)" ms-if="isAdd" class="btn mr5" ms-repeat="rowSuList" ms-click="changeSupplier" ms-attr-data-id="el.id" ms-attr-data-isChecked= "el.isChecked">\n			<label>\n				<input type="checkbox" class="hide" ms-duplex-string="suIdList" ms-attr-value="el.id">{{el.name}}\n			</label>\n		</a> -->\n		\n		<span class="btn mr5" ms-repeat="rowSuList" ms-click="changeSupplier" ms-attr-data-id="el.id" ms-attr-data-isChecked= "el.isChecked">\n			{{el.name}}\n		</span>\n		<input type="text" class="hide" id="suId" name="business" errorinfo="必须选择所属商家" ms-duplex-required="suIds" />\n	</div>\n	<!-- <div ms-if="hasBusinessGroup">\n	<div class="m-filter-row clearfix mt_5">\n		<label class="m-filter-tit">选择组：</label>\n		<div class="m-filter-con2 bt5">(不选的情况默认显示业务下所有客服，选择后将只显示组内客服)</div>\n	</div>\n	<div ms-repeat="rowData">\n		<div class="m-filter-row clearfix mt_5">\n			<label class="m-filter-tit">{{el.busiName}}：</label>\n			<div class="m-filter-con2 red"></div>\n		</div>\n		<div class="m-filter-row clearfix bt mt_5 pl60" ms-attr-data-busiId = "el.busiId">\n			<span ms-repeat="el.groupList" ms-attr-data-groupId = "el.id" ms-click="changeGroupChecked" class="btn mr5" ms-attr-data-isChecked= "el.isChecked">\n				{{el.name}}\n			</span>\n		</div>\n	</div>\n	</div> -->\n	<div ms-if="datas.serviceMode">\n	    <div class="m-filter-row clearfix mt_5">\n		    <label class="m-filter-tit">功能配置：</label>\n	    </div>\n	    <div class="m-filter-row clearfix bt mt_5 pl60">\n		    <label class="m-filter-tit">可服务最大人数：</label>\n		    <div class="m-filter-con2">\n			    <input type="text" class="form-txtctr" pattern="\\d+" style="width:60px;text-align:center;" maxlength="4" placeholder="" errorinfo="必须输入数字" ms-duplex-integer-maxlength="datas.maxSessions"/>\n		    </div>\n	    </div>\n	</div>\n</form>';if(typeof t!=="undefined")t.exports=window.QTMPL["editGM"]}(t.exports,t,e);e.____MODULES["de94d619bf153377a11b03603434812c"]=t.exports})(this);(function(e){var t={id:"fd8843b1beb65ff2a7dff6a68446b48d",filename:"rmGM.string",exports:{}};if(!e.____MODULES){e.____MODULES={}}var n=function(e,t,n){if(typeof window.QTMPL==="undefined")window.QTMPL={};window.QTMPL["rmGM"]='<div class="m-filter-row clearfix mt_5">\n	<label class="m-filter-tit">用户名：</label>\n	<div class="m-filter-con2">\n		{{qunarName}}\n	</div>\n</div>';if(typeof t!=="undefined")t.exports=window.QTMPL["rmGM"]}(t.exports,t,e);e.____MODULES["fd8843b1beb65ff2a7dff6a68446b48d"]=t.exports})(this);(function(e){var t={id:"8a78aef495fdb3e6f3cd78fe86f1fab2",filename:"validationConfig.js",exports:{}};if(!e.____MODULES){e.____MODULES={}}var n=function(e,t,n){var r={validationHooks:{required:{message:"{{errorinfo}}",get:function(e,t,n){t.data.errorinfo=t.element.getAttribute("errorinfo");if(!t.data.errorinfo){t.data.errorinfo="必须填写"}n(e!=="");return e}},maxlimit:{message:"长度必须小于{{maxLimit}}",get:function(e,t,n){t.data.maxLimit=Number(t.element.getAttribute("maxlimit"));n(e.length<=t.data.maxLimit);return e}},integer:{message:"必须为正整数",get:function(e,t,n){n(/^[0-9]*[1-9][0-9]*$/g.test(e));return e}},floattwo:{message:"必须为整数或者小数(最多两位)",get:function(e,t,n){n(/^\d+$/g.test(e)||/^\d+\.\d{1,2}$/g.test(e));return e}}},onInit:function(e){validationVM=e},onError:function(e){e.forEach(function(e){r.showError(this,e)},this)},onReset:function(){r.removeError(this)},onSuccess:function(){r.removeError(this)},validateInKeyup:false,showError:function(e,t){var n=e.nextSibling;if(e.nextSibling){n=e.nextSibling.nodeType===1?e.nextSibling:e.nextSibling.nextSibling}r.removeNextSibling(e,n);n=document.createElement("div");n.className="error-tip";e.parentNode.appendChild(n);n.innerHTML=t.getMessage?t.getMessage():e.getAttribute("errorinfo")},removeError:function(e){var t=e.nextSibling,n=e.getAttribute("successInfo");if(t){t=e.nextSibling.nodeType===1?e.nextSibling:e.nextSibling.nextSibling}r.removeNextSibling(e,t);if(!e.value){return}if(!(t&&(t.className==="success-tip"||t.className==="error-tip"))){t=document.createElement("div");t.className="success-tip";e.parentNode.appendChild(t);var i=t.nextSibling;if(!(i&&i.className==="success-tip")&&e.getAttribute("data-successinfo")){i=document.createElement("div");i.className="successinfo";e.parentNode.appendChild(i);i.innerHTML=e.getAttribute("data-successinfo")}}},removeNextSibling:function(e,t){if(t&&t.className==="error-tip"){e.parentNode.removeChild(t)}if(t&&t.className==="success-tip"){var n=t.nextSibling;e.parentNode.removeChild(t);if(n&&n.className==="successinfo"){e.parentNode.removeChild(n)}}},addRule:function(e,t){var n=this.validationHooks;for(var r in n){if(n.hasOwnProperty(e)){alert("已经定义名为"+e+"验证规则，请重新命名需要添加的规则名称");return}}this.validationHooks[e]=t}};t.exports=r}(t.exports,t,e);e.____MODULES["8a78aef495fdb3e6f3cd78fe86f1fab2"]=t.exports})(this);(function(e){var t={id:"0d354c8d70ad2a5d1a677ae93f0a0557",filename:"sortSeat.string",exports:{}};if(!e.____MODULES){e.____MODULES={}}var n=function(e,t,n){if(typeof window.QTMPL==="undefined")window.QTMPL={};window.QTMPL["sortSeat"]='<div  ms-controller="priority" id="m-waiterList" onselectstart="return false" ms-mouseup="setTrOutStyle">\n	<table class="m-waiterList" id="priorityTable" >\n		<tr>\n			<!-- <th>优先级</th> -->\n			<th>用户名</th>\n			<th>网络显示名</th>\n			<th>组</th>\n			<th>所属业务</th>\n		</tr>\n		<tbody>\n			<tr ms-repeat="data" ms-attr-data-rel="$index" ms-attr-data-id="el.id" ms-mousedown="setPosition" ms-mouseup="updateSortSeat" ms-mouseover="setOverStyle" ms-mouseout="setOutStyle">\n			<!-- <td>{{el.priority}}</td> -->\n			<td>{{el.qunarName}}</td>\n			<td>{{el.webName}}</td>\n			<td>\n				<span ms-repeat="el.busiList">\n					<span class="pd5" ms-repeat="el.groupList">{{el.name}}</span>\n				</span>\n			</td>\n			<td>\n				<span ms-repeat="el.busiList">\n					{{el.busiName}}\n				</span>\n			</td>\n			\n		</tr>\n\n		</tbody>\n		<tr width="100%" height="10" data-rel="10000"  ms-mouseup="updateSortSeat" ms-mouseover="setOverStyle" ms-mouseout="setOutStyle">\n		<td></td>\n		<td></td>\n		<td></td>\n		<td></td>\n		</tr>\n		\n	</table>\n</div>';if(typeof t!=="undefined")t.exports=window.QTMPL["sortSeat"]}(t.exports,t,e);e.____MODULES["0d354c8d70ad2a5d1a677ae93f0a0557"]=t.exports})(this);(function(e){var t={id:"bff2a7b23bd02675ffd323e6c83658d3",filename:"index.string",exports:{}};if(!e.____MODULES){e.____MODULES={}}var n=function(e,t,n){if(typeof window.QTMPL==="undefined")window.QTMPL={};window.QTMPL["index"]='<div class="pannel">\n    <el-dialog \n        title="扫码关注公众号"\n        :visible="dialogBindingWechat"\n        top="15vh"\n        width="30%"\n        @close="dialogClosed"\n        center\n    >\n        <div class="wechat-account">\n            <img class="pic" :src="qrcode" />\n        </div>\n        <span slot="footer" class="dialog-footer">\n            <el-button @click="dialogBindingWechat = false">取 消</el-button>\n        </span>\n    </el-dialog>\n</div>\n';if(typeof t!=="undefined")t.exports=window.QTMPL["index"]}(t.exports,t,e);e.____MODULES["bff2a7b23bd02675ffd323e6c83658d3"]=t.exports})(this);(function(e){var t={id:"5b4eb089d957067499876dd03a549d6e",filename:"index.js",exports:{}};if(!e.____MODULES){e.____MODULES={}}var n=function(t,n,r){var i=e.____MODULES["bff2a7b23bd02675ffd323e6c83658d3"];String.prototype.trim=String.prototype.trim||function(){return this.replace(/^\s+|\s+$/g,"")};var s="/";var o=new Vue({el:"#vue_app",template:i,data:function(){this.waiterListVM=null;return{dialogBindingWechat:false,qrcode:""}},methods:{dialogClosed:function(){this.dialogBindingWechat=false;if(this.waiterListVM){this.waiterListVM.getGMList()}},bindAccount:function(e){var t=this;$.ajax({url:s+"/wechat/wechat_to_qchat/create_qrcode.php",type:"GET",dataType:"jsonp",success:function(n){if(n.ret&&n.data){t.qrcode=n.data.qrcode;t.dialogBindingWechat=true;e&&e()}else{t.$alert(n.msg,"错误")}}})},unbind:function(e){var t=this;$.ajax({url:s+"/wechat/wechat_to_qchat/unsubscribe_api.php",type:"GET",dataType:"jsonp",success:function(n){if(n.ret){t.$alert("解绑成功","提示");e&&e()}else if(n.msg){t.$alert(n.msg,"提示")}}})}}});n.exports={init:function(e){o.waiterListVM=e},bindAccount:o.bindAccount.bind(o),unbind:o.unbind.bind(o)}}(t.exports,t,e);e.____MODULES["5b4eb089d957067499876dd03a549d6e"]=t.exports})(this);(function(e){var t={id:"a176edc5ab0ea487be86b8667a596fad",filename:"waiterList.js",exports:{}};if(!e.____MODULES){e.____MODULES={}}var n=function(t,n,r){var i=e.____MODULES["de94d619bf153377a11b03603434812c"],s=e.____MODULES["fd8843b1beb65ff2a7dff6a68446b48d"],o=e.____MODULES["8a78aef495fdb3e6f3cd78fe86f1fab2"],u=e.____MODULES["0d354c8d70ad2a5d1a677ae93f0a0557"],a={GMList:"/seat/pageQuerySeatList.qunar",editGM:"/seat/saveOrUpdateSeat.qunar",rmGM:"/seat/deleteSeat.qunar",businessGroup:"/group/queryBusiGroup.qunar",updatePriority:"/seat/sortSeat.qunar",getUserName:"/seat/checkLoginName.qunar",getSuList:"/seat/getSuListByQName.qunar"},f=avalon.vmodels;var l=($.cookie("_q")||"").slice(2);var c=e.____MODULES["5b4eb089d957067499876dd03a549d6e"];var h={init:function(){this.initAvalon();this.addValidationRule()},initAvalon:function(){var e=this,t=f.GMManage;var n=avalon.define({$id:"waiterList",$skipArray:["$editGM","$rmGM","$waiterList"],startX:"",startY:"",amIWaiter:false,hasBoundWechat:false,qunarName:"",isAdd:true,rowSuList:[],sowSuListLen:0,userName:"",qunarId:"",GMdata:{qunarName:"",webName:"",busiType:"",pageSize:15,pageNum:1,bySort:"",suIds:[]},suIdList:[],groupList:[],suIds:"",closeDialog:false,hasBusinessGroup:false,rowData:[],businessGroup:[],$waiterList:{autoResize:false,htmlHelper:{groupHtml:function(e,t,n,r,i){var s=r?r.length:0,o="",u;while(s--){u=r[s]["groupList"]?r[s]["groupList"].length:0;if(u>0){while(u--){o+='<span   class="pd5">'+r[s]["groupList"][u]["name"]+"</span>"}}}return o},businessHtml:function(e,t,n,r,i){var s=r?r.length:0,o="";if(!r){return""}while(s--){o+='<span  class="pd5">'+r[s]["busiName"]+"</span>"}return o},createTimehtml:function(e,t,n,r,i){if(r){var s=new Date(r);return s.getFullYear()+"-"+(s.getMonth()+1)+"-"+s.getDate()}return""},operateHtml:function(e,t,n,r,i){var s=i.busiList,o=[];avalon.each(s,function(e,t){o.push({id:t.busiId})});o=JSON.stringify(o);return'<a href="javascript:void(0)" data-qunarName="'+i.qunarName+'"data-webName="'+i.webName+'" data-id="'+i.id+'" data-busiList="'+o+'" data-supplierId="'+i.supplierId+'" data-maxSessions="'+i.maxSessions+'" data-rel="'+n+'" ms-click="editWiter" class="pd5">编辑</a><a href="javascript:void(0)" data-id="'+i.id+'" ms-click="removeGM" data-qunarName="'+i.qunarName+'" class="pd5">删除</a>'},bindwxHtml:function(e,t,r,i,s){if(l===s.qunarName){n.amIWaiter=true;if(s.bindWx){n.hasBoundWechat=true}}return s.bindWx?"已绑定":"未绑定"}},columns:[{key:"qunarName",name:"用户名",sortable:false,isLock:true,align:"center",defaultValue:"数据错误",toggle:true,width:130},{key:"webName",name:"网络显示名",sortable:false,width:150},{key:"busiList",name:"组",sortable:false,width:180,format:"groupHtml"},{key:"supplierName",name:"所属商家",sortable:false,width:160},{key:"bindWx",name:"绑定微信状态",width:100,format:"bindwxHtml"},{key:"createTime",name:"添加日期",sortable:false,width:180,format:"createTimehtml"},{name:"操作",sortable:false,width:140,format:"operateHtml"}],data:[],pager:{perPages:15,totalItems:100,showPages:5,onJump:function(e,t){f.waiterList.GMdata.pageNum=t.currentPage;f.waiterList.getGMList()}}},$editGM:{title:"",content:"",width:450,onConfirm:function(){e.validateObj.validateAll();return false},onCancel:function(){e.deleteEditVm()},onClose:function(){e.deleteEditVm()}},$editPriority:{title:'调整显示顺序(<span class="red">鼠标拖拽需要调整的客服</span>)',content:u,width:600},$rmGM:{title:"删除客服",content:s,width:360,onConfirm:function(){avalon.ajax({url:a.rmGM,type:"POST",data:{seatId:f.waiterList.qunarId},dataType:"json"}).done(function(e){if(e.ret){f.waiterList.getGMList()}f.GMManage.error(e)}).fail(t.error)}},getGMList:function(){h.getWaiterList().done(function(e){if(e.ret){var n=f.$waiterList,r=e.data?e.data.seatList:[];n.render(r);n.pager.totalItems=e.data.totalCount}else{t.error(e)}}).fail(t.error)},renderSortSeat:function(){var e=f.waiterList.GMdata.suIds;if(!e.length){f.GMManage.showAlert("请先选择所属商家再进行操作！");return}if(e.length>1){f.GMManage.showAlert("只可选择一个所属商家！");return}f.waiterList.GMdata.bySort="priority";h.getWaiterList().done(function(e){if(!e.ret||!e.data||!e.data.seatList){return}if(f.priority){f.priority.data=e.data.seatList}else{h.initSortAvalon(e.data.seatList)}f.waiterList.GMdata.bySort="";setTimeout(function(){t.showDialog("$editPriority")},0)}).fail(function(e){t.error(e);f.waiterList.GMdata.bySort=""})},changeSuClassify:function(e){var t=f.waiterList.GMdata.suIds;var n=this.parentElement,r=n.parentElement.getElementsByTagName("li"),i=this.getAttribute("data-rel"),s=this.getAttribute("data-id"),o=t.length,u;if(i==="all"){var o=r.length;while(o--){avalon(r[o]).removeClass("active")}avalon(n).addClass("active");f.waiterList.GMdata.suIds=[]}else{avalon(r[0]).removeClass("active");if(avalon(n).hasClass("active")){while(o--){if(t[o]==s){u=o}}t.splice(u,1);avalon(n).removeClass("active")}else{avalon(n).addClass("active");t.push(s)}}},editWiter:function(){var e=f.waiterList,n=this.getAttribute("data-rel")?f.$waiterList.data[Number(this.getAttribute("data-rel"))]:[],r=[],s=this.getAttribute("data-supplierId"),o=h,u=this.getAttribute("data-rel")?"编辑客服":"添加客服",a=this.getAttribute("data-qunarName");e.isAdd=this.getAttribute("data-rel")?false:true;o.initEditAvalon();f.editGM.datas.id=this.getAttribute("data-id")||"";f.editGM.datas.qunarName=this.getAttribute("data-qunarName")||"";f.editGM.datas.webName=this.getAttribute("data-webName")||"";f.editGM.datas.maxSessions=this.getAttribute("data-maxSessions")||"10";f.editGM.datas.serviceMode=true;if(e.isAdd){e.mixSuListData(r,avalon.mix([],window.suList),s);t.showDialog("$editGM",u,i);o.validateObj=f.$editGMDlg;o.editObj=f.editGM;if(!t.hasRenderChecked){t.renderChecked()}return}e.groupListInfo(n.busiList);o.getSuList(a).done(function(n){if(!n.ret){f.GMManage.showAlert(n.msg);return}if(n.data||n.data.length){r=avalon.mix([],n.data)}e.sowSuListLen=n.data.length;e.mixSuListData(r,avalon.mix([],window.suList),s);t.showDialog("$editGM",u,i);o.validateObj=f.$editGMDlg;o.editObj=f.editGM;if(!t.hasRenderChecked){t.renderChecked()}}).fail(f.GMManage.error)},bindWechat:function(){c.bindAccount()},unbindWechat:function(){c.unbind(function(){n.getGMList();n.hasBoundWechat=false})},removeGM:function(){var e=this.getAttribute("data-id"),n=this.getAttribute("data-qunarName");f.waiterList.qunarName=n;f.waiterList.qunarId=e;t.showDialog("$rmgm")},mixSuListData:function(e,t,n){var r,i=[],s=[];avalon.each(e,function(e,t){s.push(t.id);if(t.id==n){r=e}});e.splice(r,1);avalon.each(t,function(t,r){var s=false;avalon.each(e,function(e,t){if(t.id===r.id){s=true}});if(!s){if(r.id!=n){r.isChecked=0;i.push(r)}else if(r.id==n){r.isChecked=1;i.push(r)}}});f.waiterList.suIdList=avalon.mix([],s);f.waiterList.suIds=s.join("");f.waiterList.rowSuList=avalon.mix([],i)},changeSupplier:function(){var e=this.getAttribute("data-id"),t=this.getAttribute("data-ischecked"),n=avalon.mix([],f.waiterList.suIdList),r=avalon.mix([],f.waiterList.rowSuList),i,s,o;if(f.waiterList.isAdd){avalon.each(r,function(r,i){if(i.id==e){if(t==1){i.isChecked=0}else{i.isChecked=1;n.push(e)}}})}else{avalon.each(r,function(n,r){if(r.id===1){i=r.id}if(r.id==e){if(t==1){r.isChecked=0}else{r.isChecked=1;s=e}}else{r.isChecked=0}});avalon.each(n,function(e,t){if(t.id==i){o=e}});if(typeof o!=="undefined"){n.splice(o,1)}if(typeof s!=="undefined"){n.push(Number(s))}}f.waiterList.suIdList=avalon.mix([],n);f.waiterList.suIds=n.join(",")},groupListInfo:function(e){var t=[];if(e&&e.length&&e.length>=1){t=e[0].groupList?e[0].groupList:[]}t=t.map(function(e){return{id:e.id,name:e.name}});f.waiterList.groupList=avalon.mix([],t);t=null},changeGroupChecked:function(){var e=this.getAttribute("data-groupId"),t=this.parentElement.getAttribute("data-busiId"),n=f.waiterList.rowData,r=f.editGM.datas.groupList===""?[]:avalon.parseJSON(f.editGM.datas.groupList),i=r.length;avalon.each(n,function(n,s){if(s.busiId==t){avalon.each(s.groupList,function(t,n){if(n.id==e){if(n.isChecked){n.isChecked=0;if(i>0){while(i--){if(r[i].id==e){r.splice(i,1)}}}}else{n.isChecked=1;r.push({id:e})}}})}});f.editGM.datas.groupList=r.length?JSON.stringify(r):""}});avalon.nextTick(function(){avalon.scan();f.waiterList.getGMList()});c.init(n)},initEditAvalon:function(){var e=this;var t=avalon.define({$id:"editGM",$skipArray:["validation"],datas:{id:"",qunarName:"",webName:"",busiList:[{id:window.bType}],suIdList:[],groupList:[],maxSessions:"10",serviceMode:true},$editGMDlg:avalon.mix(o,{onValidateAll:function(t){t.forEach(function(e){avalon(e.element).removeClass("success").addClass("error");o.showError(e.element,e)});if(t.length===0){e.confirmEdit()}}})});avalon.scan()},addValidationRule:function(){o.addRule("username",{message:"{{errerInfo}}",get:function(e,t,n){if(!e){n(e==="");return e}avalon.ajax({url:a.getUserName,type:"POST",data:{p:e},dataType:"json"}).done(function(r){if(r.code==="100000"){if(e!==r.data.userName){t.element.setAttribute("data-successInfo",'<em style="color:#339900">客服关联用户名为:'+r.data.userName+"</em>");f.waiterList.userName=r.data.userName}n(true);return}else if(r.code==="200000"){t.data.errerInfo="客服已经存在"}else if(r.code==="200001"){t.data.errerInfo="该用户不存在"}else{t.data.errerInfo="无法添加客服，请稍后再试"}n(false)}).fail(function(e){n(e.userName==="");t.data.errerInfo="无法添加客服，请稍后再试"});return e}})},initSortAvalon:function(e){var t=avalon.define({$id:"priority",data:e,hasTr:false,setTr:"",curSeatId:"",preSeatId:"",nextSeatId:"",startX:"",startY:"",updateSortSeat:function(){if(!f.priority.curSeatId){return}h.changePriority.call(this)},setPosition:function(e){h.changePriority.call(this)},setOverStyle:function(e){if(f.priority.hasTr){this.style["border-top"]="2px dotted #01bcd4"}},setOutStyle:function(e){var t=f.priority;this.style["border-top"]="0"},setTrOutStyle:function(){var e=f.priority;e.setTr.style.border="none";e.setTr.style.background="#fff";e.hasTr=false}});avalon.nextTick(function(){avalon.scan()})},changePriority:function(){var e=this.getAttribute("data-id"),t=f.priority;if(t.curSeatId==e){t.setTr.style.border="none";t.setTr.style.background="#fff";t.hasTr=false;t.curSeatId="";return}if(!t.hasTr){this.style.border="1px solid #80dde9";this.style.background="#f2f9fd";t.setTr=this;t.hasTr=true;t.curSeatId=e;return}t.nextSeatId=e;var n=avalon.mix([],t.data.$model),r=n.length,i=r-1,s;while(r--){if(n[r].id==t.curSeatId){s=n[r];n.splice(r,1)}}if(t.nextSeatId===null){n.push(s)}else{while(i--){if(n[i].id==t.nextSeatId){if(i===0){t.preSeatId=0;n.unshift(s);break}else{t.preSeatId=n[i-1].id;n.splice(i,0,s)}}}}t.setTr.style.border="none";t.setTr.style.background="#fff";t.hasTr=false;t.data=avalon.mix([],n);h.updatePriority()},updatePriority:function(){avalon.ajax({url:a.updatePriority,type:"POST",data:{supplierId:f.waiterList.GMdata.suIds[0],curSeatId:f.priority.curSeatId,preSeatId:f.priority.preSeatId},dataType:"json"}).done(function(){}).fail(function(e){f.GMManage.showAlert("服务器错误，请稍后再修改显示顺序");f.waiterList.renderSortSeat()})},getWaiterList:function(){var e=avalon.mix({},f.waiterList.GMdata.$model);e.suIds=e.suIds.join(",");return avalon.ajax({url:a.GMList,type:"GET",data:e,dataType:"json"})},getSuList:function(e){return avalon.ajax({url:a.getSuList,type:"GET",data:{qName:e},dataType:"json"})},clearSearchInfo:function(){f.waiterList.GMdata.qunarName="";f.waiterList.GMdata.webName="";f.waiterList.GMdata.busiType=""},deleteEditVm:function(){f.$editGM.setContent("");delete f.editGM;delete f.$editGMDlg},confirmEdit:function(e){var t=this,n=avalon.mix({},f.editGM.datas.$model);n.qunarName=f.waiterList.userName||n.qunarName;n.suIdList=avalon.mix([],f.waiterList.suIdList.$model);n.groupList=avalon.mix([],f.waiterList.groupList.$model);avalon.ajax({url:a.editGM,type:"POST",data:{p:JSON.stringify(n)},dataType:"json"}).done(function(e){if(e.ret){t.clearSearchInfo();f.waiterList.getGMList();f.$editGM._close()}else{f.$editGM._close()}f.GMManage.error(e)}).fail(function(){f.$editGM._close();f.GMManage.showAlert(f.$editGM.title+"失败，请稍后再试")})}};n.exports=h}(t.exports,t,e);e.____MODULES["a176edc5ab0ea487be86b8667a596fad"]=t.exports})(this);(function(e){var t={id:"f7f5ff477d0951b0c88d7c056b9c029d",filename:"editGroup.string",exports:{}};if(!e.____MODULES){e.____MODULES={}}var n=function(e,t,n){if(typeof window.QTMPL==="undefined")window.QTMPL={};window.QTMPL["editGroup"]='<form ms-widget="validation, $Groupvalidation, $Groupvalidation" onselectstart="return false" ms-controller="editGroup">\n	<div class="m-filter-row clearfix mt_5 bt">\n		<label class="m-filter-tit">组名称：</label>\n		<div class="m-filter-con2">\n			<input type="text" class="form-txtctr" maxlength="30" ms-duplex-required-maxlength="datas.groupName" placeholder="组名称"></div>\n	</div>\n	<div class="m-filter-row clearfix mt_5">\n		<label class="m-filter-tit">所属商家：</label>\n	</div>\n	<div class="m-filter-row clearfix bt mt_5 pl60">\n		<div class="m-filter-con2">\n			<span class="btn mr5" ms-repeat="rowSuList" ms-attr-data-id="el.id"  ms-attr-data-isChecked= "el.isChecked"  ms-click="changeSuId">{{el.name}}</span>\n			<input type="text" class="hide" id="groupBusi" name="suIds" errorinfo="必须选择所在业务" ms-duplex-required="suIds" />\n		</div>\n	</div>\n	<div class="m-filter-row clearfix mt_5">\n		<label class="m-filter-tit">包含客服：</label>\n		<div class="m-filter-con2 bt5">(多选)</div>\n	</div>\n	<div class="m-filter-row clearfix bt mt_5 pl60">\n		<div class="m-filter-con2">\n			<span class="btn mr5"  ms-repeat="rowData.seatList" ms-click="changeGMChecked" ms-attr-data-id="el.id" ms-attr-data-isChecked= "el.isChecked">{{el.qunarName}}</span>\n			<input type="text" class="hide" id="groupSeat"  errorinfo="至少选择一个客服" ms-duplex-required="datas.seatList" />\n		</div>\n	</div>\n    <div class="m-filter-row clearfix mt_5 pl60">\n        <label style="font-size:13px;"><input style="margin-bottom:3px;" type="checkbox" id="default_checkbox" ms-duplex-checked="datas.defaultValue"/>&nbsp;默认分组</label>\n	</div>\n</form>';if(typeof t!=="undefined")t.exports=window.QTMPL["editGroup"]}(t.exports,t,e);e.____MODULES["f7f5ff477d0951b0c88d7c056b9c029d"]=t.exports})(this);(function(e){var t={id:"5335957002a0db6219f44c3d7331376c",filename:"rmGroup.string",exports:{}};if(!e.____MODULES){e.____MODULES={}}var n=function(e,t,n){if(typeof window.QTMPL==="undefined")window.QTMPL={};window.QTMPL["rmGroup"]='<div class="m-filter-row clearfix mt_5">\n	<label class="m-filter-tit">组名称：</label>\n	<div class="m-filter-con2">\n		{{groupName}}\n	</div>\n</div>';if(typeof t!=="undefined")t.exports=window.QTMPL["rmGroup"]}(t.exports,t,e);e.____MODULES["5335957002a0db6219f44c3d7331376c"]=t.exports})(this);(function(e){var t={id:"a4c4e3916dedd50f84bb635b6845d1bd",filename:"groupManage.js",exports:{}};if(!e.____MODULES){e.____MODULES={}}var n=function(t,n,r){var i=e.____MODULES["f7f5ff477d0951b0c88d7c056b9c029d"],s=e.____MODULES["5335957002a0db6219f44c3d7331376c"],o=e.____MODULES["8a78aef495fdb3e6f3cd78fe86f1fab2"],u={groupList:"/group/pageQueryGroupList.qunar",GMList:"/seat/pageQuerySeatList.qunar",editGroup:"/group/saveOrUpdateGroup.qunar",rmGroup:"/group/deleteGroup.qunar"},a=avalon.vmodels;var f={init:function(){a.groupManage.getGroupList();avalon.scan()},initAvalon:function(){var e=a.GMManage,t=this;var n=avalon.define({$id:"groupManage",$skipArray:["groupList"],GMList:[],hasGMList:false,groupId:"",groupName:"",suIds:"",suIdList:[],rowSuList:window.suList,rowData:{},$groupList:{$skipArray:["htmlHelper"],autoResize:false,htmlHelper:{seatHtml:function(e,t,n,r,i){var s=s=r?r.length:0,o="";while(s--){o+='<span  data-id="'+r[s].seat_id+'" class="pd5">'+r[s].qunarName+"</span>"}return o},createTimehtml:function(e,t,n,r,i){if(r){var s=new Date(r);return s.getFullYear()+"-"+(s.getMonth()+1)+"-"+s.getDate()}return""},operateHtml:function(e,t,n,r,i){return'<a href="javascript:void(0)"  data-id="'+i.id+'" data-groupName="'+i.groupName+'" data-supplierId="'+i.supplierId+'" data-defaultValue="'+i.defaultValue+'"  ms-click="editGroupDialog" class="pd5" data-rel="'+n+'">编辑</a><a href="javascript:void(0)" data-groupId="'+i.id+'" ms-click="removeGroup" data-groupName="'+i.groupName+'" class="pd5">删除</a>'}},columns:[{key:"id",name:"组ID",sortable:false,isLock:true,align:"center",defaultValue:"数据错误",toggle:false,width:120},{key:"groupName",name:"组名称",sortable:false,width:120},{key:"supplierName",name:"所属商家",sortable:false,width:200},{key:"createTime",name:"添加日期",sortable:false,width:120,format:"createTimehtml"},{key:"seatList",name:"包含客服",sortable:false,width:200,format:"seatHtml"},{name:"操作",sortable:false,width:100,format:"operateHtml"}],data:[],pager:{perPages:15,totalItems:100,showPages:5,onJump:function(e,t){avalon.vmodels.groupManage.groupData.pageNum=t.currentPage;avalon.vmodels.groupManage.getGroupList()}}},groupData:{groupName:"",pageSize:15,pageNum:1,suIds:""},$groupEdit:{title:"编辑分组",content:"",width:"auto",onConfirm:function(){t.validateObj.validateAll();return false},onCancel:function(){t.deleteEditVm()},onClose:function(){t.deleteEditVm()}},$rmGroup:{title:"删除分组",content:s,width:"auto",onConfirm:function(){avalon.ajax({url:u.rmGroup,type:"POST",data:{groupId:a.groupManage.groupId},dataType:"json"}).done(function(e){if(e.ret){a.GMManage.showAlert("删除分组成功！");t.clearSearchInfo();a.groupManage.getGroupList()}else{a.GMManage.error(e)}}).fail(e.error)}},getGroupList:function(){avalon.ajax({url:u.groupList,type:"GET",data:a.groupManage.groupData.$model,dataType:"json"}).done(function(t){if(t.ret){var n=a.$groupList,r=t.data?t.data.groupList:[];n.render(r);n.pager.totalItems=t.data.totalCount}else{e.error(t)}}).fail(avalon.vmodels.GMManage.error)},editGroupDialog:function(){var e=f,t=a.groupManage,n=this.getAttribute("data-rel")?a.$groupList.data[Number(this.getAttribute("data-rel"))]:{},r=Number(this.getAttribute("data-supplierId"));rowSuList=avalon.mix([],t.rowSuList);t.title=this.getAttribute("data-rel")?"编辑分组":"添加分组";t.GMInfo=avalon.mix(true,{},n);avalon.each(rowSuList,function(e,t){if(t.id===r){t.isChecked=1}else{t.isChecked=0}});t.suIds=r;e.initEditAvalon();a.editGroup.datas.groupName=this.getAttribute("data-groupName")||"";a.editGroup.datas.id=this.getAttribute("data-id")||"";a.editGroup.datas.defaultValue=this.getAttribute("data-defaultValue")?parseInt(this.getAttribute("data-defaultValue")):0;e.getGMList(r)},mixEditData:function(e,t,n){var r=[];avalon.each(t,function(e,t){t.isChecked=0});avalon.each(e.seatList,function(e,n){avalon.each(t,function(e,t){if(n.id===t.id){t.isChecked=1;t.hasSet=true;r.push({id:t.id})}else{if(!t.hasSet){t.isChecked=0}}})});a.editGroup.datas.seatList=r.length?JSON.stringify(r):"";return{seatList:t}},changeSuId:function(){var e=Number(this.getAttribute("data-id")),n=Number(this.getAttribute("data-isChecked"));rowSuList=avalon.mix([],a.groupManage.rowSuList.$model);avalon.each(rowSuList,function(r,i){if(i.id===e){if(!n){i.isChecked=1;a.groupManage.suIds=e;t.getGMList(e)}else{i.isChecked=0;a.groupManage.suIds="";a.groupManage.rowData.seatList=[]}}else{i.isChecked=0}});a.groupManage.rowSuList=avalon.mix([],rowSuList)},changeGMChecked:function(){var e=this.getAttribute("data-id"),t=a.groupManage.rowData,n=a.editGroup.datas.seatList===""?[]:avalon.parseJSON(a.editGroup.datas.seatList)||[],r=avalon.mix([],n),i=document.getElementById("groupSeat"),s=n.length;avalon.each(t.seatList,function(t,r){if(r.id==e){if(r.isChecked){r.isChecked=0;if(s){while(s--){if(n[s].id==e){n.splice(s,1)}}}}else{r.isChecked=1;n.push({id:e})}}});a.editGroup.datas.seatList=n.length?JSON.stringify(n):"";if(!r.length&&a.editGroup.datas.seatList){o.removeError(i)}else if(!a.editGroup.datas.seatList){o.showError(i,"")}},removeGroup:function(){var t=this.getAttribute("data-groupId"),n=this.getAttribute("data-groupName");a.groupManage.groupName=n;a.groupManage.groupId=t;e.showDialog("$rmGroup")}})},initEditAvalon:function(){var e=this;var t=avalon.define({$id:"editGroup",$skipArray:["validation"],datas:{id:"",groupName:"",busiList:[{id:window.bType}],seatList:"",suIdList:[],defaultValue:0},$Groupvalidation:avalon.mix(o,{onValidateAll:function(t){t.forEach(function(e){avalon(e.element).removeClass("success").addClass("error");o.showError(e.element,e)});if(t.length===0){e.confirmGroupEdit()}}})});avalon.scan()},clearSearchInfo:function(){a.groupManage.groupData.groupName="";a.groupManage.groupData.busi_id=""},getGMList:function(e,t,n){var r=this;var s=a.GMManage;var o=a.groupManage;avalon.ajax({url:u.GMList,type:"GET",data:{suIds:e,pageSize:200},dataType:"json"}).done(function(e){var t=[];if(!e.data){a.GMManage.showAlert("请先为该商家添加客服！");o.rowData.seatList=[];return}avalon.each(e.data.seatList,function(e,n){t.push({id:n.id,qunarName:n.webName})});o.GMList=t;o.hasGMList=true;o.rowData=avalon.mix({},o.mixEditData(o.GMInfo,avalon.mix([],o.GMList.$model)));s.showDialog("$groupEdit",o.title,i);r.validateObj=a.$Groupvalidation;if(!s.hasRenderChecked){s.renderChecked()}avalon.scan()}).fail(s.error)},deleteEditVm:function(){a.$groupEdit.setContent("");delete a.editGroup;delete a.$Groupvalidation},confirmGroupEdit:function(){var e=this,t=avalon.mix({},a.editGroup.datas.$model);t.seatList=avalon.parseJSON(t.seatList);t.suIdList.push(a.groupManage.suIds);t.defaultValue=t.defaultValue?1:0;avalon.ajax({url:u.editGroup,type:"POST",data:{p:JSON.stringify(t)},dataType:"json"}).done(function(t){if(t.ret){e.clearSearchInfo();a.groupManage.getGroupList();a.$groupEdit._close()}else{a.$groupEdit._close()}a.GMManage.showAlert(t.msg)}).fail(function(){a.$groupEdit._close();a.GMManage.showAlert(a.$groupEdit.title+"失败，请稍后再试")})}};n.exports=f}(t.exports,t,e);e.____MODULES["a4c4e3916dedd50f84bb635b6845d1bd"]=t.exports})(this);(function(e){var t={id:"cc24e0e86a374cf8eef3fb26e39e41cf",filename:"prdGroupMapping.js",exports:{}};if(!e.____MODULES){e.____MODULES={}}var n=function(e,t,n){var r={groupList:"/group/pageQueryGroupList.qunar",assignPrds:"/group/assignProducts.qunar",getGroupPrds:"/group/queryProducts.qunar"};var i={init:function(){var e=this;this.mappingCache={};this.initAvalon();avalon.nextTick(function(){e.getGroups()})},getGroups:function(){var e=this;var t={busiId:1,pageNum:1,pageSize:1e3};avalon.ajax({url:r.groupList,type:"get",dataType:"json",data:t}).done(function(t){if(t&&t.ret){var n=e.groupDataHandler(t.data.groupList);e.initDefaultGroup(n);e.mappingModel.groups=n}else{e.showAlert("获取分组失败")}}).fail(function(t){e.showAlert("获取分组失败")})},groupDataHandler:function(e){var e=Array.isArray(e)?e:[],t={};for(var n=0;n<e.length;n++){t[e[n].id]=e[n].groupName}return t},getGroupPrds:function(e){var t=this;e=e||"";if(!e)return;avalon.vmodels["mappingList"].showLoading();avalon.ajax({url:r.getGroupPrds,type:"post",dataType:"json",data:{groupId:e}}).done(function(e){if(e&&e.ret){t.updateList(e.data)}else{t.updateList(false)}}).fail(function(e){t.updateList(false)}).always(function(){avalon.vmodels["mappingList"].hideLoading()})},assignPrds:function(e){var t=this;if(!e){this.showAlert("未指定分组");return}prds=this.mappingCache[e];avalon.ajax({url:r.assignPrds,type:"post",dataType:"json",data:{groupId:e,pIds:prds.join(",")}}).done(function(n){if(n&&n.ret){t.mappingModel.clear();var r=[],r=t.mappingCache[e].map(function(e){return{group:t.currentGroupName,prd:e}});avalon.vmodels["mappingList"].render(r);t.showAlert(n.msg||"更新成功")}else{t.showAlert(n.msg||"更新失败")}}).fail(function(e){t.showAlert(e.msg||"更新失败")})},initAvalon:function(){var e=this;e.currentGroupName="";var t=/^[\d|,|\s]+$/;var n=this.mappingModel=avalon.define("prdGroupMapping",function(n){n.$skipArray=["clear"];n.newPrds="";n.groups={};n.$mappingListOpt={allChecked:false,loading:{type:"spin",modalBackground:"#000"},selectable:{type:"Checkbox"},data:[],pageable:false,addRow:function(e,t,n){var r='<tr style="text-align:left"><td colspan="'+t.length+'">&ensp;',i="";if(t[0].key==="selected"){i="{{columns[0].name|html}}"}r=r+i+'&ensp;&ensp;<a href="javascript:;" ms-click="prdDelete(true)">删除</a></td></tr>';return r+e},htmlHelper:{del:function(e,t,n,r,i){return'<a href="javascript:;" key="'+r+'" ms-click="prdDelete(false)">删除</a>'}},columns:[{key:"group",name:"分组名称",width:200},{key:"prd",name:"产品Id",width:200},{key:"prd",name:"操作",width:170,format:"del"}]};n.currentGroup="";n.changeGroup=function(t){var r=this.getAttribute("key");e.currentGroupName=this.innerHTML;if(r==n.currentGroup){return}n.currentGroup=r;e.getGroupPrds(r)};n.prdSave=function(r){var i=n.newPrds.trim(),s=n.currentGroup;if(!i){e.showAlert("未输入产品Id");return}if(t.test(i)===false){e.showAlert("只能输入数字和英文状态的逗号");return}i=i.split(",");for(var o=0;o<i.length;o++){if(e.mappingCache[s].indexOf(i[o])===-1){e.mappingCache[s].push(i[o])}}e.assignPrds(s)};n.prdDelete=function(t){var r=n.currentGroup,i=t?avalon.vmodels["mappingList"].getSelected().map(function(e){return e.prd}):[this.getAttribute("key")];for(var s=0,o;s<i.length;s++){o=e.mappingCache[r].indexOf(i[s]);e.mappingCache[r].splice(o,1)}e.assignPrds(r)};n.clear=function(){n.newPrds=""}})},initDefaultGroup:function(e){var t,n;for(var r in e){if(e.hasOwnProperty(r)){t=t||{key:r,text:e[r]}}}if(t){n=t.key+"";this.currentGroupName=t.text;this.mappingModel.currentGroup=n;this.mappingCache[n]=[];this.getGroupPrds(n)}},updateList:function(e){var t=this;if(!e){this.showAlert("数据更新失败");return}var e=Array.isArray(e)?e.length?e:[]:[],n=[],r=this.mappingModel.currentGroup;this.mappingCache[r]=[];for(var i=0;i<e.length;i++){n.push({group:t.currentGroupName,prd:e[i]});this.mappingCache[r].push(e[i])}avalon.vmodels["mappingList"].render(n)},showAlert:function(e){avalon.vmodels["GMManage"].showAlert(e)}};t.exports=i}(t.exports,t,e);e.____MODULES["cc24e0e86a374cf8eef3fb26e39e41cf"]=t.exports})(this);(function(e){var t={id:"6d1c4fbfbf449c70bd45c49137604f54",filename:"servicesSetting.js",exports:{}};if(!e.____MODULES){e.____MODULES={}}var n=function(e,t,n){"use strict";var r={getMsgUrl:"/notice/welcomes/list.json",saveMsgUrl:"/notice/save.json"};var i={init:function(){var e=[],t={},n=window,r=this;var i=r.initAvalon();if(!n.suList||!n.suList.length){return}r.cacheList=[];$.each(suList,function(n,r){e.push(r.id);t[r.id]=r.name});r.getMsgList({supplierIds:e.join()}).done(function(e){if(e.ret&&e.data&&e.data.length){var n=e.data;$.each(n,function(e,n){n.name=t[n.supplierId]});i.shopMessage=r.cacheList=n}})},getMsgList:function(e){return avalon.ajax({url:r.getMsgUrl,type:"get",dataType:"json",data:e})},initAvalon:function(){var e=avalon.vmodels.GMManage,t=this;var n=avalon.define({$id:"servicesSetting",shopMessage:[],save:function(){var n=[];if(!t.cacheList){return}$.each(t.cacheList,function(e,t){n.push({supplierId:t.supplierId,welcomes:t.welcomes,noServiceWelcomes:t.noServiceWelcomes})});avalon.ajax({url:r.saveMsgUrl,type:"post",dataType:"json",contentType:"application/json",data:JSON.stringify(n)}).done(function(t){if(t&&t.ret){e.showAlert(t.msg||"保存成功")}else{e.showAlert(t.msg||"保存失败")}}).fail(function(){e.showAlert("请求出错，保存失败")})}});avalon.scan();return n}};t.exports=i}(t.exports,t,e);e.____MODULES["6d1c4fbfbf449c70bd45c49137604f54"]=t.exports})(this);(function(e){var t={id:"5eb4fa60377df2ba90011f27b6eb95a9",filename:"editShopM.string",exports:{}};if(!e.____MODULES){e.____MODULES={}}var n=function(e,t,n){if(typeof window.QTMPL==="undefined")window.QTMPL={};window.QTMPL["editShopM"]='<form ms-widget="validation, $editShopDlg, $editShopDlg" ms-controller="editShop" onselectstart="return false">\n	<!-- <div class="m-filter-row clearfix mt_5">\n		<label class="m-filter-tit">业务线：</label>\n		<div class="m-filter-con2">\n            <select ms-duplex="lineSelected">\n                <option ms-repeat-item="lineOptions"  ms-attr-value="item.bType" >{{item.businessName}}</option>\n            </select>\n		</div>\n	</div> -->\n	<div class="m-filter-row clearfix mt_5">\n		<label class="m-filter-tit">店铺名称：</label>\n		<div class="m-filter-con2-tip">\n			<input type="text" class="form-txtctr-tip" maxlength="30" ms-duplex-required-maxlength-shopName="datas.name" placeholder="网络名称">\n		</div>\n	</div>\n	<div class="m-filter-row clearfix mt_5 bt hide">\n		<label class="m-filter-tit">店铺状态：</label>\n		<div class="m-filter-con2">\n		    <label>\n		        <input name="state" type="radio" ms-value="1" ms-duplex-text="datas.status" style="margin-right:8px;"/>在线\n		    </label>\n		    <label style="margin-left:30px;">\n		        <input name="state" type="radio" ms-value="0" ms-duplex-text="datas.status" style="margin-right:8px;"/>下线\n		    </label>\n		</div>\n	</div>\n	<div class="m-filter-row clearfix mt_5 bt">\n		<label class="m-filter-tit">功能设置：</label>\n		<div class="m-filter-con2">\n            <label style="font-size:13px;">\n                <input style="margin-bottom:3px;" type="checkbox" id="default_checkbox" ms-duplex-checked="datas.extFlag"/>\n                &nbsp;启用排队\n            </label>\n		</div>\n	</div>\n	<div class="m-filter-row clearfix mt_5">\n		<label class="m-filter-tit">分配策略：</label>\n		<div class="supplier-strategy-edit">\n			<input type="radio" ms-duplex-string="datas.assignStragegy"  name="strategy" value="1">	\n			<label>轮询</label><br/>\n			<input type="radio" ms-duplex-string="datas.assignStragegy"  name="strategy" value="2">	\n			<label>最闲优先</label><br/>\n			<input type="radio" ms-duplex-string="datas.assignStragegy" name="strategy" value="3">\n			<label>随机</label>\n		</div>\n	</div>\n</form>';if(typeof t!=="undefined")t.exports=window.QTMPL["editShopM"]}(t.exports,t,e);e.____MODULES["5eb4fa60377df2ba90011f27b6eb95a9"]=t.exports})(this);(function(e){var t={id:"18c9c636c3db8662921dc7da152fe341",filename:"shopList.js",exports:{}};if(!e.____MODULES){e.____MODULES={}}var n=function(t,n,r){var i=e.____MODULES["5eb4fa60377df2ba90011f27b6eb95a9"],s=e.____MODULES["8a78aef495fdb3e6f3cd78fe86f1fab2"],o={ShopList:"/busiSupplier/pageQuerySupplierList.json",searchShopList:"/busiSupplier/getBusiSupplierByBusiName.json",editShop:"/busiSupplier/setBusiSupplier.json",checkShopName:"/seat/checkShopName.qunar"},u=avalon.vmodels;var a={init:function(){this.initAvalon();this.addValidationRule()},initAvalon:function(){var e=this,t=u.GMManage;avalon.define({$id:"shopList",$skipArray:["$editShop","$shopList"],startX:"",startY:"",qunarName:"",isAdd:true,GMdata:{busiSupplierName:"",pageSize:15,pageNum:1},closeDialog:false,rowData:[],$shopList:{autoResize:false,htmlHelper:{groupHtml:function(e,t,n,r,i){var s=r?r.length:0,o="",u;while(s--){u=r[s]["groupList"]?r[s]["groupList"].length:0;if(u>0){while(u--){o+='<span   class="pd5">'+r[s]["groupList"][u]["name"]+"</span>"}}}return o},queueState:function(e,t,n,r,i){return r?"排队已开启":"排队未开启"},shopStatusHtml:function(e,t,n,r,i){return r?"服务中":"已下架"},createTimehtml:function(e,t,n,r,i){if(r){var s=new Date(r);return s.getFullYear()+"-"+(s.getMonth()+1)+"-"+s.getDate()}return""},operateHtml:function(e,t,n,r,i){return'<a href="javascript:void(0)" data-shopName="'+i.name+'" data-id="'+i.id+'" data-queueState="'+i.ext_flag+'" data-shopState="'+i.status+'"data-rel="'+n+'"data-assignstragegy="'+i.assignStrategy+'" ms-click="editShop" class="pd5">编辑</a>'},strategyHtml:function(e,t,n,r,i){var s;switch(r){case 1:s="轮询";break;case 2:s="最闲优先";break;case 3:s="随机";break;default:s=""}return s}},columns:[{key:"id",name:"店铺ID",sortable:false,width:120},{key:"name",name:"店铺名称",sortable:false,width:300},{key:"status",name:"店铺状态",sortable:false,width:120,format:"shopStatusHtml"},{key:"createDate",name:"创建日期",sortable:false,width:200,format:"createTimehtml"}],data:[],pager:{perPages:15,totalItems:100,showPages:5,onJump:function(e,t){u.shopList.GMdata.pageNum=t.currentPage;u.shopList.getShopList()}}},$editShop:{title:"",content:"",width:450,onConfirm:function(){e.validateObj.validateAll();return false},onCancel:function(){e.deleteEditVm()},onClose:function(){e.deleteEditVm()}},getShopList:function(){a.getShopList().done(function(e){if(e.ret){var n=u.$shopList,r=e.data?e.data.supplierList:[];n.render(r);n.pager.totalItems=e.data.totalCount}else{t.error(e)}}).fail(function(){t.error()})},searchShopList:function(){var e=avalon.mix({},u.shopList.GMdata.$model);if(e.busiSupplierName.length<=0){u.shopList.getShopList()}else{a.searchShopList().done(function(e){if(e.ret){var n=u.$shopList,r=e.data?e.data:[];n.render(r);n.pager.totalItems=e.data.length}else{t.error(e)}}).fail(t.error)}},editShop:function(){var e=u.shopList,n=a,r=this.getAttribute("data-rel")?"编辑店铺":"添加店铺";e.isAdd=this.getAttribute("data-rel")?false:true;n.initEditAvalon();u.editShop.datas.busiSupplierId=this.getAttribute("data-id")||"";u.editShop.datas.name=this.getAttribute("data-shopName")||"";u.editShop.datas.status=this.getAttribute("data-shopstate")?parseInt(this.getAttribute("data-shopstate")):true;u.editShop.datas.extFlag=this.getAttribute("data-queuestate")?parseInt(this.getAttribute("data-queuestate")):true;u.editShop.datas.assignStragegy=this.getAttribute("data-assignstragegy")||"";if(e.isAdd){t.showDialog("$editShop",r,i);n.validateObj=u.$editShopDlg;n.editObj=u.editShop;if(!t.hasRenderChecked){t.renderChecked()}}else{t.showDialog("$editShop",r,i);n.validateObj=u.$editShopDlg;n.editObj=u.editShop;if(!t.hasRenderChecked){t.renderChecked()}}}});avalon.nextTick(function(){avalon.scan();u.shopList.getShopList()})},initEditAvalon:function(){var e=this;avalon.define({$id:"editShop",$skipArray:["validation"],datas:{busiSupplierId:"",name:"",status:1,extFlag:1,assignStragegy:1},$editShopDlg:avalon.mix(s,{onValidateAll:function(t){t.forEach(function(e){avalon(e.element).removeClass("success").addClass("error");s.showError(e.element,e)});if(t.length===0){e.confirmEdit()}}})});avalon.scan()},addValidationRule:function(){s.addRule("shopName",{message:"{{errerInfo}}",get:function(e,t,n){if(!e){n(e==="");return e}avalon.ajax({url:o.checkShopName,type:"POST",data:{p:e},dataType:"json"}).done(function(r){if(r.code==="100000"){if(e!==r.data.userName){t.element.setAttribute("data-successInfo",'<em style="color:#339900">客服关联用户名为:'+r.data.userName+"</em>");u.waiterList.userName=r.data.userName}n(true);return}else if(r.code==="200000"){t.data.errerInfo="客服已经存在"}else if(r.code==="200001"){t.data.errerInfo="该用户不存在"}else{t.data.errerInfo="无法添加客服，请稍后再试"}n(false)}).fail(function(e){n(e.userName==="");t.data.errerInfo="无法添加客服，请稍后再试"});return e}})},getShopList:function(){var e=avalon.mix({},u.shopList.GMdata.$model);return avalon.ajax({url:o.ShopList,type:"GET",data:e,dataType:"json"})},searchShopList:function(){var e=avalon.mix({},u.shopList.GMdata.$model);return avalon.ajax({url:o.searchShopList,type:"GET",data:e,dataType:"json"})},clearSearchInfo:function(){u.shopList.GMdata.qunarName="";u.shopList.GMdata.webName="";u.shopList.GMdata.busiType=""},deleteEditVm:function(){},confirmEdit:function(e){var t=this;var n=avalon.mix({},u.editShop.datas.$model);n.extFlag=n.extFlag?"1":"0";avalon.ajax({url:o.editShop,type:"GET",data:n,dataType:"json"}).done(function(e){if(e.ret){t.clearSearchInfo();u.shopList.getShopList();u.$editShop._close()}else{u.$editShop._close()}u.GMManage.error(e)}).fail(function(){u.$editShop._close();u.GMManage.showAlert(u.$editShop.title+"失败，请稍后再试")})}};n.exports=a}(t.exports,t,e);e.____MODULES["18c9c636c3db8662921dc7da152fe341"]=t.exports})(this);(function(e){var t={id:"16ebc97a1416888a09cab015d79823dc",filename:"index.js",exports:{}};if(!e.____MODULES){e.____MODULES={}}var n=function(t,n,r){function c(e){var t=new RegExp("(^|&)"+e+"=([^&]*)(&|$)");var n=window.location.search.substr(1).match(t);if(n!=null){return decodeURI(n[2])}else{return""}}e.____MODULES["2ab11dddd1a66c979fc4d8cb729fc348"];e.____MODULES["d9a0811df9360928cb0a5469c2afd199"];e.____MODULES["2911e08ffe5ce1f604ded6a87a2c86ff"];e.____MODULES["4eee70cc619e792f6bdeb1973f28dedd"];e.____MODULES["8b03a9fae1e76b43eccda98d88191431"];e.____MODULES["fc889a1e71c18b8357adeceada1618bf"];var i=e.____MODULES["a176edc5ab0ea487be86b8667a596fad"],s=e.____MODULES["a4c4e3916dedd50f84bb635b6845d1bd"],o=e.____MODULES["cc24e0e86a374cf8eef3fb26e39e41cf"],u=e.____MODULES["6d1c4fbfbf449c70bd45c49137604f54"],a=e.____MODULES["18c9c636c3db8662921dc7da152fe341"],f={businessList:"/sys/queryBusinessList.qunar",groupList:"/group/queryBusinessGroup.qunar"};var l=avalon.vmodels;var h=c("bType")||"";var p={init:function(){avalon.config({debug:false});this.initAvalon();a.init();i.init();s.initAvalon();o.init();u.init();avalon.scan()},initAvalon:function(){var e=avalon.define({$id:"GMManage",$skipArray:["dialog","$waiterList","$shopList"],tabName:"shopList",shopList:a,waiterList:i,groupManage:s,prdGroupMapping:o,servicesSetting:u,shopListRender:true,waiterListRender:true,groupManageRender:false,prdGroupMappingRender:false,hasRenderChecked:false,suList:window.suList,groupsList:[],businessList:[],sortMethods:[],$alertDlg:{title:"提示：",width:280,type:"alert"},isSupplierService:window.isSupplierService,toSmartConsult:function(){var e=document.cookie.match(/(^|\s)QChat_bType=([^;]*)(;|$)/i),t;if(e&&e.length&&e[2].replace(/"/g,"")){t=e[2]}location.href="/sys/smartConsult.do?bType="+t},toSupplierFAQ:function(){location.href="/sys/supplierFAQ.do?bType="+window.bType},toSessionManage:function(){var e=document.cookie.match(/(^|\s)QChat_bType=([^;]*)(;|$)/i),t=document.cookie.match(/(^|\s)QChat_bSuId=([^;]*)(;|$)/i),n,r;if(e&&e.length&&e[2].replace(/"/g,"")){n=e[2]}if(t&&t.length&&t[2].replace(/"/g,"")){r=t[2]}if(n&&r){document.location.href="./sessionList.do?bType="+n+"&bSuId="+r}else if(n&&!r){document.location.href="./sessionList.do?bType="+n}else if(!n&&r){document.location.href="./sessionList.do?bSuId="+r}else{document.location.href="./sessionList.do"}},changeTab:function(){var t=this.getAttribute("data-rel"),n=this.parentElement,r=n.parentElement.getElementsByTagName("li"),i=r.length;e.changeActive.call(this,r,n);e.tabName=t;if(!e[t+"Render"]){e[t].init();e[t+"Render"]=true}},changeActive:function(e,t){var n=e.length;while(n--){avalon(e[n]).removeClass("active")}avalon(t).addClass("active")},changeClassify:function(){var t=this.parentElement,n=t.parentElement.getElementsByTagName("li");e.changeActive.call(this,n,t)},showAlert:function(e){avalon.vmodels.$alertDlg.setContent(e);avalon.vmodels.$alertDlg.toggle=true},renderChecked:function(){var e='[data-ischecked="1"]{border: 1px solid #01da44;background:#ccc}',t=document.getElementsByTagName("head")[0],n=document.createElement("style");n.innerHTML=e;t.appendChild(n);l.GMManage.hasRenderChecked=true},showDialog:function(e,t,n){if(t){avalon.vmodels[e].title=t}if(n){avalon.vmodels[e].setContent(n)}avalon.vmodels[e].toggle=true},addGMDialog:function(e,t){avalon.vmodels.GMManage.showDialog(e,t,editGMTpl);avalon.scan()},removeGM:function(){var t=this.getAttribute("data-id"),n=this.getAttribute("data-qunarName");e.showDialog("$rmgm");e.qunarName=n;e.qunarId=t},error:function(t){e.showAlert(t.msg)}})}};p.init()}(t.exports,t,e);e.____MODULES["16ebc97a1416888a09cab015d79823dc"]=t.exports})(this)